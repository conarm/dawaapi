var $f=Object.defineProperty;var ed=(n,e,t)=>e in n?$f(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ie=(n,e,t)=>(ed(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function pe(){}function Re(n,e){for(const t in e)n[t]=e[t];return n}function uu(n){return n()}function cl(){return Object.create(null)}function tt(n){n.forEach(uu)}function Ye(n){return typeof n=="function"}function ve(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function hu(n,e){return n!=n?e==e:n!==e}function td(n){return Object.keys(n).length===0}function $s(n,...e){if(n==null){for(const s of e)s(void 0);return pe}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function oe(n){let e;return $s(n,t=>e=t)(),e}function ee(n,e,t){n.$$.on_destroy.push($s(e,t))}function Ct(n,e,t,s){if(n){const i=fu(n,e,t,s);return n[0](i)}}function fu(n,e,t,s){return n[1]&&s?Re(t.ctx.slice(),n[1](s(e))):t.ctx}function At(n,e,t,s){if(n[2]&&s){const i=n[2](s(t));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],a=Math.max(e.dirty.length,i.length);for(let r=0;r<a;r+=1)o[r]=e.dirty[r]|i[r];return o}return e.dirty|i}return e.dirty}function Nt(n,e,t,s,i,o){if(i){const a=fu(e,t,s,o);n.p(a,i)}}function Et(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let s=0;s<t;s++)e[s]=-1;return e}return-1}function Qt(n){const e={};for(const t in n)t[0]!=="$"&&(e[t]=n[t]);return e}function $e(n,e){const t={};e=new Set(e);for(const s in n)!e.has(s)&&s[0]!=="$"&&(t[s]=n[s]);return t}function nd(n){const e={};for(const t in n)e[t]=!0;return e}function ul(n){return n??""}function $i(n,e,t){return n.set(t),e}function yt(n){return n&&Ye(n.destroy)?n.destroy:pe}const sd=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function x(n,e){n.appendChild(e)}function Z(n,e,t){n.insertBefore(e,t||null)}function U(n){n.parentNode&&n.parentNode.removeChild(n)}function Jr(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function X(n){return document.createElement(n)}function Pe(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Be(n){return document.createTextNode(n)}function K(){return Be(" ")}function Ze(){return Be("")}function de(n,e,t,s){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}function C(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}const id=["width","height"];function Ns(n,e){const t=Object.getOwnPropertyDescriptors(n.__proto__);for(const s in e)e[s]==null?n.removeAttribute(s):s==="style"?n.style.cssText=e[s]:s==="__value"?n.value=n[s]=e[s]:t[s]&&t[s].set&&id.indexOf(s)===-1?n[s]=e[s]:C(n,s,e[s])}function od(n){return Array.from(n.childNodes)}function ht(n,e){e=""+e,n.data!==e&&(n.data=e)}function rd(n,e){n.value=e??""}function Se(n,e,t,s){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,s?"important":"")}function hl(n,e,t){for(let s=0;s<n.options.length;s+=1){const i=n.options[s];if(i.__value===e){i.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}let Ri;function ad(){if(Ri===void 0){Ri=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Ri=!0}}return Ri}function ld(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const s=X("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const i=ad();let o;return i?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=de(window,"message",a=>{a.source===s.contentWindow&&e()})):(s.src="about:blank",s.onload=()=>{o=de(s.contentWindow,"resize",e),e()}),x(n,s),()=>{(i||o&&s.contentWindow)&&o(),U(s)}}function ke(n,e,t){n.classList.toggle(e,!!t)}function cd(n,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:s})}class fl{constructor(e=!1){Ie(this,"is_svg",!1);Ie(this,"e");Ie(this,"n");Ie(this,"t");Ie(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,s=null){this.e||(this.is_svg?this.e=Pe(t.nodeName):this.e=X(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(s)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)Z(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(U)}}function eo(n,e){return new n(e)}let ei;function Js(n){ei=n}function Ls(){if(!ei)throw new Error("Function called outside component initialization");return ei}function di(n){Ls().$$.on_mount.push(n)}function du(n){Ls().$$.on_destroy.push(n)}function Io(){const n=Ls();return(e,t,{cancelable:s=!1}={})=>{const i=n.$$.callbacks[e];if(i){const o=cd(e,t,{cancelable:s});return i.slice().forEach(a=>{a.call(n,o)}),!o.defaultPrevented}return!0}}function to(n,e){return Ls().$$.context.set(n,e),e}function no(n){return Ls().$$.context.get(n)}function ud(n){return Ls().$$.context.has(n)}function De(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(s=>s.call(this,e))}const fs=[],ti=[];let ws=[];const dl=[],hd=Promise.resolve();let Cr=!1;function fd(){Cr||(Cr=!0,hd.then(mu))}function so(n){ws.push(n)}const dr=new Set;let cs=0;function mu(){if(cs!==0)return;const n=ei;do{try{for(;cs<fs.length;){const e=fs[cs];cs++,Js(e),dd(e.$$)}}catch(e){throw fs.length=0,cs=0,e}for(Js(null),fs.length=0,cs=0;ti.length;)ti.pop()();for(let e=0;e<ws.length;e+=1){const t=ws[e];dr.has(t)||(dr.add(t),t())}ws.length=0}while(fs.length);for(;dl.length;)dl.pop()();Cr=!1,dr.clear(),Js(n)}function dd(n){if(n.fragment!==null){n.update(),tt(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(so)}}function md(n){const e=[],t=[];ws.forEach(s=>n.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),ws=e}const ji=new Set;let Hn;function at(){Hn={r:0,c:[],p:Hn}}function lt(){Hn.r||tt(Hn.c),Hn=Hn.p}function Y(n,e){n&&n.i&&(ji.delete(n),n.i(e))}function G(n,e,t,s){if(n&&n.o){if(ji.has(n))return;ji.add(n),Hn.c.push(()=>{ji.delete(n),s&&(t&&n.d(1),s())}),n.o(e)}else s&&s()}function Mt(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Po(n,e){G(n,1,1,()=>{e.delete(n.key)})}function Ro(n,e,t,s,i,o,a,r,l,c,u,h){let f=n.length,d=o.length,m=f;const g={};for(;m--;)g[n[m].key]=m;const _=[],p=new Map,v=new Map,y=[];for(m=d;m--;){const T=h(i,o,m),S=t(T);let M=a.get(S);M?s&&y.push(()=>M.p(T,e)):(M=c(S,T),M.c()),p.set(S,_[m]=M),S in g&&v.set(S,Math.abs(m-g[S]))}const k=new Set,b=new Set;function N(T){Y(T,1),T.m(r,u),a.set(T.key,T),u=T.first,d--}for(;f&&d;){const T=_[d-1],S=n[f-1],M=T.key,O=S.key;T===S?(u=T.first,f--,d--):p.has(O)?!a.has(M)||k.has(M)?N(T):b.has(O)?f--:v.get(M)>v.get(O)?(b.add(M),N(T)):(k.add(O),f--):(l(S,a),f--)}for(;f--;){const T=n[f];p.has(T.key)||l(T,a)}for(;d;)N(_[d-1]);return tt(y),_}function vn(n,e){const t={},s={},i={$$scope:1};let o=n.length;for(;o--;){const a=n[o],r=e[o];if(r){for(const l in a)l in r||(s[l]=1);for(const l in r)i[l]||(t[l]=r[l],i[l]=1);n[o]=r}else for(const l in a)i[l]=1}for(const a in s)a in t||(t[a]=void 0);return t}function Es(n){return typeof n=="object"&&n!==null?n:{}}function he(n){n&&n.c()}function ce(n,e,t){const{fragment:s,after_update:i}=n.$$;s&&s.m(e,t),so(()=>{const o=n.$$.on_mount.map(uu).filter(Ye);n.$$.on_destroy?n.$$.on_destroy.push(...o):tt(o),n.$$.on_mount=[]}),i.forEach(so)}function ue(n,e){const t=n.$$;t.fragment!==null&&(md(t.after_update),tt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function pd(n,e){n.$$.dirty[0]===-1&&(fs.push(n),fd(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function be(n,e,t,s,i,o,a=null,r=[-1]){const l=ei;Js(n);const c=n.$$={fragment:null,ctx:[],props:o,update:pe,not_equal:i,bound:cl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:cl(),dirty:r,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(h,f,...d)=>{const m=d.length?d[0]:f;return c.ctx&&i(c.ctx[h],c.ctx[h]=m)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](m),u&&pd(n,h)),f}):[],c.update(),u=!0,tt(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const h=od(e.target);c.fragment&&c.fragment.l(h),h.forEach(U)}else c.fragment&&c.fragment.c();e.intro&&Y(n.$$.fragment),ce(n,e.target,e.anchor),mu()}Js(l)}class we{constructor(){Ie(this,"$$");Ie(this,"$$set")}$destroy(){ue(this,1),this.$destroy=pe}$on(e,t){if(!Ye(t))return pe;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const i=s.indexOf(t);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!td(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const gd="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(gd);const us=[];function Wt(n,e){return{subscribe:ae(n,e).subscribe}}function ae(n,e=pe){let t;const s=new Set;function i(r){if(ve(n,r)&&(n=r,t)){const l=!us.length;for(const c of s)c[1](),us.push(c,n);if(l){for(let c=0;c<us.length;c+=2)us[c][0](us[c+1]);us.length=0}}}function o(r){i(r(n))}function a(r,l=pe){const c=[r,l];return s.add(c),s.size===1&&(t=e(i,o)||pe),r(n),()=>{s.delete(c),s.size===0&&t&&(t(),t=null)}}return{set:i,update:o,subscribe:a}}function vs(n,e,t){const s=!Array.isArray(n),i=s?[n]:n;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return Wt(t,(a,r)=>{let l=!1;const c=[];let u=0,h=pe;const f=()=>{if(u)return;h();const m=e(s?c[0]:c,a,r);o?a(m):h=Ye(m)?m:pe},d=i.map((m,g)=>$s(m,_=>{c[g]=_,u&=~(1<<g),l&&f()},()=>{u|=1<<g}));return l=!0,f(),function(){tt(d),h(),l=!1}})}function Le(n){if(typeof n=="string"||typeof n=="number")return""+n;let e="";if(Array.isArray(n))for(let t=0,s;t<n.length;t++)(s=Le(n[t]))!==""&&(e+=(e&&" ")+s);else for(let t in n)n[t]&&(e+=(e&&" ")+t);return e}var _d={value:()=>{}};function xo(){for(var n=0,e=arguments.length,t={},s;n<e;++n){if(!(s=arguments[n]+"")||s in t||/[\s.]/.test(s))throw new Error("illegal type: "+s);t[s]=[]}return new Ui(t)}function Ui(n){this._=n}function yd(n,e){return n.trim().split(/^|\s+/).map(function(t){var s="",i=t.indexOf(".");if(i>=0&&(s=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:s}})}Ui.prototype=xo.prototype={constructor:Ui,on:function(n,e){var t=this._,s=yd(n+"",t),i,o=-1,a=s.length;if(arguments.length<2){for(;++o<a;)if((i=(n=s[o]).type)&&(i=bd(t[i],n.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(n=s[o]).type)t[i]=ml(t[i],n.name,e);else if(e==null)for(i in t)t[i]=ml(t[i],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new Ui(n)},call:function(n,e){if((i=arguments.length-2)>0)for(var t=new Array(i),s=0,i,o;s<i;++s)t[s]=arguments[s+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(o=this._[n],s=0,i=o.length;s<i;++s)o[s].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var s=this._[n],i=0,o=s.length;i<o;++i)s[i].value.apply(e,t)}};function bd(n,e){for(var t=0,s=n.length,i;t<s;++t)if((i=n[t]).name===e)return i.value}function ml(n,e,t){for(var s=0,i=n.length;s<i;++s)if(n[s].name===e){n[s]=_d,n=n.slice(0,s).concat(n.slice(s+1));break}return t!=null&&n.push({name:e,value:t}),n}var Ar="http://www.w3.org/1999/xhtml";const pl={svg:"http://www.w3.org/2000/svg",xhtml:Ar,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vo(n){var e=n+="",t=e.indexOf(":");return t>=0&&(e=n.slice(0,t))!=="xmlns"&&(n=n.slice(t+1)),pl.hasOwnProperty(e)?{space:pl[e],local:n}:n}function wd(n){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===Ar&&e.documentElement.namespaceURI===Ar?e.createElement(n):e.createElementNS(t,n)}}function vd(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function pu(n){var e=Vo(n);return(e.local?vd:wd)(e)}function kd(){}function $r(n){return n==null?kd:function(){return this.querySelector(n)}}function Td(n){typeof n!="function"&&(n=$r(n));for(var e=this._groups,t=e.length,s=new Array(t),i=0;i<t;++i)for(var o=e[i],a=o.length,r=s[i]=new Array(a),l,c,u=0;u<a;++u)(l=o[u])&&(c=n.call(l,l.__data__,u,o))&&("__data__"in l&&(c.__data__=l.__data__),r[u]=c);return new xt(s,this._parents)}function Sd(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Cd(){return[]}function gu(n){return n==null?Cd:function(){return this.querySelectorAll(n)}}function Ad(n){return function(){return Sd(n.apply(this,arguments))}}function Nd(n){typeof n=="function"?n=Ad(n):n=gu(n);for(var e=this._groups,t=e.length,s=[],i=[],o=0;o<t;++o)for(var a=e[o],r=a.length,l,c=0;c<r;++c)(l=a[c])&&(s.push(n.call(l,l.__data__,c,a)),i.push(l));return new xt(s,i)}function _u(n){return function(){return this.matches(n)}}function yu(n){return function(e){return e.matches(n)}}var Ed=Array.prototype.find;function Md(n){return function(){return Ed.call(this.children,n)}}function Od(){return this.firstElementChild}function Dd(n){return this.select(n==null?Od:Md(typeof n=="function"?n:yu(n)))}var Id=Array.prototype.filter;function Pd(){return Array.from(this.children)}function Rd(n){return function(){return Id.call(this.children,n)}}function xd(n){return this.selectAll(n==null?Pd:Rd(typeof n=="function"?n:yu(n)))}function Vd(n){typeof n!="function"&&(n=_u(n));for(var e=this._groups,t=e.length,s=new Array(t),i=0;i<t;++i)for(var o=e[i],a=o.length,r=s[i]=[],l,c=0;c<a;++c)(l=o[c])&&n.call(l,l.__data__,c,o)&&r.push(l);return new xt(s,this._parents)}function bu(n){return new Array(n.length)}function Fd(){return new xt(this._enter||this._groups.map(bu),this._parents)}function io(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}io.prototype={constructor:io,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function zd(n){return function(){return n}}function Wd(n,e,t,s,i,o){for(var a=0,r,l=e.length,c=o.length;a<c;++a)(r=e[a])?(r.__data__=o[a],s[a]=r):t[a]=new io(n,o[a]);for(;a<l;++a)(r=e[a])&&(i[a]=r)}function Ld(n,e,t,s,i,o,a){var r,l,c=new Map,u=e.length,h=o.length,f=new Array(u),d;for(r=0;r<u;++r)(l=e[r])&&(f[r]=d=a.call(l,l.__data__,r,e)+"",c.has(d)?i[r]=l:c.set(d,l));for(r=0;r<h;++r)d=a.call(n,o[r],r,o)+"",(l=c.get(d))?(s[r]=l,l.__data__=o[r],c.delete(d)):t[r]=new io(n,o[r]);for(r=0;r<u;++r)(l=e[r])&&c.get(f[r])===l&&(i[r]=l)}function qd(n){return n.__data__}function Bd(n,e){if(!arguments.length)return Array.from(this,qd);var t=e?Ld:Wd,s=this._parents,i=this._groups;typeof n!="function"&&(n=zd(n));for(var o=i.length,a=new Array(o),r=new Array(o),l=new Array(o),c=0;c<o;++c){var u=s[c],h=i[c],f=h.length,d=Hd(n.call(u,u&&u.__data__,c,s)),m=d.length,g=r[c]=new Array(m),_=a[c]=new Array(m),p=l[c]=new Array(f);t(u,h,g,_,p,d,e);for(var v=0,y=0,k,b;v<m;++v)if(k=g[v]){for(v>=y&&(y=v+1);!(b=_[y])&&++y<m;);k._next=b||null}}return a=new xt(a,s),a._enter=r,a._exit=l,a}function Hd(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Xd(){return new xt(this._exit||this._groups.map(bu),this._parents)}function Yd(n,e,t){var s=this.enter(),i=this,o=this.exit();return typeof n=="function"?(s=n(s),s&&(s=s.selection())):s=s.append(n+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?o.remove():t(o),s&&i?s.merge(i).order():i}function jd(n){for(var e=n.selection?n.selection():n,t=this._groups,s=e._groups,i=t.length,o=s.length,a=Math.min(i,o),r=new Array(i),l=0;l<a;++l)for(var c=t[l],u=s[l],h=c.length,f=r[l]=new Array(h),d,m=0;m<h;++m)(d=c[m]||u[m])&&(f[m]=d);for(;l<i;++l)r[l]=t[l];return new xt(r,this._parents)}function Ud(){for(var n=this._groups,e=-1,t=n.length;++e<t;)for(var s=n[e],i=s.length-1,o=s[i],a;--i>=0;)(a=s[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Gd(n){n||(n=Zd);function e(h,f){return h&&f?n(h.__data__,f.__data__):!h-!f}for(var t=this._groups,s=t.length,i=new Array(s),o=0;o<s;++o){for(var a=t[o],r=a.length,l=i[o]=new Array(r),c,u=0;u<r;++u)(c=a[u])&&(l[u]=c);l.sort(e)}return new xt(i,this._parents).order()}function Zd(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function Kd(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function Qd(){return Array.from(this)}function Jd(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var s=n[e],i=0,o=s.length;i<o;++i){var a=s[i];if(a)return a}return null}function $d(){let n=0;for(const e of this)++n;return n}function em(){return!this.node()}function tm(n){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var i=e[t],o=0,a=i.length,r;o<a;++o)(r=i[o])&&n.call(r,r.__data__,o,i);return this}function nm(n){return function(){this.removeAttribute(n)}}function sm(n){return function(){this.removeAttributeNS(n.space,n.local)}}function im(n,e){return function(){this.setAttribute(n,e)}}function om(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function rm(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(n):this.setAttribute(n,t)}}function am(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}function lm(n,e){var t=Vo(n);if(arguments.length<2){var s=this.node();return t.local?s.getAttributeNS(t.space,t.local):s.getAttribute(t)}return this.each((e==null?t.local?sm:nm:typeof e=="function"?t.local?am:rm:t.local?om:im)(t,e))}function wu(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function cm(n){return function(){this.style.removeProperty(n)}}function um(n,e,t){return function(){this.style.setProperty(n,e,t)}}function hm(n,e,t){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(n):this.style.setProperty(n,s,t)}}function fm(n,e,t){return arguments.length>1?this.each((e==null?cm:typeof e=="function"?hm:um)(n,e,t??"")):Ms(this.node(),n)}function Ms(n,e){return n.style.getPropertyValue(e)||wu(n).getComputedStyle(n,null).getPropertyValue(e)}function dm(n){return function(){delete this[n]}}function mm(n,e){return function(){this[n]=e}}function pm(n,e){return function(){var t=e.apply(this,arguments);t==null?delete this[n]:this[n]=t}}function gm(n,e){return arguments.length>1?this.each((e==null?dm:typeof e=="function"?pm:mm)(n,e)):this.node()[n]}function vu(n){return n.trim().split(/^|\s+/)}function ea(n){return n.classList||new ku(n)}function ku(n){this._node=n,this._names=vu(n.getAttribute("class")||"")}ku.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function Tu(n,e){for(var t=ea(n),s=-1,i=e.length;++s<i;)t.add(e[s])}function Su(n,e){for(var t=ea(n),s=-1,i=e.length;++s<i;)t.remove(e[s])}function _m(n){return function(){Tu(this,n)}}function ym(n){return function(){Su(this,n)}}function bm(n,e){return function(){(e.apply(this,arguments)?Tu:Su)(this,n)}}function wm(n,e){var t=vu(n+"");if(arguments.length<2){for(var s=ea(this.node()),i=-1,o=t.length;++i<o;)if(!s.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?bm:e?_m:ym)(t,e))}function vm(){this.textContent=""}function km(n){return function(){this.textContent=n}}function Tm(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function Sm(n){return arguments.length?this.each(n==null?vm:(typeof n=="function"?Tm:km)(n)):this.node().textContent}function Cm(){this.innerHTML=""}function Am(n){return function(){this.innerHTML=n}}function Nm(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function Em(n){return arguments.length?this.each(n==null?Cm:(typeof n=="function"?Nm:Am)(n)):this.node().innerHTML}function Mm(){this.nextSibling&&this.parentNode.appendChild(this)}function Om(){return this.each(Mm)}function Dm(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Im(){return this.each(Dm)}function Pm(n){var e=typeof n=="function"?n:pu(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Rm(){return null}function xm(n,e){var t=typeof n=="function"?n:pu(n),s=e==null?Rm:typeof e=="function"?e:$r(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),s.apply(this,arguments)||null)})}function Vm(){var n=this.parentNode;n&&n.removeChild(this)}function Fm(){return this.each(Vm)}function zm(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function Wm(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function Lm(n){return this.select(n?Wm:zm)}function qm(n){return arguments.length?this.property("__data__",n):this.node().__data__}function Bm(n){return function(e){n.call(this,e,this.__data__)}}function Hm(n){return n.trim().split(/^|\s+/).map(function(e){var t="",s=e.indexOf(".");return s>=0&&(t=e.slice(s+1),e=e.slice(0,s)),{type:e,name:t}})}function Xm(n){return function(){var e=this.__on;if(e){for(var t=0,s=-1,i=e.length,o;t<i;++t)o=e[t],(!n.type||o.type===n.type)&&o.name===n.name?this.removeEventListener(o.type,o.listener,o.options):e[++s]=o;++s?e.length=s:delete this.__on}}}function Ym(n,e,t){return function(){var s=this.__on,i,o=Bm(e);if(s){for(var a=0,r=s.length;a<r;++a)if((i=s[a]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=t),i.value=e;return}}this.addEventListener(n.type,o,t),i={type:n.type,name:n.name,value:e,listener:o,options:t},s?s.push(i):this.__on=[i]}}function jm(n,e,t){var s=Hm(n+""),i,o=s.length,a;if(arguments.length<2){var r=this.node().__on;if(r){for(var l=0,c=r.length,u;l<c;++l)for(i=0,u=r[l];i<o;++i)if((a=s[i]).type===u.type&&a.name===u.name)return u.value}return}for(r=e?Ym:Xm,i=0;i<o;++i)this.each(r(s[i],e,t));return this}function Cu(n,e,t){var s=wu(n),i=s.CustomEvent;typeof i=="function"?i=new i(e,t):(i=s.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),n.dispatchEvent(i)}function Um(n,e){return function(){return Cu(this,n,e)}}function Gm(n,e){return function(){return Cu(this,n,e.apply(this,arguments))}}function Zm(n,e){return this.each((typeof e=="function"?Gm:Um)(n,e))}function*Km(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var s=n[e],i=0,o=s.length,a;i<o;++i)(a=s[i])&&(yield a)}var Au=[null];function xt(n,e){this._groups=n,this._parents=e}function mi(){return new xt([[document.documentElement]],Au)}function Qm(){return this}xt.prototype=mi.prototype={constructor:xt,select:Td,selectAll:Nd,selectChild:Dd,selectChildren:xd,filter:Vd,data:Bd,enter:Fd,exit:Xd,join:Yd,merge:jd,selection:Qm,order:Ud,sort:Gd,call:Kd,nodes:Qd,node:Jd,size:$d,empty:em,each:tm,attr:lm,style:fm,property:gm,classed:wm,text:Sm,html:Em,raise:Om,lower:Im,append:Pm,insert:xm,remove:Fm,clone:Lm,datum:qm,on:jm,dispatch:Zm,[Symbol.iterator]:Km};function Lt(n){return typeof n=="string"?new xt([[document.querySelector(n)]],[document.documentElement]):new xt([[n]],Au)}function Jm(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Yt(n,e){if(n=Jm(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var s=t.createSVGPoint();return s.x=n.clientX,s.y=n.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop]}}return[n.pageX,n.pageY]}const $m={passive:!1},ni={capture:!0,passive:!1};function mr(n){n.stopImmediatePropagation()}function ks(n){n.preventDefault(),n.stopImmediatePropagation()}function Nu(n){var e=n.document.documentElement,t=Lt(n).on("dragstart.drag",ks,ni);"onselectstart"in e?t.on("selectstart.drag",ks,ni):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Eu(n,e){var t=n.document.documentElement,s=Lt(n).on("dragstart.drag",null);e&&(s.on("click.drag",ks,ni),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in t?s.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const xi=n=>()=>n;function Nr(n,{sourceEvent:e,subject:t,target:s,identifier:i,active:o,x:a,y:r,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:r,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Nr.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function ep(n){return!n.ctrlKey&&!n.button}function tp(){return this.parentNode}function np(n,e){return e??{x:n.x,y:n.y}}function sp(){return navigator.maxTouchPoints||"ontouchstart"in this}function ip(){var n=ep,e=tp,t=np,s=sp,i={},o=xo("start","drag","end"),a=0,r,l,c,u,h=0;function f(k){k.on("mousedown.drag",d).filter(s).on("touchstart.drag",_).on("touchmove.drag",p,$m).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(k,b){if(!(u||!n.call(this,k,b))){var N=y(this,e.call(this,k,b),k,b,"mouse");N&&(Lt(k.view).on("mousemove.drag",m,ni).on("mouseup.drag",g,ni),Nu(k.view),mr(k),c=!1,r=k.clientX,l=k.clientY,N("start",k))}}function m(k){if(ks(k),!c){var b=k.clientX-r,N=k.clientY-l;c=b*b+N*N>h}i.mouse("drag",k)}function g(k){Lt(k.view).on("mousemove.drag mouseup.drag",null),Eu(k.view,c),ks(k),i.mouse("end",k)}function _(k,b){if(n.call(this,k,b)){var N=k.changedTouches,T=e.call(this,k,b),S=N.length,M,O;for(M=0;M<S;++M)(O=y(this,T,k,b,N[M].identifier,N[M]))&&(mr(k),O("start",k,N[M]))}}function p(k){var b=k.changedTouches,N=b.length,T,S;for(T=0;T<N;++T)(S=i[b[T].identifier])&&(ks(k),S("drag",k,b[T]))}function v(k){var b=k.changedTouches,N=b.length,T,S;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),T=0;T<N;++T)(S=i[b[T].identifier])&&(mr(k),S("end",k,b[T]))}function y(k,b,N,T,S,M){var O=o.copy(),P=Yt(M||N,b),D,I,w;if((w=t.call(k,new Nr("beforestart",{sourceEvent:N,target:f,identifier:S,active:a,x:P[0],y:P[1],dx:0,dy:0,dispatch:O}),T))!=null)return D=w.x-P[0]||0,I=w.y-P[1]||0,function E(A,R,z){var F=P,L;switch(A){case"start":i[S]=E,L=a++;break;case"end":delete i[S],--a;case"drag":P=Yt(z||R,b),L=a;break}O.call(A,k,new Nr(A,{sourceEvent:R,subject:w,target:f,identifier:S,active:L,x:P[0]+D,y:P[1]+I,dx:P[0]-F[0],dy:P[1]-F[1],dispatch:O}),T)}}return f.filter=function(k){return arguments.length?(n=typeof k=="function"?k:xi(!!k),f):n},f.container=function(k){return arguments.length?(e=typeof k=="function"?k:xi(k),f):e},f.subject=function(k){return arguments.length?(t=typeof k=="function"?k:xi(k),f):t},f.touchable=function(k){return arguments.length?(s=typeof k=="function"?k:xi(!!k),f):s},f.on=function(){var k=o.on.apply(o,arguments);return k===o?f:k},f.clickDistance=function(k){return arguments.length?(h=(k=+k)*k,f):Math.sqrt(h)},f}function ta(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function Mu(n,e){var t=Object.create(n.prototype);for(var s in e)t[s]=e[s];return t}function pi(){}var si=.7,oo=1/si,Ts="\\s*([+-]?\\d+)\\s*",ii="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",op=/^#([0-9a-f]{3,8})$/,rp=new RegExp(`^rgb\\(${Ts},${Ts},${Ts}\\)$`),ap=new RegExp(`^rgb\\(${rn},${rn},${rn}\\)$`),lp=new RegExp(`^rgba\\(${Ts},${Ts},${Ts},${ii}\\)$`),cp=new RegExp(`^rgba\\(${rn},${rn},${rn},${ii}\\)$`),up=new RegExp(`^hsl\\(${ii},${rn},${rn}\\)$`),hp=new RegExp(`^hsla\\(${ii},${rn},${rn},${ii}\\)$`),gl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ta(pi,oi,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:_l,formatHex:_l,formatHex8:fp,formatHsl:dp,formatRgb:yl,toString:yl});function _l(){return this.rgb().formatHex()}function fp(){return this.rgb().formatHex8()}function dp(){return Ou(this).formatHsl()}function yl(){return this.rgb().formatRgb()}function oi(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=op.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?bl(e):t===3?new St(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Vi(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Vi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=rp.exec(n))?new St(e[1],e[2],e[3],1):(e=ap.exec(n))?new St(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=lp.exec(n))?Vi(e[1],e[2],e[3],e[4]):(e=cp.exec(n))?Vi(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=up.exec(n))?kl(e[1],e[2]/100,e[3]/100,1):(e=hp.exec(n))?kl(e[1],e[2]/100,e[3]/100,e[4]):gl.hasOwnProperty(n)?bl(gl[n]):n==="transparent"?new St(NaN,NaN,NaN,0):null}function bl(n){return new St(n>>16&255,n>>8&255,n&255,1)}function Vi(n,e,t,s){return s<=0&&(n=e=t=NaN),new St(n,e,t,s)}function mp(n){return n instanceof pi||(n=oi(n)),n?(n=n.rgb(),new St(n.r,n.g,n.b,n.opacity)):new St}function Er(n,e,t,s){return arguments.length===1?mp(n):new St(n,e,t,s??1)}function St(n,e,t,s){this.r=+n,this.g=+e,this.b=+t,this.opacity=+s}ta(St,Er,Mu(pi,{brighter(n){return n=n==null?oo:Math.pow(oo,n),new St(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?si:Math.pow(si,n),new St(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new St(jn(this.r),jn(this.g),jn(this.b),ro(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wl,formatHex:wl,formatHex8:pp,formatRgb:vl,toString:vl}));function wl(){return`#${Xn(this.r)}${Xn(this.g)}${Xn(this.b)}`}function pp(){return`#${Xn(this.r)}${Xn(this.g)}${Xn(this.b)}${Xn((isNaN(this.opacity)?1:this.opacity)*255)}`}function vl(){const n=ro(this.opacity);return`${n===1?"rgb(":"rgba("}${jn(this.r)}, ${jn(this.g)}, ${jn(this.b)}${n===1?")":`, ${n})`}`}function ro(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function jn(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Xn(n){return n=jn(n),(n<16?"0":"")+n.toString(16)}function kl(n,e,t,s){return s<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new Ut(n,e,t,s)}function Ou(n){if(n instanceof Ut)return new Ut(n.h,n.s,n.l,n.opacity);if(n instanceof pi||(n=oi(n)),!n)return new Ut;if(n instanceof Ut)return n;n=n.rgb();var e=n.r/255,t=n.g/255,s=n.b/255,i=Math.min(e,t,s),o=Math.max(e,t,s),a=NaN,r=o-i,l=(o+i)/2;return r?(e===o?a=(t-s)/r+(t<s)*6:t===o?a=(s-e)/r+2:a=(e-t)/r+4,r/=l<.5?o+i:2-o-i,a*=60):r=l>0&&l<1?0:a,new Ut(a,r,l,n.opacity)}function gp(n,e,t,s){return arguments.length===1?Ou(n):new Ut(n,e,t,s??1)}function Ut(n,e,t,s){this.h=+n,this.s=+e,this.l=+t,this.opacity=+s}ta(Ut,gp,Mu(pi,{brighter(n){return n=n==null?oo:Math.pow(oo,n),new Ut(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?si:Math.pow(si,n),new Ut(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,s=t+(t<.5?t:1-t)*e,i=2*t-s;return new St(pr(n>=240?n-240:n+120,i,s),pr(n,i,s),pr(n<120?n+240:n-120,i,s),this.opacity)},clamp(){return new Ut(Tl(this.h),Fi(this.s),Fi(this.l),ro(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=ro(this.opacity);return`${n===1?"hsl(":"hsla("}${Tl(this.h)}, ${Fi(this.s)*100}%, ${Fi(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Tl(n){return n=(n||0)%360,n<0?n+360:n}function Fi(n){return Math.max(0,Math.min(1,n||0))}function pr(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const Du=n=>()=>n;function _p(n,e){return function(t){return n+t*e}}function yp(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(s){return Math.pow(n+s*e,t)}}function bp(n){return(n=+n)==1?Iu:function(e,t){return t-e?yp(e,t,n):Du(isNaN(e)?t:e)}}function Iu(n,e){var t=e-n;return t?_p(n,t):Du(isNaN(n)?e:n)}const Sl=function n(e){var t=bp(e);function s(i,o){var a=t((i=Er(i)).r,(o=Er(o)).r),r=t(i.g,o.g),l=t(i.b,o.b),c=Iu(i.opacity,o.opacity);return function(u){return i.r=a(u),i.g=r(u),i.b=l(u),i.opacity=c(u),i+""}}return s.gamma=n,s}(1);function On(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}var Mr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gr=new RegExp(Mr.source,"g");function wp(n){return function(){return n}}function vp(n){return function(e){return n(e)+""}}function kp(n,e){var t=Mr.lastIndex=gr.lastIndex=0,s,i,o,a=-1,r=[],l=[];for(n=n+"",e=e+"";(s=Mr.exec(n))&&(i=gr.exec(e));)(o=i.index)>t&&(o=e.slice(t,o),r[a]?r[a]+=o:r[++a]=o),(s=s[0])===(i=i[0])?r[a]?r[a]+=i:r[++a]=i:(r[++a]=null,l.push({i:a,x:On(s,i)})),t=gr.lastIndex;return t<e.length&&(o=e.slice(t),r[a]?r[a]+=o:r[++a]=o),r.length<2?l[0]?vp(l[0].x):wp(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)r[(h=l[u]).i]=h.x(c);return r.join("")})}var Cl=180/Math.PI,Or={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Pu(n,e,t,s,i,o){var a,r,l;return(a=Math.sqrt(n*n+e*e))&&(n/=a,e/=a),(l=n*t+e*s)&&(t-=n*l,s-=e*l),(r=Math.sqrt(t*t+s*s))&&(t/=r,s/=r,l/=r),n*s<e*t&&(n=-n,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,n)*Cl,skewX:Math.atan(l)*Cl,scaleX:a,scaleY:r}}var zi;function Tp(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?Or:Pu(e.a,e.b,e.c,e.d,e.e,e.f)}function Sp(n){return n==null||(zi||(zi=document.createElementNS("http://www.w3.org/2000/svg","g")),zi.setAttribute("transform",n),!(n=zi.transform.baseVal.consolidate()))?Or:(n=n.matrix,Pu(n.a,n.b,n.c,n.d,n.e,n.f))}function Ru(n,e,t,s){function i(c){return c.length?c.pop()+" ":""}function o(c,u,h,f,d,m){if(c!==h||u!==f){var g=d.push("translate(",null,e,null,t);m.push({i:g-4,x:On(c,h)},{i:g-2,x:On(u,f)})}else(h||f)&&d.push("translate("+h+e+f+t)}function a(c,u,h,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:h.push(i(h)+"rotate(",null,s)-2,x:On(c,u)})):u&&h.push(i(h)+"rotate("+u+s)}function r(c,u,h,f){c!==u?f.push({i:h.push(i(h)+"skewX(",null,s)-2,x:On(c,u)}):u&&h.push(i(h)+"skewX("+u+s)}function l(c,u,h,f,d,m){if(c!==h||u!==f){var g=d.push(i(d)+"scale(",null,",",null,")");m.push({i:g-4,x:On(c,h)},{i:g-2,x:On(u,f)})}else(h!==1||f!==1)&&d.push(i(d)+"scale("+h+","+f+")")}return function(c,u){var h=[],f=[];return c=n(c),u=n(u),o(c.translateX,c.translateY,u.translateX,u.translateY,h,f),a(c.rotate,u.rotate,h,f),r(c.skewX,u.skewX,h,f),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,f),c=u=null,function(d){for(var m=-1,g=f.length,_;++m<g;)h[(_=f[m]).i]=_.x(d);return h.join("")}}}var Cp=Ru(Tp,"px, ","px)","deg)"),Ap=Ru(Sp,", ",")",")"),Np=1e-12;function Al(n){return((n=Math.exp(n))+1/n)/2}function Ep(n){return((n=Math.exp(n))-1/n)/2}function Mp(n){return((n=Math.exp(2*n))-1)/(n+1)}const Op=function n(e,t,s){function i(o,a){var r=o[0],l=o[1],c=o[2],u=a[0],h=a[1],f=a[2],d=u-r,m=h-l,g=d*d+m*m,_,p;if(g<Np)p=Math.log(f/c)/e,_=function(T){return[r+T*d,l+T*m,c*Math.exp(e*T*p)]};else{var v=Math.sqrt(g),y=(f*f-c*c+s*g)/(2*c*t*v),k=(f*f-c*c-s*g)/(2*f*t*v),b=Math.log(Math.sqrt(y*y+1)-y),N=Math.log(Math.sqrt(k*k+1)-k);p=(N-b)/e,_=function(T){var S=T*p,M=Al(b),O=c/(t*v)*(M*Mp(e*S+b)-Ep(b));return[r+O*d,l+O*m,c*M/Al(e*S+b)]}}return _.duration=p*1e3*e/Math.SQRT2,_}return i.rho=function(o){var a=Math.max(.001,+o),r=a*a,l=r*r;return n(a,r,l)},i}(Math.SQRT2,2,4);var Os=0,Ks=0,Gs=0,xu=1e3,ao,Qs,lo=0,Un=0,Fo=0,ri=typeof performance=="object"&&performance.now?performance:Date,Vu=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function na(){return Un||(Vu(Dp),Un=ri.now()+Fo)}function Dp(){Un=0}function co(){this._call=this._time=this._next=null}co.prototype=Fu.prototype={constructor:co,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?na():+t)+(e==null?0:+e),!this._next&&Qs!==this&&(Qs?Qs._next=this:ao=this,Qs=this),this._call=n,this._time=t,Dr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Dr())}};function Fu(n,e,t){var s=new co;return s.restart(n,e,t),s}function Ip(){na(),++Os;for(var n=ao,e;n;)(e=Un-n._time)>=0&&n._call.call(void 0,e),n=n._next;--Os}function Nl(){Un=(lo=ri.now())+Fo,Os=Ks=0;try{Ip()}finally{Os=0,Rp(),Un=0}}function Pp(){var n=ri.now(),e=n-lo;e>xu&&(Fo-=e,lo=n)}function Rp(){for(var n,e=ao,t,s=1/0;e;)e._call?(s>e._time&&(s=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:ao=t);Qs=n,Dr(s)}function Dr(n){if(!Os){Ks&&(Ks=clearTimeout(Ks));var e=n-Un;e>24?(n<1/0&&(Ks=setTimeout(Nl,n-ri.now()-Fo)),Gs&&(Gs=clearInterval(Gs))):(Gs||(lo=ri.now(),Gs=setInterval(Pp,xu)),Os=1,Vu(Nl))}}function El(n,e,t){var s=new co;return e=e==null?0:+e,s.restart(i=>{s.stop(),n(i+e)},e,t),s}var xp=xo("start","end","cancel","interrupt"),Vp=[],zu=0,Ml=1,Ir=2,Gi=3,Ol=4,Pr=5,Zi=6;function zo(n,e,t,s,i,o){var a=n.__transition;if(!a)n.__transition={};else if(t in a)return;Fp(n,t,{name:e,index:s,group:i,on:xp,tween:Vp,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:zu})}function sa(n,e){var t=Jt(n,e);if(t.state>zu)throw new Error("too late; already scheduled");return t}function hn(n,e){var t=Jt(n,e);if(t.state>Gi)throw new Error("too late; already running");return t}function Jt(n,e){var t=n.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function Fp(n,e,t){var s=n.__transition,i;s[e]=t,t.timer=Fu(o,0,t.time);function o(c){t.state=Ml,t.timer.restart(a,t.delay,t.time),t.delay<=c&&a(c-t.delay)}function a(c){var u,h,f,d;if(t.state!==Ml)return l();for(u in s)if(d=s[u],d.name===t.name){if(d.state===Gi)return El(a);d.state===Ol?(d.state=Zi,d.timer.stop(),d.on.call("interrupt",n,n.__data__,d.index,d.group),delete s[u]):+u<e&&(d.state=Zi,d.timer.stop(),d.on.call("cancel",n,n.__data__,d.index,d.group),delete s[u])}if(El(function(){t.state===Gi&&(t.state=Ol,t.timer.restart(r,t.delay,t.time),r(c))}),t.state=Ir,t.on.call("start",n,n.__data__,t.index,t.group),t.state===Ir){for(t.state=Gi,i=new Array(f=t.tween.length),u=0,h=-1;u<f;++u)(d=t.tween[u].value.call(n,n.__data__,t.index,t.group))&&(i[++h]=d);i.length=h+1}}function r(c){for(var u=c<t.duration?t.ease.call(null,c/t.duration):(t.timer.restart(l),t.state=Pr,1),h=-1,f=i.length;++h<f;)i[h].call(n,u);t.state===Pr&&(t.on.call("end",n,n.__data__,t.index,t.group),l())}function l(){t.state=Zi,t.timer.stop(),delete s[e];for(var c in s)return;delete n.__transition}}function Ki(n,e){var t=n.__transition,s,i,o=!0,a;if(t){e=e==null?null:e+"";for(a in t){if((s=t[a]).name!==e){o=!1;continue}i=s.state>Ir&&s.state<Pr,s.state=Zi,s.timer.stop(),s.on.call(i?"interrupt":"cancel",n,n.__data__,s.index,s.group),delete t[a]}o&&delete n.__transition}}function zp(n){return this.each(function(){Ki(this,n)})}function Wp(n,e){var t,s;return function(){var i=hn(this,n),o=i.tween;if(o!==t){s=t=o;for(var a=0,r=s.length;a<r;++a)if(s[a].name===e){s=s.slice(),s.splice(a,1);break}}i.tween=s}}function Lp(n,e,t){var s,i;if(typeof t!="function")throw new Error;return function(){var o=hn(this,n),a=o.tween;if(a!==s){i=(s=a).slice();for(var r={name:e,value:t},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=r;break}l===c&&i.push(r)}o.tween=i}}function qp(n,e){var t=this._id;if(n+="",arguments.length<2){for(var s=Jt(this.node(),t).tween,i=0,o=s.length,a;i<o;++i)if((a=s[i]).name===n)return a.value;return null}return this.each((e==null?Wp:Lp)(t,n,e))}function ia(n,e,t){var s=n._id;return n.each(function(){var i=hn(this,s);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return Jt(i,s).value[e]}}function Wu(n,e){var t;return(typeof e=="number"?On:e instanceof oi?Sl:(t=oi(e))?(e=t,Sl):kp)(n,e)}function Bp(n){return function(){this.removeAttribute(n)}}function Hp(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Xp(n,e,t){var s,i=t+"",o;return function(){var a=this.getAttribute(n);return a===i?null:a===s?o:o=e(s=a,t)}}function Yp(n,e,t){var s,i=t+"",o;return function(){var a=this.getAttributeNS(n.space,n.local);return a===i?null:a===s?o:o=e(s=a,t)}}function jp(n,e,t){var s,i,o;return function(){var a,r=t(this),l;return r==null?void this.removeAttribute(n):(a=this.getAttribute(n),l=r+"",a===l?null:a===s&&l===i?o:(i=l,o=e(s=a,r)))}}function Up(n,e,t){var s,i,o;return function(){var a,r=t(this),l;return r==null?void this.removeAttributeNS(n.space,n.local):(a=this.getAttributeNS(n.space,n.local),l=r+"",a===l?null:a===s&&l===i?o:(i=l,o=e(s=a,r)))}}function Gp(n,e){var t=Vo(n),s=t==="transform"?Ap:Wu;return this.attrTween(n,typeof e=="function"?(t.local?Up:jp)(t,s,ia(this,"attr."+n,e)):e==null?(t.local?Hp:Bp)(t):(t.local?Yp:Xp)(t,s,e))}function Zp(n,e){return function(t){this.setAttribute(n,e.call(this,t))}}function Kp(n,e){return function(t){this.setAttributeNS(n.space,n.local,e.call(this,t))}}function Qp(n,e){var t,s;function i(){var o=e.apply(this,arguments);return o!==s&&(t=(s=o)&&Kp(n,o)),t}return i._value=e,i}function Jp(n,e){var t,s;function i(){var o=e.apply(this,arguments);return o!==s&&(t=(s=o)&&Zp(n,o)),t}return i._value=e,i}function $p(n,e){var t="attr."+n;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var s=Vo(n);return this.tween(t,(s.local?Qp:Jp)(s,e))}function eg(n,e){return function(){sa(this,n).delay=+e.apply(this,arguments)}}function tg(n,e){return e=+e,function(){sa(this,n).delay=e}}function ng(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?eg:tg)(e,n)):Jt(this.node(),e).delay}function sg(n,e){return function(){hn(this,n).duration=+e.apply(this,arguments)}}function ig(n,e){return e=+e,function(){hn(this,n).duration=e}}function og(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?sg:ig)(e,n)):Jt(this.node(),e).duration}function rg(n,e){if(typeof e!="function")throw new Error;return function(){hn(this,n).ease=e}}function ag(n){var e=this._id;return arguments.length?this.each(rg(e,n)):Jt(this.node(),e).ease}function lg(n,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;hn(this,n).ease=t}}function cg(n){if(typeof n!="function")throw new Error;return this.each(lg(this._id,n))}function ug(n){typeof n!="function"&&(n=_u(n));for(var e=this._groups,t=e.length,s=new Array(t),i=0;i<t;++i)for(var o=e[i],a=o.length,r=s[i]=[],l,c=0;c<a;++c)(l=o[c])&&n.call(l,l.__data__,c,o)&&r.push(l);return new kn(s,this._parents,this._name,this._id)}function hg(n){if(n._id!==this._id)throw new Error;for(var e=this._groups,t=n._groups,s=e.length,i=t.length,o=Math.min(s,i),a=new Array(s),r=0;r<o;++r)for(var l=e[r],c=t[r],u=l.length,h=a[r]=new Array(u),f,d=0;d<u;++d)(f=l[d]||c[d])&&(h[d]=f);for(;r<s;++r)a[r]=e[r];return new kn(a,this._parents,this._name,this._id)}function fg(n){return(n+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function dg(n,e,t){var s,i,o=fg(e)?sa:hn;return function(){var a=o(this,n),r=a.on;r!==s&&(i=(s=r).copy()).on(e,t),a.on=i}}function mg(n,e){var t=this._id;return arguments.length<2?Jt(this.node(),t).on.on(n):this.each(dg(t,n,e))}function pg(n){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}}function gg(){return this.on("end.remove",pg(this._id))}function _g(n){var e=this._name,t=this._id;typeof n!="function"&&(n=$r(n));for(var s=this._groups,i=s.length,o=new Array(i),a=0;a<i;++a)for(var r=s[a],l=r.length,c=o[a]=new Array(l),u,h,f=0;f<l;++f)(u=r[f])&&(h=n.call(u,u.__data__,f,r))&&("__data__"in u&&(h.__data__=u.__data__),c[f]=h,zo(c[f],e,t,f,c,Jt(u,t)));return new kn(o,this._parents,e,t)}function yg(n){var e=this._name,t=this._id;typeof n!="function"&&(n=gu(n));for(var s=this._groups,i=s.length,o=[],a=[],r=0;r<i;++r)for(var l=s[r],c=l.length,u,h=0;h<c;++h)if(u=l[h]){for(var f=n.call(u,u.__data__,h,l),d,m=Jt(u,t),g=0,_=f.length;g<_;++g)(d=f[g])&&zo(d,e,t,g,f,m);o.push(f),a.push(u)}return new kn(o,a,e,t)}var bg=mi.prototype.constructor;function wg(){return new bg(this._groups,this._parents)}function vg(n,e){var t,s,i;return function(){var o=Ms(this,n),a=(this.style.removeProperty(n),Ms(this,n));return o===a?null:o===t&&a===s?i:i=e(t=o,s=a)}}function Lu(n){return function(){this.style.removeProperty(n)}}function kg(n,e,t){var s,i=t+"",o;return function(){var a=Ms(this,n);return a===i?null:a===s?o:o=e(s=a,t)}}function Tg(n,e,t){var s,i,o;return function(){var a=Ms(this,n),r=t(this),l=r+"";return r==null&&(l=r=(this.style.removeProperty(n),Ms(this,n))),a===l?null:a===s&&l===i?o:(i=l,o=e(s=a,r))}}function Sg(n,e){var t,s,i,o="style."+e,a="end."+o,r;return function(){var l=hn(this,n),c=l.on,u=l.value[o]==null?r||(r=Lu(e)):void 0;(c!==t||i!==u)&&(s=(t=c).copy()).on(a,i=u),l.on=s}}function Cg(n,e,t){var s=(n+="")=="transform"?Cp:Wu;return e==null?this.styleTween(n,vg(n,s)).on("end.style."+n,Lu(n)):typeof e=="function"?this.styleTween(n,Tg(n,s,ia(this,"style."+n,e))).each(Sg(this._id,n)):this.styleTween(n,kg(n,s,e),t).on("end.style."+n,null)}function Ag(n,e,t){return function(s){this.style.setProperty(n,e.call(this,s),t)}}function Ng(n,e,t){var s,i;function o(){var a=e.apply(this,arguments);return a!==i&&(s=(i=a)&&Ag(n,a,t)),s}return o._value=e,o}function Eg(n,e,t){var s="style."+(n+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,Ng(n,e,t??""))}function Mg(n){return function(){this.textContent=n}}function Og(n){return function(){var e=n(this);this.textContent=e??""}}function Dg(n){return this.tween("text",typeof n=="function"?Og(ia(this,"text",n)):Mg(n==null?"":n+""))}function Ig(n){return function(e){this.textContent=n.call(this,e)}}function Pg(n){var e,t;function s(){var i=n.apply(this,arguments);return i!==t&&(e=(t=i)&&Ig(i)),e}return s._value=n,s}function Rg(n){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;return this.tween(e,Pg(n))}function xg(){for(var n=this._name,e=this._id,t=qu(),s=this._groups,i=s.length,o=0;o<i;++o)for(var a=s[o],r=a.length,l,c=0;c<r;++c)if(l=a[c]){var u=Jt(l,e);zo(l,n,t,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new kn(s,this._parents,n,t)}function Vg(){var n,e,t=this,s=t._id,i=t.size();return new Promise(function(o,a){var r={value:a},l={value:function(){--i===0&&o()}};t.each(function(){var c=hn(this,s),u=c.on;u!==n&&(e=(n=u).copy(),e._.cancel.push(r),e._.interrupt.push(r),e._.end.push(l)),c.on=e}),i===0&&o()})}var Fg=0;function kn(n,e,t,s){this._groups=n,this._parents=e,this._name=t,this._id=s}function qu(){return++Fg}var gn=mi.prototype;kn.prototype={constructor:kn,select:_g,selectAll:yg,selectChild:gn.selectChild,selectChildren:gn.selectChildren,filter:ug,merge:hg,selection:wg,transition:xg,call:gn.call,nodes:gn.nodes,node:gn.node,size:gn.size,empty:gn.empty,each:gn.each,on:mg,attr:Gp,attrTween:$p,style:Cg,styleTween:Eg,text:Dg,textTween:Rg,remove:gg,tween:qp,delay:ng,duration:og,ease:ag,easeVarying:cg,end:Vg,[Symbol.iterator]:gn[Symbol.iterator]};function zg(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Wg={time:null,delay:0,duration:250,ease:zg};function Lg(n,e){for(var t;!(t=n.__transition)||!(t=t[e]);)if(!(n=n.parentNode))throw new Error(`transition ${e} not found`);return t}function qg(n){var e,t;n instanceof kn?(e=n._id,n=n._name):(e=qu(),(t=Wg).time=na(),n=n==null?null:n+"");for(var s=this._groups,i=s.length,o=0;o<i;++o)for(var a=s[o],r=a.length,l,c=0;c<r;++c)(l=a[c])&&zo(l,n,e,c,a,t||Lg(l,e));return new kn(s,this._parents,n,e)}mi.prototype.interrupt=zp;mi.prototype.transition=qg;const Wi=n=>()=>n;function Bg(n,{sourceEvent:e,target:t,transform:s,dispatch:i}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function yn(n,e,t){this.k=n,this.x=e,this.y=t}yn.prototype={constructor:yn,scale:function(n){return n===1?this:new yn(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new yn(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Wo=new yn(1,0,0);Bu.prototype=yn.prototype;function Bu(n){for(;!n.__zoom;)if(!(n=n.parentNode))return Wo;return n.__zoom}function _r(n){n.stopImmediatePropagation()}function Zs(n){n.preventDefault(),n.stopImmediatePropagation()}function Hg(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function Xg(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function Dl(){return this.__zoom||Wo}function Yg(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function jg(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ug(n,e,t){var s=n.invertX(e[0][0])-t[0][0],i=n.invertX(e[1][0])-t[1][0],o=n.invertY(e[0][1])-t[0][1],a=n.invertY(e[1][1])-t[1][1];return n.translate(i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function Hu(){var n=Hg,e=Xg,t=Ug,s=Yg,i=jg,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],r=250,l=Op,c=xo("start","zoom","end"),u,h,f,d=500,m=150,g=0,_=10;function p(w){w.property("__zoom",Dl).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",O).filter(i).on("touchstart.zoom",P).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",I).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(w,E,A,R){var z=w.selection?w.selection():w;z.property("__zoom",Dl),w!==z?b(w,E,A,R):z.interrupt().each(function(){N(this,arguments).event(R).start().zoom(null,typeof E=="function"?E.apply(this,arguments):E).end()})},p.scaleBy=function(w,E,A,R){p.scaleTo(w,function(){var z=this.__zoom.k,F=typeof E=="function"?E.apply(this,arguments):E;return z*F},A,R)},p.scaleTo=function(w,E,A,R){p.transform(w,function(){var z=e.apply(this,arguments),F=this.__zoom,L=A==null?k(z):typeof A=="function"?A.apply(this,arguments):A,q=F.invert(L),H=typeof E=="function"?E.apply(this,arguments):E;return t(y(v(F,H),L,q),z,a)},A,R)},p.translateBy=function(w,E,A,R){p.transform(w,function(){return t(this.__zoom.translate(typeof E=="function"?E.apply(this,arguments):E,typeof A=="function"?A.apply(this,arguments):A),e.apply(this,arguments),a)},null,R)},p.translateTo=function(w,E,A,R,z){p.transform(w,function(){var F=e.apply(this,arguments),L=this.__zoom,q=R==null?k(F):typeof R=="function"?R.apply(this,arguments):R;return t(Wo.translate(q[0],q[1]).scale(L.k).translate(typeof E=="function"?-E.apply(this,arguments):-E,typeof A=="function"?-A.apply(this,arguments):-A),F,a)},R,z)};function v(w,E){return E=Math.max(o[0],Math.min(o[1],E)),E===w.k?w:new yn(E,w.x,w.y)}function y(w,E,A){var R=E[0]-A[0]*w.k,z=E[1]-A[1]*w.k;return R===w.x&&z===w.y?w:new yn(w.k,R,z)}function k(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function b(w,E,A,R){w.on("start.zoom",function(){N(this,arguments).event(R).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(R).end()}).tween("zoom",function(){var z=this,F=arguments,L=N(z,F).event(R),q=e.apply(z,F),H=A==null?k(q):typeof A=="function"?A.apply(z,F):A,j=Math.max(q[1][0]-q[0][0],q[1][1]-q[0][1]),B=z.__zoom,te=typeof E=="function"?E.apply(z,F):E,re=l(B.invert(H).concat(j/B.k),te.invert(H).concat(j/te.k));return function(J){if(J===1)J=te;else{var ne=re(J),se=j/ne[2];J=new yn(se,H[0]-ne[0]*se,H[1]-ne[1]*se)}L.zoom(null,J)}})}function N(w,E,A){return!A&&w.__zooming||new T(w,E)}function T(w,E){this.that=w,this.args=E,this.active=0,this.sourceEvent=null,this.extent=e.apply(w,E),this.taps=0}T.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,E){return this.mouse&&w!=="mouse"&&(this.mouse[1]=E.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=E.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=E.invert(this.touch1[0])),this.that.__zoom=E,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var E=Lt(this.that).datum();c.call(w,this.that,new Bg(w,{sourceEvent:this.sourceEvent,target:p,type:w,transform:this.that.__zoom,dispatch:c}),E)}};function S(w,...E){if(!n.apply(this,arguments))return;var A=N(this,E).event(w),R=this.__zoom,z=Math.max(o[0],Math.min(o[1],R.k*Math.pow(2,s.apply(this,arguments)))),F=Yt(w);if(A.wheel)(A.mouse[0][0]!==F[0]||A.mouse[0][1]!==F[1])&&(A.mouse[1]=R.invert(A.mouse[0]=F)),clearTimeout(A.wheel);else{if(R.k===z)return;A.mouse=[F,R.invert(F)],Ki(this),A.start()}Zs(w),A.wheel=setTimeout(L,m),A.zoom("mouse",t(y(v(R,z),A.mouse[0],A.mouse[1]),A.extent,a));function L(){A.wheel=null,A.end()}}function M(w,...E){if(f||!n.apply(this,arguments))return;var A=w.currentTarget,R=N(this,E,!0).event(w),z=Lt(w.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",j,!0),F=Yt(w,A),L=w.clientX,q=w.clientY;Nu(w.view),_r(w),R.mouse=[F,this.__zoom.invert(F)],Ki(this),R.start();function H(B){if(Zs(B),!R.moved){var te=B.clientX-L,re=B.clientY-q;R.moved=te*te+re*re>g}R.event(B).zoom("mouse",t(y(R.that.__zoom,R.mouse[0]=Yt(B,A),R.mouse[1]),R.extent,a))}function j(B){z.on("mousemove.zoom mouseup.zoom",null),Eu(B.view,R.moved),Zs(B),R.event(B).end()}}function O(w,...E){if(n.apply(this,arguments)){var A=this.__zoom,R=Yt(w.changedTouches?w.changedTouches[0]:w,this),z=A.invert(R),F=A.k*(w.shiftKey?.5:2),L=t(y(v(A,F),R,z),e.apply(this,E),a);Zs(w),r>0?Lt(this).transition().duration(r).call(b,L,R,w):Lt(this).call(p.transform,L,R,w)}}function P(w,...E){if(n.apply(this,arguments)){var A=w.touches,R=A.length,z=N(this,E,w.changedTouches.length===R).event(w),F,L,q,H;for(_r(w),L=0;L<R;++L)q=A[L],H=Yt(q,this),H=[H,this.__zoom.invert(H),q.identifier],z.touch0?!z.touch1&&z.touch0[2]!==H[2]&&(z.touch1=H,z.taps=0):(z.touch0=H,F=!0,z.taps=1+!!u);u&&(u=clearTimeout(u)),F&&(z.taps<2&&(h=H[0],u=setTimeout(function(){u=null},d)),Ki(this),z.start())}}function D(w,...E){if(this.__zooming){var A=N(this,E).event(w),R=w.changedTouches,z=R.length,F,L,q,H;for(Zs(w),F=0;F<z;++F)L=R[F],q=Yt(L,this),A.touch0&&A.touch0[2]===L.identifier?A.touch0[0]=q:A.touch1&&A.touch1[2]===L.identifier&&(A.touch1[0]=q);if(L=A.that.__zoom,A.touch1){var j=A.touch0[0],B=A.touch0[1],te=A.touch1[0],re=A.touch1[1],J=(J=te[0]-j[0])*J+(J=te[1]-j[1])*J,ne=(ne=re[0]-B[0])*ne+(ne=re[1]-B[1])*ne;L=v(L,Math.sqrt(J/ne)),q=[(j[0]+te[0])/2,(j[1]+te[1])/2],H=[(B[0]+re[0])/2,(B[1]+re[1])/2]}else if(A.touch0)q=A.touch0[0],H=A.touch0[1];else return;A.zoom("touch",t(y(L,q,H),A.extent,a))}}function I(w,...E){if(this.__zooming){var A=N(this,E).event(w),R=w.changedTouches,z=R.length,F,L;for(_r(w),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),F=0;F<z;++F)L=R[F],A.touch0&&A.touch0[2]===L.identifier?delete A.touch0:A.touch1&&A.touch1[2]===L.identifier&&delete A.touch1;if(A.touch1&&!A.touch0&&(A.touch0=A.touch1,delete A.touch1),A.touch0)A.touch0[1]=this.__zoom.invert(A.touch0[0]);else if(A.end(),A.taps===2&&(L=Yt(L,this),Math.hypot(h[0]-L[0],h[1]-L[1])<_)){var q=Lt(this).on("dblclick.zoom");q&&q.apply(this,arguments)}}}return p.wheelDelta=function(w){return arguments.length?(s=typeof w=="function"?w:Wi(+w),p):s},p.filter=function(w){return arguments.length?(n=typeof w=="function"?w:Wi(!!w),p):n},p.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:Wi(!!w),p):i},p.extent=function(w){return arguments.length?(e=typeof w=="function"?w:Wi([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),p):e},p.scaleExtent=function(w){return arguments.length?(o[0]=+w[0],o[1]=+w[1],p):[o[0],o[1]]},p.translateExtent=function(w){return arguments.length?(a[0][0]=+w[0][0],a[1][0]=+w[1][0],a[0][1]=+w[0][1],a[1][1]=+w[1][1],p):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},p.constrain=function(w){return arguments.length?(t=w,p):t},p.duration=function(w){return arguments.length?(r=+w,p):r},p.interpolate=function(w){return arguments.length?(l=w,p):l},p.on=function(){var w=c.on.apply(c,arguments);return w===c?p:w},p.clickDistance=function(w){return arguments.length?(g=(w=+w)*w,p):Math.sqrt(g)},p.tapDistance=function(w){return arguments.length?(_=+w,p):_},p}const Ds={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:n=>`Node type "${n}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:n=>`The old edge with id=${n} does not exist.`,error009:n=>`Marker type "${n}" doesn't exist.`,error008:(n,{id:e,sourceHandle:t,targetHandle:s})=>`Couldn't create edge for ${n} handle id: "${n==="source"?t:s}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:n=>`Edge type "${n}" not found. Using fallback type "default".`,error012:n=>`Node with id "${n}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(n="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${n}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},uo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var Gn;(function(n){n.Strict="strict",n.Loose="loose"})(Gn||(Gn={}));var an;(function(n){n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal"})(an||(an={}));var ho;(function(n){n.Partial="partial",n.Full="full"})(ho||(ho={}));const Rr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Ss;(function(n){n.Bezier="default",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n.SimpleBezier="simplebezier"})(Ss||(Ss={}));var fo;(function(n){n.Arrow="arrow",n.ArrowClosed="arrowclosed"})(fo||(fo={}));var fe;(function(n){n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom"})(fe||(fe={}));const Il={[fe.Left]:fe.Right,[fe.Right]:fe.Left,[fe.Top]:fe.Bottom,[fe.Bottom]:fe.Top};function Gg(n,e){if(!n&&!e)return!0;if(!n||!e||n.size!==e.size)return!1;if(!n.size&&!e.size)return!0;for(const t of n.keys())if(!e.has(t))return!1;return!0}function Pl(n,e,t){if(!t)return;const s=[];n.forEach((i,o)=>{e!=null&&e.has(o)||s.push(i)}),s.length&&t(s)}function Rl(n){return n===null?null:n?"valid":"invalid"}const Zg=n=>"id"in n&&"source"in n&&"target"in n,Xu=n=>"id"in n&&"internals"in n&&!("source"in n)&&!("target"in n),gi=(n,e=[0,0])=>{const{width:t,height:s}=Fn(n),i=n.origin??e,o=t*i[0],a=s*i[1];return{x:n.position.x-o,y:n.position.y-a}},_i=(n,e={})=>{if(n.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return n.forEach(s=>{if(e.filter===void 0||e.filter(s)){const i=Fr(s);t=oa(t,i)}}),ra(t)},Yu=(n,e,[t,s,i]=[0,0,1],o=!1,a=!1)=>{const r={...qo(e,[t,s,i]),width:e.width/i,height:e.height/i},l=[];for(const c of n.values()){const{measured:u,selectable:h=!0,hidden:f=!1}=c;if(a&&!h||f)continue;const d=u.width??c.width??c.initialWidth??null,m=u.height??c.height??c.initialHeight??null,g=aa(r,Lo(c)),_=(d??0)*(m??0),p=o&&g>0;(!c.internals.handleBounds||p||g>=_||c.dragging)&&l.push(c)}return l},xr=(n,e)=>{const t=new Set;return n.forEach(s=>{t.add(s.id)}),e.filter(s=>t.has(s.source)||t.has(s.target))};function Kg(n,e){const t=new Map,s=e!=null&&e.nodes?new Set(e.nodes.map(i=>i.id)):null;return n.forEach(i=>{i.measured.width&&i.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!i.hidden)&&(!s||s.has(i.id))&&t.set(i.id,i)}),t}async function Qg({nodes:n,width:e,height:t,panZoom:s,minZoom:i,maxZoom:o},a){if(n.size===0)return Promise.resolve(!0);const r=Kg(n,a),l=_i(r),c=Zu(l,e,t,(a==null?void 0:a.minZoom)??i,(a==null?void 0:a.maxZoom)??o,(a==null?void 0:a.padding)??.1);return await s.setViewport(c,{duration:a==null?void 0:a.duration}),Promise.resolve(!0)}function Jg({nodeId:n,nextPosition:e,nodeLookup:t,nodeOrigin:s=[0,0],nodeExtent:i,onError:o}){const a=t.get(n),r=a.parentId?t.get(a.parentId):void 0,{x:l,y:c}=r?r.internals.positionAbsolute:{x:0,y:0},u=a.origin??s;let h=i;if(a.extent==="parent"&&!a.expandParent)if(!r)o==null||o("005",Ds.error005());else{const d=r.measured.width,m=r.measured.height;d&&m&&(h=[[l,c],[l+d,c+m]])}else r&&Ps(a.extent)&&(h=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const f=Ps(h)?Zn(e,h,a.measured):e;return(a.measured.width===void 0||a.measured.height===void 0)&&(o==null||o("015",Ds.error015())),{position:{x:f.x-l+(a.measured.width??0)*u[0],y:f.y-c+(a.measured.height??0)*u[1]},positionAbsolute:f}}async function $g({nodesToRemove:n=[],edgesToRemove:e=[],nodes:t,edges:s,onBeforeDelete:i}){const o=new Set(n.map(f=>f.id)),a=[];for(const f of t){if(f.deletable===!1)continue;const d=o.has(f.id),m=!d&&f.parentId&&a.find(g=>g.id===f.parentId);(d||m)&&a.push(f)}const r=new Set(e.map(f=>f.id)),l=s.filter(f=>f.deletable!==!1),u=xr(a,l);for(const f of l)r.has(f.id)&&!u.find(m=>m.id===f.id)&&u.push(f);if(!i)return{edges:u,nodes:a};const h=await i({nodes:a,edges:u});return typeof h=="boolean"?h?{edges:u,nodes:a}:{edges:[],nodes:[]}:h}const Is=(n,e=0,t=1)=>Math.min(Math.max(n,e),t),Zn=(n={x:0,y:0},e,t)=>({x:Is(n.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:Is(n.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function ju(n,e,t){const{width:s,height:i}=Fn(t),{x:o,y:a}=t.internals.positionAbsolute;return Zn(n,[[o,a],[o+s,a+i]],e)}const xl=(n,e,t)=>n<e?Is(Math.abs(n-e),1,e)/e:n>t?-Is(Math.abs(n-t),1,e)/e:0,Uu=(n,e,t=15,s=40)=>{const i=xl(n.x,s,e.width-s)*t,o=xl(n.y,s,e.height-s)*t;return[i,o]},oa=(n,e)=>({x:Math.min(n.x,e.x),y:Math.min(n.y,e.y),x2:Math.max(n.x2,e.x2),y2:Math.max(n.y2,e.y2)}),Vr=({x:n,y:e,width:t,height:s})=>({x:n,y:e,x2:n+t,y2:e+s}),ra=({x:n,y:e,x2:t,y2:s})=>({x:n,y:e,width:t-n,height:s-e}),Lo=(n,e=[0,0])=>{var i,o;const{x:t,y:s}=Xu(n)?n.internals.positionAbsolute:gi(n,e);return{x:t,y:s,width:((i=n.measured)==null?void 0:i.width)??n.width??n.initialWidth??0,height:((o=n.measured)==null?void 0:o.height)??n.height??n.initialHeight??0}},Fr=(n,e=[0,0])=>{var i,o;const{x:t,y:s}=Xu(n)?n.internals.positionAbsolute:gi(n,e);return{x:t,y:s,x2:t+(((i=n.measured)==null?void 0:i.width)??n.width??n.initialWidth??0),y2:s+(((o=n.measured)==null?void 0:o.height)??n.height??n.initialHeight??0)}},Gu=(n,e)=>ra(oa(Vr(n),Vr(e))),aa=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.width,e.x+e.width)-Math.max(n.x,e.x)),s=Math.max(0,Math.min(n.y+n.height,e.y+e.height)-Math.max(n.y,e.y));return Math.ceil(t*s)},Yn=n=>!isNaN(n)&&isFinite(n),e_=(n,e)=>{},la=(n,e=[1,1])=>({x:e[0]*Math.round(n.x/e[0]),y:e[1]*Math.round(n.y/e[1])}),qo=({x:n,y:e},[t,s,i],o=!1,a=[1,1])=>{const r={x:(n-t)/i,y:(e-s)/i};return o?la(r,a):r},zr=({x:n,y:e},[t,s,i])=>({x:n*i+t,y:e*i+s});function hs(n,e){if(typeof n=="number")return Math.floor((e-e/(1+n))*.5);if(typeof n=="string"&&n.endsWith("px")){const t=parseFloat(n);if(!Number.isNaN(t))return Math.floor(t)}if(typeof n=="string"&&n.endsWith("%")){const t=parseFloat(n);if(!Number.isNaN(t))return Math.floor(e*t*.01)}return console.error(`[React Flow] The padding value "${n}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function t_(n,e,t){if(typeof n=="string"||typeof n=="number"){const s=hs(n,t),i=hs(n,e);return{top:s,right:i,bottom:s,left:i,x:i*2,y:s*2}}if(typeof n=="object"){const s=hs(n.top??n.y??0,t),i=hs(n.bottom??n.y??0,t),o=hs(n.left??n.x??0,e),a=hs(n.right??n.x??0,e);return{top:s,right:a,bottom:i,left:o,x:o+a,y:s+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function n_(n,e,t,s,i,o){const{x:a,y:r}=zr(n,[e,t,s]),{x:l,y:c}=zr({x:n.x+n.width,y:n.y+n.height},[e,t,s]),u=i-l,h=o-c;return{left:Math.floor(a),top:Math.floor(r),right:Math.floor(u),bottom:Math.floor(h)}}const Zu=(n,e,t,s,i,o)=>{const a=t_(o,e,t),r=(e-a.x)/n.width,l=(t-a.y)/n.height,c=Math.min(r,l),u=Is(c,s,i),h=n.x+n.width/2,f=n.y+n.height/2,d=e/2-h*u,m=t/2-f*u,g=n_(n,d,m,u,e,t),_={left:Math.min(g.left-a.left,0),top:Math.min(g.top-a.top,0),right:Math.min(g.right-a.right,0),bottom:Math.min(g.bottom-a.bottom,0)};return{x:d-_.left+_.right,y:m-_.top+_.bottom,zoom:u}},mo=()=>{var n;return typeof navigator<"u"&&((n=navigator==null?void 0:navigator.userAgent)==null?void 0:n.indexOf("Mac"))>=0};function Ps(n){return n!==void 0&&n!=="parent"}function Fn(n){var e,t;return{width:((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth??0,height:((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight??0}}function po(n){var e,t;return(((e=n.measured)==null?void 0:e.width)??n.width??n.initialWidth)!==void 0&&(((t=n.measured)==null?void 0:t.height)??n.height??n.initialHeight)!==void 0}function s_(){let n,e;return{promise:new Promise((s,i)=>{n=s,e=i}),resolve:n,reject:e}}function yr(n,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:s,containerBounds:i}){const{x:o,y:a}=bn(n),r=qo({x:o-((i==null?void 0:i.left)??0),y:a-((i==null?void 0:i.top)??0)},s),{x:l,y:c}=t?la(r,e):r;return{xSnapped:l,ySnapped:c,...r}}const Ku=n=>({width:n.offsetWidth,height:n.offsetHeight}),i_=n=>{var e;return((e=n==null?void 0:n.getRootNode)==null?void 0:e.call(n))||(window==null?void 0:window.document)},o_=["INPUT","SELECT","TEXTAREA"];function r_(n){var s,i;const e=((i=(s=n.composedPath)==null?void 0:s.call(n))==null?void 0:i[0])||n.target;return(e==null?void 0:e.nodeType)!==1?!1:o_.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const Qu=n=>"clientX"in n,bn=(n,e)=>{var o,a;const t=Qu(n),s=t?n.clientX:(o=n.touches)==null?void 0:o[0].clientX,i=t?n.clientY:(a=n.touches)==null?void 0:a[0].clientY;return{x:s-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},Vl=(n,e,t,s,i)=>{const o=e.querySelectorAll(`.${n}`);return!o||!o.length?null:Array.from(o).map(a=>{const r=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:n,nodeId:i,position:a.getAttribute("data-handlepos"),x:(r.left-t.left)/s,y:(r.top-t.top)/s,...Ku(a)}})};function a_({sourceX:n,sourceY:e,targetX:t,targetY:s,sourceControlX:i,sourceControlY:o,targetControlX:a,targetControlY:r}){const l=n*.125+i*.375+a*.375+t*.125,c=e*.125+o*.375+r*.375+s*.125,u=Math.abs(l-n),h=Math.abs(c-e);return[l,c,u,h]}function Li(n,e){return n>=0?.5*n:e*25*Math.sqrt(-n)}function Fl({pos:n,x1:e,y1:t,x2:s,y2:i,c:o}){switch(n){case fe.Left:return[e-Li(e-s,o),t];case fe.Right:return[e+Li(s-e,o),t];case fe.Top:return[e,t-Li(t-i,o)];case fe.Bottom:return[e,t+Li(i-t,o)]}}function Ju({sourceX:n,sourceY:e,sourcePosition:t=fe.Bottom,targetX:s,targetY:i,targetPosition:o=fe.Top,curvature:a=.25}){const[r,l]=Fl({pos:t,x1:n,y1:e,x2:s,y2:i,c:a}),[c,u]=Fl({pos:o,x1:s,y1:i,x2:n,y2:e,c:a}),[h,f,d,m]=a_({sourceX:n,sourceY:e,targetX:s,targetY:i,sourceControlX:r,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${n},${e} C${r},${l} ${c},${u} ${s},${i}`,h,f,d,m]}function $u({sourceX:n,sourceY:e,targetX:t,targetY:s}){const i=Math.abs(t-n)/2,o=t<n?t+i:t-i,a=Math.abs(s-e)/2,r=s<e?s+a:s-a;return[o,r,i,a]}function l_({sourceNode:n,targetNode:e,selected:t=!1,zIndex:s=0,elevateOnSelect:i=!1}){if(!i)return s;const o=t||e.selected||n.selected,a=Math.max(n.internals.z||0,e.internals.z||0,1e3);return s+(o?a:0)}function c_({sourceNode:n,targetNode:e,width:t,height:s,transform:i}){const o=oa(Fr(n),Fr(e));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const a={x:-i[0]/i[2],y:-i[1]/i[2],width:t/i[2],height:s/i[2]};return aa(a,ra(o))>0}const u_=({source:n,sourceHandle:e,target:t,targetHandle:s})=>`xy-edge__${n}${e||""}-${t}${s||""}`,h_=(n,e)=>e.some(t=>t.source===n.source&&t.target===n.target&&(t.sourceHandle===n.sourceHandle||!t.sourceHandle&&!n.sourceHandle)&&(t.targetHandle===n.targetHandle||!t.targetHandle&&!n.targetHandle)),f_=(n,e)=>{if(!n.source||!n.target)return e;let t;return Zg(n)?t={...n}:t={...n,id:u_(n)},h_(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function eh({sourceX:n,sourceY:e,targetX:t,targetY:s}){const[i,o,a,r]=$u({sourceX:n,sourceY:e,targetX:t,targetY:s});return[`M ${n},${e}L ${t},${s}`,i,o,a,r]}const zl={[fe.Left]:{x:-1,y:0},[fe.Right]:{x:1,y:0},[fe.Top]:{x:0,y:-1},[fe.Bottom]:{x:0,y:1}},d_=({source:n,sourcePosition:e=fe.Bottom,target:t})=>e===fe.Left||e===fe.Right?n.x<t.x?{x:1,y:0}:{x:-1,y:0}:n.y<t.y?{x:0,y:1}:{x:0,y:-1},Wl=(n,e)=>Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));function m_({source:n,sourcePosition:e=fe.Bottom,target:t,targetPosition:s=fe.Top,center:i,offset:o}){const a=zl[e],r=zl[s],l={x:n.x+a.x*o,y:n.y+a.y*o},c={x:t.x+r.x*o,y:t.y+r.y*o},u=d_({source:l,sourcePosition:e,target:c}),h=u.x!==0?"x":"y",f=u[h];let d=[],m,g;const _={x:0,y:0},p={x:0,y:0},[v,y,k,b]=$u({sourceX:n.x,sourceY:n.y,targetX:t.x,targetY:t.y});if(a[h]*r[h]===-1){m=i.x??v,g=i.y??y;const T=[{x:m,y:l.y},{x:m,y:c.y}],S=[{x:l.x,y:g},{x:c.x,y:g}];a[h]===f?d=h==="x"?T:S:d=h==="x"?S:T}else{const T=[{x:l.x,y:c.y}],S=[{x:c.x,y:l.y}];if(h==="x"?d=a.x===f?S:T:d=a.y===f?T:S,e===s){const I=Math.abs(n[h]-t[h]);if(I<=o){const w=Math.min(o-1,o-I);a[h]===f?_[h]=(l[h]>n[h]?-1:1)*w:p[h]=(c[h]>t[h]?-1:1)*w}}if(e!==s){const I=h==="x"?"y":"x",w=a[h]===r[I],E=l[I]>c[I],A=l[I]<c[I];(a[h]===1&&(!w&&E||w&&A)||a[h]!==1&&(!w&&A||w&&E))&&(d=h==="x"?T:S)}const M={x:l.x+_.x,y:l.y+_.y},O={x:c.x+p.x,y:c.y+p.y},P=Math.max(Math.abs(M.x-d[0].x),Math.abs(O.x-d[0].x)),D=Math.max(Math.abs(M.y-d[0].y),Math.abs(O.y-d[0].y));P>=D?(m=(M.x+O.x)/2,g=d[0].y):(m=d[0].x,g=(M.y+O.y)/2)}return[[n,{x:l.x+_.x,y:l.y+_.y},...d,{x:c.x+p.x,y:c.y+p.y},t],m,g,k,b]}function p_(n,e,t,s){const i=Math.min(Wl(n,e)/2,Wl(e,t)/2,s),{x:o,y:a}=e;if(n.x===o&&o===t.x||n.y===a&&a===t.y)return`L${o} ${a}`;if(n.y===a){const c=n.x<t.x?-1:1,u=n.y<t.y?1:-1;return`L ${o+i*c},${a}Q ${o},${a} ${o},${a+i*u}`}const r=n.x<t.x?1:-1,l=n.y<t.y?-1:1;return`L ${o},${a+i*l}Q ${o},${a} ${o+i*r},${a}`}function go({sourceX:n,sourceY:e,sourcePosition:t=fe.Bottom,targetX:s,targetY:i,targetPosition:o=fe.Top,borderRadius:a=5,centerX:r,centerY:l,offset:c=20}){const[u,h,f,d,m]=m_({source:{x:n,y:e},sourcePosition:t,target:{x:s,y:i},targetPosition:o,center:{x:r,y:l},offset:c});return[u.reduce((_,p,v)=>{let y="";return v>0&&v<u.length-1?y=p_(u[v-1],p,u[v+1],a):y=`${v===0?"M":"L"}${p.x} ${p.y}`,_+=y,_},""),h,f,d,m]}function Ll(n){var e;return n&&!!(n.internals.handleBounds||(e=n.handles)!=null&&e.length)&&!!(n.measured.width||n.width||n.initialWidth)}function g_(n){var h;const{sourceNode:e,targetNode:t}=n;if(!Ll(e)||!Ll(t))return null;const s=e.internals.handleBounds||ql(e.handles),i=t.internals.handleBounds||ql(t.handles),o=Bl((s==null?void 0:s.source)??[],n.sourceHandle),a=Bl(n.connectionMode===Gn.Strict?(i==null?void 0:i.target)??[]:((i==null?void 0:i.target)??[]).concat((i==null?void 0:i.source)??[]),n.targetHandle);if(!o||!a)return(h=n.onError)==null||h.call(n,"008",Ds.error008(o?"target":"source",{id:n.id,sourceHandle:n.sourceHandle,targetHandle:n.targetHandle})),null;const r=(o==null?void 0:o.position)||fe.Bottom,l=(a==null?void 0:a.position)||fe.Top,c=ai(e,o,r),u=ai(t,a,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:r,targetPosition:l}}function ql(n){if(!n)return null;const e=[],t=[];for(const s of n)s.width=s.width??1,s.height=s.height??1,s.type==="source"?e.push(s):s.type==="target"&&t.push(s);return{source:e,target:t}}function ai(n,e,t=fe.Left,s=!1){const i=((e==null?void 0:e.x)??0)+n.internals.positionAbsolute.x,o=((e==null?void 0:e.y)??0)+n.internals.positionAbsolute.y,{width:a,height:r}=e??Fn(n);if(s)return{x:i+a/2,y:o+r/2};switch((e==null?void 0:e.position)??t){case fe.Top:return{x:i+a/2,y:o};case fe.Right:return{x:i+a,y:o+r/2};case fe.Bottom:return{x:i+a/2,y:o+r};case fe.Left:return{x:i,y:o+r/2}}}function Bl(n,e){return n&&(e?n.find(t=>t.id===e):n[0])||null}function Wr(n,e){return n?typeof n=="string"?n:`${e?`${e}__`:""}${Object.keys(n).sort().map(s=>`${s}=${n[s]}`).join("&")}`:""}function __(n,{id:e,defaultColor:t,defaultMarkerStart:s,defaultMarkerEnd:i}){const o=new Set;return n.reduce((a,r)=>([r.markerStart||s,r.markerEnd||i].forEach(l=>{if(l&&typeof l=="object"){const c=Wr(l,e);o.has(c)||(a.push({id:c,color:l.color||t,...l}),o.add(c))}}),a),[]).sort((a,r)=>a.id.localeCompare(r.id))}const ca={nodeOrigin:[0,0],nodeExtent:uo,elevateNodesOnSelect:!0,defaults:{}},y_={...ca,checkEquality:!0};function ua(n,e){const t={...n};for(const s in e)e[s]!==void 0&&(t[s]=e[s]);return t}function b_(n,e,t){const s=ua(ca,t);for(const i of n.values())if(i.parentId)ha(i,n,e,s);else{const o=gi(i,s.nodeOrigin),a=Ps(i.extent)?i.extent:s.nodeExtent,r=Zn(o,a,Fn(i));i.internals.positionAbsolute=r}}function th(n,e,t,s){var l,c;const i=ua(y_,s);let o=n.length>0;const a=new Map(e),r=i!=null&&i.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const u of n){let h=a.get(u.id);if(i.checkEquality&&u===(h==null?void 0:h.internals.userNode))e.set(u.id,h);else{const f=gi(u,i.nodeOrigin),d=Ps(u.extent)?u.extent:i.nodeExtent,m=Zn(f,d,Fn(u));h={...i.defaults,...u,measured:{width:(l=u.measured)==null?void 0:l.width,height:(c=u.measured)==null?void 0:c.height},internals:{positionAbsolute:m,handleBounds:u.measured?h==null?void 0:h.internals.handleBounds:void 0,z:nh(u,r),userNode:u}},e.set(u.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(o=!1),u.parentId&&ha(h,e,t,s)}return o}function w_(n,e){if(!n.parentId)return;const t=e.get(n.parentId);t?t.set(n.id,n):e.set(n.parentId,new Map([[n.id,n]]))}function ha(n,e,t,s){const{elevateNodesOnSelect:i,nodeOrigin:o,nodeExtent:a}=ua(ca,s),r=n.parentId,l=e.get(r);if(!l){console.warn(`Parent node ${r} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}w_(n,t);const c=i?1e3:0,{x:u,y:h,z:f}=v_(n,l,o,a,c),{positionAbsolute:d}=n.internals,m=u!==d.x||h!==d.y;(m||f!==n.internals.z)&&e.set(n.id,{...n,internals:{...n.internals,positionAbsolute:m?{x:u,y:h}:d,z:f}})}function nh(n,e){return(Yn(n.zIndex)?n.zIndex:0)+(n.selected?e:0)}function v_(n,e,t,s,i){const{x:o,y:a}=e.internals.positionAbsolute,r=Fn(n),l=gi(n,t),c=Ps(n.extent)?Zn(l,n.extent,r):l;let u=Zn({x:o+c.x,y:a+c.y},s,r);n.extent==="parent"&&(u=ju(u,r,e));const h=nh(n,i),f=e.internals.z??0;return{x:u.x,y:u.y,z:f>h?f:h}}function k_(n,e,t,s=[0,0]){var a;const i=[],o=new Map;for(const r of n){const l=e.get(r.parentId);if(!l)continue;const c=((a=o.get(r.parentId))==null?void 0:a.expandedRect)??Lo(l),u=Gu(c,r.rect);o.set(r.parentId,{expandedRect:u,parent:l})}return o.size>0&&o.forEach(({expandedRect:r,parent:l},c)=>{var y;const u=l.internals.positionAbsolute,h=Fn(l),f=l.origin??s,d=r.x<u.x?Math.round(Math.abs(u.x-r.x)):0,m=r.y<u.y?Math.round(Math.abs(u.y-r.y)):0,g=Math.max(h.width,Math.round(r.width)),_=Math.max(h.height,Math.round(r.height)),p=(g-h.width)*f[0],v=(_-h.height)*f[1];(d>0||m>0||p||v)&&(i.push({id:c,type:"position",position:{x:l.position.x-d+p,y:l.position.y-m+v}}),(y=t.get(c))==null||y.forEach(k=>{n.some(b=>b.id===k.id)||i.push({id:k.id,type:"position",position:{x:k.position.x+d,y:k.position.y+m}})})),(h.width<r.width||h.height<r.height||d||m)&&i.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:g+(d?f[0]*d-p:0),height:_+(m?f[1]*m-v:0)}})}),i}function T_(n,e,t,s,i,o){const a=s==null?void 0:s.querySelector(".xyflow__viewport");let r=!1;if(!a)return{changes:[],updatedInternals:r};const l=[],c=window.getComputedStyle(a),{m22:u}=new window.DOMMatrixReadOnly(c.transform),h=[];for(const f of n.values()){const d=e.get(f.id);if(!d)continue;if(d.hidden){e.set(d.id,{...d,internals:{...d.internals,handleBounds:void 0}}),r=!0;continue}const m=Ku(f.nodeElement),g=d.measured.width!==m.width||d.measured.height!==m.height;if(!!(m.width&&m.height&&(g||!d.internals.handleBounds||f.force))){const p=f.nodeElement.getBoundingClientRect(),v=Ps(d.extent)?d.extent:o;let{positionAbsolute:y}=d.internals;d.parentId&&d.extent==="parent"?y=ju(y,m,e.get(d.parentId)):v&&(y=Zn(y,v,m));const k={...d,measured:m,internals:{...d.internals,positionAbsolute:y,handleBounds:{source:Vl("source",f.nodeElement,p,u,d.id),target:Vl("target",f.nodeElement,p,u,d.id)}}};e.set(d.id,k),d.parentId&&ha(k,e,t,{nodeOrigin:i}),r=!0,g&&(l.push({id:d.id,type:"dimensions",dimensions:m}),d.expandParent&&d.parentId&&h.push({id:d.id,parentId:d.parentId,rect:Lo(k,i)}))}}if(h.length>0){const f=k_(h,e,t,i);l.push(...f)}return{changes:l,updatedInternals:r}}async function S_({delta:n,panZoom:e,transform:t,translateExtent:s,width:i,height:o}){if(!e||!n.x&&!n.y)return Promise.resolve(!1);const a=await e.setViewportConstrained({x:t[0]+n.x,y:t[1]+n.y,zoom:t[2]},[[0,0],[i,o]],s),r=!!a&&(a.x!==t[0]||a.y!==t[1]||a.k!==t[2]);return Promise.resolve(r)}function Hl(n,e,t,s,i,o){let a=i;const r=s.get(a)||new Map;s.set(a,r.set(t,e)),a=`${i}-${n}`;const l=s.get(a)||new Map;if(s.set(a,l.set(t,e)),o){a=`${i}-${n}-${o}`;const c=s.get(a)||new Map;s.set(a,c.set(t,e))}}function sh(n,e,t){n.clear(),e.clear();for(const s of t){const{source:i,target:o,sourceHandle:a=null,targetHandle:r=null}=s,l={edgeId:s.id,source:i,target:o,sourceHandle:a,targetHandle:r},c=`${i}-${a}--${o}-${r}`,u=`${o}-${r}--${i}-${a}`;Hl("source",l,u,n,i,a),Hl("target",l,c,n,o,r),e.set(s.id,s)}}function ih(n,e){if(!n.parentId)return!1;const t=e.get(n.parentId);return t?t.selected?!0:ih(t,e):!1}function Xl(n,e,t){var i;let s=n;do{if((i=s==null?void 0:s.matches)!=null&&i.call(s,e))return!0;if(s===t)return!1;s=s==null?void 0:s.parentElement}while(s);return!1}function C_(n,e,t,s){const i=new Map;for(const[o,a]of n)if((a.selected||a.id===s)&&(!a.parentId||!ih(a,n))&&(a.draggable||e&&typeof a.draggable>"u")){const r=n.get(o);r&&i.set(o,{id:o,position:r.position||{x:0,y:0},distance:{x:t.x-r.internals.positionAbsolute.x,y:t.y-r.internals.positionAbsolute.y},extent:r.extent,parentId:r.parentId,origin:r.origin,expandParent:r.expandParent,internals:{positionAbsolute:r.internals.positionAbsolute||{x:0,y:0}},measured:{width:r.measured.width??0,height:r.measured.height??0}})}return i}function br({nodeId:n,dragItems:e,nodeLookup:t,dragging:s=!0}){var a,r,l;const i=[];for(const[c,u]of e){const h=(a=t.get(c))==null?void 0:a.internals.userNode;h&&i.push({...h,position:u.position,dragging:s})}if(!n)return[i[0],i];const o=(r=t.get(n))==null?void 0:r.internals.userNode;return[o?{...o,position:((l=e.get(n))==null?void 0:l.position)||o.position,dragging:s}:i[0],i]}function A_({onNodeMouseDown:n,getStoreItems:e,onDragStart:t,onDrag:s,onDragStop:i}){let o={x:null,y:null},a=0,r=new Map,l=!1,c={x:0,y:0},u=null,h=!1,f=null,d=!1;function m({noDragClassName:_,handleSelector:p,domNode:v,isSelectable:y,nodeId:k,nodeClickDistance:b=0}){f=Lt(v);function N({x:O,y:P},D){const{nodeLookup:I,nodeExtent:w,snapGrid:E,snapToGrid:A,nodeOrigin:R,onNodeDrag:z,onSelectionDrag:F,onError:L,updateNodePositions:q}=e();o={x:O,y:P};let H=!1,j={x:0,y:0,x2:0,y2:0};if(r.size>1&&w){const B=_i(r);j=Vr(B)}for(const[B,te]of r){if(!I.has(B))continue;let re={x:O-te.distance.x,y:P-te.distance.y};A&&(re=la(re,E));let J=[[w[0][0],w[0][1]],[w[1][0],w[1][1]]];if(r.size>1&&w&&!te.extent){const{positionAbsolute:ge}=te.internals,Te=ge.x-j.x+w[0][0],Ce=ge.x+te.measured.width-j.x2+w[1][0],ze=ge.y-j.y+w[0][1],Q=ge.y+te.measured.height-j.y2+w[1][1];J=[[Te,ze],[Ce,Q]]}const{position:ne,positionAbsolute:se}=Jg({nodeId:B,nextPosition:re,nodeLookup:I,nodeExtent:J,nodeOrigin:R,onError:L});H=H||te.position.x!==ne.x||te.position.y!==ne.y,te.position=ne,te.internals.positionAbsolute=se}if(H&&(q(r,!0),D&&(s||z||!k&&F))){const[B,te]=br({nodeId:k,dragItems:r,nodeLookup:I});s==null||s(D,r,B,te),z==null||z(D,B,te),k||F==null||F(D,te)}}async function T(){if(!u)return;const{transform:O,panBy:P,autoPanSpeed:D,autoPanOnNodeDrag:I}=e();if(!I){l=!1,cancelAnimationFrame(a);return}const[w,E]=Uu(c,u,D);(w!==0||E!==0)&&(o.x=(o.x??0)-w/O[2],o.y=(o.y??0)-E/O[2],await P({x:w,y:E})&&N(o,null)),a=requestAnimationFrame(T)}function S(O){var H;const{nodeLookup:P,multiSelectionActive:D,nodesDraggable:I,transform:w,snapGrid:E,snapToGrid:A,selectNodesOnDrag:R,onNodeDragStart:z,onSelectionDragStart:F,unselectNodesAndEdges:L}=e();h=!0,(!R||!y)&&!D&&k&&((H=P.get(k))!=null&&H.selected||L()),y&&R&&k&&(n==null||n(k));const q=yr(O.sourceEvent,{transform:w,snapGrid:E,snapToGrid:A,containerBounds:u});if(o=q,r=C_(P,I,q,k),r.size>0&&(t||z||!k&&F)){const[j,B]=br({nodeId:k,dragItems:r,nodeLookup:P});t==null||t(O.sourceEvent,r,j,B),z==null||z(O.sourceEvent,j,B),k||F==null||F(O.sourceEvent,B)}}const M=ip().clickDistance(b).on("start",O=>{const{domNode:P,nodeDragThreshold:D,transform:I,snapGrid:w,snapToGrid:E}=e();u=(P==null?void 0:P.getBoundingClientRect())||null,d=!1,D===0&&S(O),o=yr(O.sourceEvent,{transform:I,snapGrid:w,snapToGrid:E,containerBounds:u}),c=bn(O.sourceEvent,u)}).on("drag",O=>{const{autoPanOnNodeDrag:P,transform:D,snapGrid:I,snapToGrid:w,nodeDragThreshold:E,nodeLookup:A}=e(),R=yr(O.sourceEvent,{transform:D,snapGrid:I,snapToGrid:w,containerBounds:u});if((O.sourceEvent.type==="touchmove"&&O.sourceEvent.touches.length>1||k&&!A.has(k))&&(d=!0),!d){if(!l&&P&&h&&(l=!0,T()),!h){const z=R.xSnapped-(o.x??0),F=R.ySnapped-(o.y??0);Math.sqrt(z*z+F*F)>E&&S(O)}(o.x!==R.xSnapped||o.y!==R.ySnapped)&&r&&h&&(c=bn(O.sourceEvent,u),N(R,O.sourceEvent))}}).on("end",O=>{if(!(!h||d)&&(l=!1,h=!1,cancelAnimationFrame(a),r.size>0)){const{nodeLookup:P,updateNodePositions:D,onNodeDragStop:I,onSelectionDragStop:w}=e();if(D(r,!1),i||I||!k&&w){const[E,A]=br({nodeId:k,dragItems:r,nodeLookup:P,dragging:!1});i==null||i(O.sourceEvent,r,E,A),I==null||I(O.sourceEvent,E,A),k||w==null||w(O.sourceEvent,A)}}}).filter(O=>{const P=O.target;return!O.button&&(!_||!Xl(P,`.${_}`,v))&&(!p||Xl(P,p,v))});f.call(M)}function g(){f==null||f.on(".drag",null)}return{update:m,destroy:g}}function N_(n,e,t){const s=[],i={x:n.x-t,y:n.y-t,width:t*2,height:t*2};for(const o of e.values())aa(i,Lo(o))>0&&s.push(o);return s}const E_=250;function M_(n,e,t,s){var r,l;let i=[],o=1/0;const a=N_(n,t,e+E_);for(const c of a){const u=[...((r=c.internals.handleBounds)==null?void 0:r.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const h of u){if(s.nodeId===h.nodeId&&s.type===h.type&&s.id===h.id)continue;const{x:f,y:d}=ai(c,h,h.position,!0),m=Math.sqrt(Math.pow(f-n.x,2)+Math.pow(d-n.y,2));m>e||(m<o?(i=[{...h,x:f,y:d}],o=m):m===o&&i.push({...h,x:f,y:d}))}}if(!i.length)return null;if(i.length>1){const c=s.type==="source"?"target":"source";return i.find(u=>u.type===c)??i[0]}return i[0]}function oh(n,e,t,s,i,o=!1){var c,u,h;const a=s.get(n);if(!a)return null;const r=i==="strict"?(c=a.internals.handleBounds)==null?void 0:c[e]:[...((u=a.internals.handleBounds)==null?void 0:u.source)??[],...((h=a.internals.handleBounds)==null?void 0:h.target)??[]],l=(t?r==null?void 0:r.find(f=>f.id===t):r==null?void 0:r[0])??null;return l&&o?{...l,...ai(a,l,l.position,!0)}:l}function rh(n,e){return n||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function O_(n,e){let t=null;return e?t=!0:n&&!e&&(t=!1),t}const ah=()=>!0;function D_(n,{connectionMode:e,connectionRadius:t,handleId:s,nodeId:i,edgeUpdaterType:o,isTarget:a,domNode:r,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:h,panBy:f,cancelConnection:d,onConnectStart:m,onConnect:g,onConnectEnd:_,isValidConnection:p=ah,onReconnectEnd:v,updateConnection:y,getTransform:k,getFromHandle:b,autoPanSpeed:N}){const T=i_(n.target);let S=0,M;const{x:O,y:P}=bn(n),D=T==null?void 0:T.elementFromPoint(O,P),I=rh(o,D),w=r==null?void 0:r.getBoundingClientRect();if(!w||!I)return;const E=oh(i,I,s,l,e);if(!E)return;let A=bn(n,w),R=!1,z=null,F=!1,L=null;function q(){if(!u||!w)return;const[se,ge]=Uu(A,w,N);f({x:se,y:ge}),S=requestAnimationFrame(q)}const H={...E,nodeId:i,type:I,position:E.position},j=l.get(i),te={inProgress:!0,isValid:null,from:ai(j,H,fe.Left,!0),fromHandle:H,fromPosition:H.position,fromNode:j,to:A,toHandle:null,toPosition:Il[H.position],toNode:null};y(te);let re=te;m==null||m(n,{nodeId:i,handleId:s,handleType:I});function J(se){if(!b()||!H){ne(se);return}const ge=k();A=bn(se,w),M=M_(qo(A,ge,!1,[1,1]),t,l,H),R||(q(),R=!0);const Te=lh(se,{handle:M,connectionMode:e,fromNodeId:i,fromHandleId:s,fromType:a?"target":"source",isValidConnection:p,doc:T,lib:c,flowId:h,nodeLookup:l});L=Te.handleDomNode,z=Te.connection,F=O_(!!M,Te.isValid);const Ce={...re,isValid:F,to:M&&F?zr({x:M.x,y:M.y},ge):A,toHandle:Te.toHandle,toPosition:F&&Te.toHandle?Te.toHandle.position:Il[H.position],toNode:Te.toHandle?l.get(Te.toHandle.nodeId):null};F&&M&&re.toHandle&&Ce.toHandle&&re.toHandle.type===Ce.toHandle.type&&re.toHandle.nodeId===Ce.toHandle.nodeId&&re.toHandle.id===Ce.toHandle.id&&re.to.x===Ce.to.x&&re.to.y===Ce.to.y||(y(Ce),re=Ce)}function ne(se){(M||L)&&z&&F&&(g==null||g(z));const{inProgress:ge,...Te}=re,Ce={...Te,toPosition:re.toHandle?re.toPosition:null};_==null||_(se,Ce),o&&(v==null||v(se,Ce)),d(),cancelAnimationFrame(S),R=!1,F=!1,z=null,L=null,T.removeEventListener("mousemove",J),T.removeEventListener("mouseup",ne),T.removeEventListener("touchmove",J),T.removeEventListener("touchend",ne)}T.addEventListener("mousemove",J),T.addEventListener("mouseup",ne),T.addEventListener("touchmove",J),T.addEventListener("touchend",ne)}function lh(n,{handle:e,connectionMode:t,fromNodeId:s,fromHandleId:i,fromType:o,doc:a,lib:r,flowId:l,isValidConnection:c=ah,nodeLookup:u}){const h=o==="target",f=e?a.querySelector(`.${r}-flow__handle[data-id="${l}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:d,y:m}=bn(n),g=a.elementFromPoint(d,m),_=g!=null&&g.classList.contains(`${r}-flow__handle`)?g:f,p={handleDomNode:_,isValid:!1,connection:null,toHandle:null};if(_){const v=rh(void 0,_),y=_.getAttribute("data-nodeid"),k=_.getAttribute("data-handleid"),b=_.classList.contains("connectable"),N=_.classList.contains("connectableend");if(!y||!v)return p;const T={source:h?y:s,sourceHandle:h?k:i,target:h?s:y,targetHandle:h?i:k};p.connection=T;const M=b&&N&&(t===Gn.Strict?h&&v==="source"||!h&&v==="target":y!==s||k!==i);p.isValid=M&&c(T),p.toHandle=oh(y,v,k,u,t,!1)}return p}const I_={onPointerDown:D_,isValid:lh};function P_({domNode:n,panZoom:e,getTransform:t,getViewScale:s}){const i=Lt(n);function o({translateExtent:r,width:l,height:c,zoomStep:u=10,pannable:h=!0,zoomable:f=!0,inversePan:d=!1}){const m=y=>{const k=t();if(y.sourceEvent.type!=="wheel"||!e)return;const b=-y.sourceEvent.deltaY*(y.sourceEvent.deltaMode===1?.05:y.sourceEvent.deltaMode?1:.002)*u,N=k[2]*Math.pow(2,b);e.scaleTo(N)};let g=[0,0];const _=y=>{(y.sourceEvent.type==="mousedown"||y.sourceEvent.type==="touchstart")&&(g=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY])},p=y=>{const k=t();if(y.sourceEvent.type!=="mousemove"&&y.sourceEvent.type!=="touchmove"||!e)return;const b=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY],N=[b[0]-g[0],b[1]-g[1]];g=b;const T=s()*Math.max(k[2],Math.log(k[2]))*(d?-1:1),S={x:k[0]-N[0]*T,y:k[1]-N[1]*T},M=[[0,0],[l,c]];e.setViewportConstrained({x:S.x,y:S.y,zoom:k[2]},M,r)},v=Hu().on("start",_).on("zoom",h?p:null).on("zoom.wheel",f?m:null);i.call(v,{})}function a(){i.on("zoom",null)}return{update:o,destroy:a,pointer:Yt}}const R_=(n,e)=>n.x!==e.x||n.y!==e.y||n.zoom!==e.k,Bo=n=>({x:n.x,y:n.y,zoom:n.k}),wr=({x:n,y:e,zoom:t})=>Wo.translate(n,e).scale(t),ps=(n,e)=>n.target.closest(`.${e}`),ch=(n,e)=>e===2&&Array.isArray(n)&&n.includes(2),vr=(n,e=0,t=()=>{})=>{const s=typeof e=="number"&&e>0;return s||t(),s?n.transition().duration(e).on("end",t):n},uh=n=>{const e=n.ctrlKey&&mo()?10:1;return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*e};function x_({zoomPanValues:n,noWheelClassName:e,d3Selection:t,d3Zoom:s,panOnScrollMode:i,panOnScrollSpeed:o,zoomOnPinch:a,onPanZoomStart:r,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(ps(u,e))return!1;u.preventDefault(),u.stopImmediatePropagation();const h=t.property("__zoom").k||1;if(u.ctrlKey&&a){const _=Yt(u),p=uh(u),v=h*Math.pow(2,p);s.scaleTo(t,v,_,u);return}const f=u.deltaMode===1?20:1;let d=i===an.Vertical?0:u.deltaX*f,m=i===an.Horizontal?0:u.deltaY*f;!mo()&&u.shiftKey&&i!==an.Vertical&&(d=u.deltaY*f,m=0),s.translateBy(t,-(d/h)*o,-(m/h)*o,{internal:!0});const g=Bo(t.property("__zoom"));clearTimeout(n.panScrollTimeout),n.isPanScrolling||(n.isPanScrolling=!0,r==null||r(u,g)),n.isPanScrolling&&(l==null||l(u,g),n.panScrollTimeout=setTimeout(()=>{c==null||c(u,g),n.isPanScrolling=!1},150))}}function V_({noWheelClassName:n,preventScrolling:e,d3ZoomHandler:t}){return function(s,i){const o=s.type==="wheel",a=!e&&o&&!s.ctrlKey,r=ps(s,n);if(s.ctrlKey&&o&&r&&s.preventDefault(),a||r)return null;s.preventDefault(),t.call(this,s,i)}}function F_({zoomPanValues:n,onDraggingChange:e,onPanZoomStart:t}){return s=>{var o,a,r;if((o=s.sourceEvent)!=null&&o.internal)return;const i=Bo(s.transform);n.mouseButton=((a=s.sourceEvent)==null?void 0:a.button)||0,n.isZoomingOrPanning=!0,n.prevViewport=i,((r=s.sourceEvent)==null?void 0:r.type)==="mousedown"&&e(!0),t&&(t==null||t(s.sourceEvent,i))}}function z_({zoomPanValues:n,panOnDrag:e,onPaneContextMenu:t,onTransformChange:s,onPanZoom:i}){return o=>{var a,r;n.usedRightMouseButton=!!(t&&ch(e,n.mouseButton??0)),(a=o.sourceEvent)!=null&&a.sync||s([o.transform.x,o.transform.y,o.transform.k]),i&&!((r=o.sourceEvent)!=null&&r.internal)&&(i==null||i(o.sourceEvent,Bo(o.transform)))}}function W_({zoomPanValues:n,panOnDrag:e,panOnScroll:t,onDraggingChange:s,onPanZoomEnd:i,onPaneContextMenu:o}){return a=>{var r;if(!((r=a.sourceEvent)!=null&&r.internal)&&(n.isZoomingOrPanning=!1,o&&ch(e,n.mouseButton??0)&&!n.usedRightMouseButton&&a.sourceEvent&&o(a.sourceEvent),n.usedRightMouseButton=!1,s(!1),i&&R_(n.prevViewport,a.transform))){const l=Bo(a.transform);n.prevViewport=l,clearTimeout(n.timerId),n.timerId=setTimeout(()=>{i==null||i(a.sourceEvent,l)},t?150:0)}}}function L_({zoomActivationKeyPressed:n,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:s,panOnScroll:i,zoomOnDoubleClick:o,userSelectionActive:a,noWheelClassName:r,noPanClassName:l,lib:c}){return u=>{var m;const h=n||e,f=t&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(ps(u,`${c}-flow__node`)||ps(u,`${c}-flow__edge`)))return!0;if(!s&&!h&&!i&&!o&&!t||a||ps(u,r)&&u.type==="wheel"||ps(u,l)&&(u.type!=="wheel"||i&&u.type==="wheel"&&!n)||!t&&u.ctrlKey&&u.type==="wheel")return!1;if(!t&&u.type==="touchstart"&&((m=u.touches)==null?void 0:m.length)>1)return u.preventDefault(),!1;if(!h&&!i&&!f&&u.type==="wheel"||!s&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(s)&&!s.includes(u.button)&&u.type==="mousedown")return!1;const d=Array.isArray(s)&&s.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&d}}function q_({domNode:n,minZoom:e,maxZoom:t,paneClickDistance:s,translateExtent:i,viewport:o,onPanZoom:a,onPanZoomStart:r,onPanZoomEnd:l,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=n.getBoundingClientRect(),f=Hu().clickDistance(!Yn(s)||s<0?0:s).scaleExtent([e,t]).translateExtent(i),d=Lt(n).call(f);y({x:o.x,y:o.y,zoom:Is(o.zoom,e,t)},[[0,0],[h.width,h.height]],i);const m=d.on("wheel.zoom"),g=d.on("dblclick.zoom");f.wheelDelta(uh);function _(D,I){return d?new Promise(w=>{f==null||f.transform(vr(d,I==null?void 0:I.duration,()=>w(!0)),D)}):Promise.resolve(!1)}function p({noWheelClassName:D,noPanClassName:I,onPaneContextMenu:w,userSelectionActive:E,panOnScroll:A,panOnDrag:R,panOnScrollMode:z,panOnScrollSpeed:F,preventScrolling:L,zoomOnPinch:q,zoomOnScroll:H,zoomOnDoubleClick:j,zoomActivationKeyPressed:B,lib:te,onTransformChange:re}){E&&!u.isZoomingOrPanning&&v();const ne=A&&!B&&!E?x_({zoomPanValues:u,noWheelClassName:D,d3Selection:d,d3Zoom:f,panOnScrollMode:z,panOnScrollSpeed:F,zoomOnPinch:q,onPanZoomStart:r,onPanZoom:a,onPanZoomEnd:l}):V_({noWheelClassName:D,preventScrolling:L,d3ZoomHandler:m});if(d.on("wheel.zoom",ne,{passive:!1}),!E){const ge=F_({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:r});f.on("start",ge);const Te=z_({zoomPanValues:u,panOnDrag:R,onPaneContextMenu:!!w,onPanZoom:a,onTransformChange:re});f.on("zoom",Te);const Ce=W_({zoomPanValues:u,panOnDrag:R,panOnScroll:A,onPaneContextMenu:w,onPanZoomEnd:l,onDraggingChange:c});f.on("end",Ce)}const se=L_({zoomActivationKeyPressed:B,panOnDrag:R,zoomOnScroll:H,panOnScroll:A,zoomOnDoubleClick:j,zoomOnPinch:q,userSelectionActive:E,noPanClassName:I,noWheelClassName:D,lib:te});f.filter(se),j?d.on("dblclick.zoom",g):d.on("dblclick.zoom",null)}function v(){f.on("zoom",null)}async function y(D,I,w){const E=wr(D),A=f==null?void 0:f.constrain()(E,I,w);return A&&await _(A),new Promise(R=>R(A))}async function k(D,I){const w=wr(D);return await _(w,I),new Promise(E=>E(w))}function b(D){if(d){const I=wr(D),w=d.property("__zoom");(w.k!==D.zoom||w.x!==D.x||w.y!==D.y)&&(f==null||f.transform(d,I,null,{sync:!0}))}}function N(){const D=d?Bu(d.node()):{x:0,y:0,k:1};return{x:D.x,y:D.y,zoom:D.k}}function T(D,I){return d?new Promise(w=>{f==null||f.scaleTo(vr(d,I==null?void 0:I.duration,()=>w(!0)),D)}):Promise.resolve(!1)}function S(D,I){return d?new Promise(w=>{f==null||f.scaleBy(vr(d,I==null?void 0:I.duration,()=>w(!0)),D)}):Promise.resolve(!1)}function M(D){f==null||f.scaleExtent(D)}function O(D){f==null||f.translateExtent(D)}function P(D){const I=!Yn(D)||D<0?0:D;f==null||f.clickDistance(I)}return{update:p,destroy:v,setViewport:k,setViewportConstrained:y,getViewport:N,scaleTo:T,scaleBy:S,setScaleExtent:M,setTranslateExtent:O,syncViewport:b,setClickDistance:P}}var Yl;(function(n){n.Line="line",n.Handle="handle"})(Yl||(Yl={}));function B_(n){let e,t,s,i,o,a;const r=n[45].default,l=Ct(r,n,n[44],null);return{c(){e=X("div"),l&&l.c(),C(e,"data-handleid",n[6]),C(e,"data-nodeid",n[14]),C(e,"data-handlepos",n[2]),C(e,"data-id",t=n[13]+"-"+n[14]+"-"+(n[0]||null)+"-"+n[1]),C(e,"class",s=Le(["svelte-flow__handle",`svelte-flow__handle-${n[2]}`,"nodrag","nopan",n[2],n[4]])),C(e,"style",n[3]),C(e,"role","button"),C(e,"tabindex","-1"),ke(e,"valid",n[7]),ke(e,"connectingto",n[5]),ke(e,"connectingfrom",n[9]),ke(e,"source",!n[11]),ke(e,"target",n[11]),ke(e,"connectablestart",n[12]),ke(e,"connectableend",n[12]),ke(e,"connectable",n[12]),ke(e,"connectionindicator",n[12]&&(!n[10]||n[8]))},m(c,u){Z(c,e,u),l&&l.m(e,null),i=!0,o||(a=[de(e,"mousedown",n[32]),de(e,"touchstart",n[32])],o=!0)},p(c,u){l&&l.p&&(!i||u[1]&8192)&&Nt(l,r,c,c[44],i?At(r,c[44],u,null):Et(c[44]),null),(!i||u[0]&64)&&C(e,"data-handleid",c[6]),(!i||u[0]&4)&&C(e,"data-handlepos",c[2]),(!i||u[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&C(e,"data-id",t),(!i||u[0]&20&&s!==(s=Le(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&C(e,"class",s),(!i||u[0]&8)&&C(e,"style",c[3]),(!i||u[0]&148)&&ke(e,"valid",c[7]),(!i||u[0]&52)&&ke(e,"connectingto",c[5]),(!i||u[0]&532)&&ke(e,"connectingfrom",c[9]),(!i||u[0]&2068)&&ke(e,"source",!c[11]),(!i||u[0]&2068)&&ke(e,"target",c[11]),(!i||u[0]&4116)&&ke(e,"connectablestart",c[12]),(!i||u[0]&4116)&&ke(e,"connectableend",c[12]),(!i||u[0]&4116)&&ke(e,"connectable",c[12]),(!i||u[0]&5396)&&ke(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){i||(Y(l,c),i=!0)},o(c){G(l,c),i=!1},d(c){c&&U(e),l&&l.d(c),o=!1,tt(a)}}}function H_(n,e,t){let s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y,k,b,N,T,S,M,O,P,{$$slots:D={},$$scope:I}=e,{id:w=void 0}=e,{type:E="source"}=e,{position:A=fe.Top}=e,{style:R=void 0}=e,{isValidConnection:z=void 0}=e,{onconnect:F=void 0}=e,{ondisconnect:L=void 0}=e,{isConnectable:q=void 0}=e,{class:H=void 0}=e;const j=no("svelteflow__node_id"),B=no("svelteflow__node_connectable");ee(n,B,W=>t(43,P=W));const te=ct(),{connectionMode:re,domNode:J,nodeLookup:ne,connectionRadius:se,viewport:ge,isValidConnection:Te,lib:Ce,addEdge:ze,onedgecreate:Q,panBy:$,cancelConnection:le,updateConnection:Oe,autoPanOnConnect:_e,edges:Ae,connectionLookup:Ee,onconnect:Ke,onconnectstart:ie,onconnectend:kt,flowId:Ft,connection:nn}=te;ee(n,re,W=>t(40,f=W)),ee(n,J,W=>t(55,M=W)),ee(n,ne,W=>t(54,S=W)),ee(n,se,W=>t(56,O=W)),ee(n,ge,W=>t(46,g=W)),ee(n,Te,W=>t(51,k=W)),ee(n,Ce,W=>t(53,T=W)),ee(n,Q,W=>t(50,y=W)),ee(n,_e,W=>t(52,N=W)),ee(n,Ae,W=>t(42,m=W)),ee(n,Ee,W=>t(41,d=W)),ee(n,Ke,W=>t(49,v=W)),ee(n,ie,W=>t(48,p=W)),ee(n,kt,W=>t(47,_=W)),ee(n,Ft,W=>t(13,b=W)),ee(n,nn,W=>t(39,h=W));function pn(W){const zt=Qu(W);(zt&&W.button===0||!zt)&&I_.onPointerDown(W,{handleId:o,nodeId:j,isTarget:s,connectionRadius:O,domNode:M,nodeLookup:S,connectionMode:f,lib:T,autoPanOnConnect:N,flowId:b,isValidConnection:z??k,updateConnection:Oe,cancelConnection:le,panBy:$,onConnect:st=>{const et=y?y(st):st;et&&(ze(et),v==null||v(st))},onConnectStart:(st,et)=>{p==null||p(st,{nodeId:et.nodeId,handleId:et.handleId,handleType:et.handleType})},onConnectEnd:(st,et)=>{_==null||_(st,et)},getTransform:()=>[g.x,g.y,g.zoom],getFromHandle:()=>h.fromHandle})}let Xt=null,sn;return n.$$set=W=>{"id"in W&&t(0,w=W.id),"type"in W&&t(1,E=W.type),"position"in W&&t(2,A=W.position),"style"in W&&t(3,R=W.style),"isValidConnection"in W&&t(33,z=W.isValidConnection),"onconnect"in W&&t(34,F=W.onconnect),"ondisconnect"in W&&t(35,L=W.ondisconnect),"isConnectable"in W&&t(36,q=W.isConnectable),"class"in W&&t(4,H=W.class),"$$scope"in W&&t(44,I=W.$$scope)},n.$$.update=()=>{var W,zt,st,et,ss,is,os,rs,En;if(n.$$.dirty[0]&2&&t(11,s=E==="target"),n.$$.dirty[1]&4128&&t(12,i=q!==void 0?q:P),n.$$.dirty[0]&1&&t(6,o=w||null),n.$$.dirty[0]&3|n.$$.dirty[1]&3096&&(F||L)&&t(38,sn=d.get(`${j}-${E}${w?`-${w}`:""}`)),n.$$.dirty[1]&216){if(Xt&&!Gg(sn,Xt)){const qn=sn??new Map;Pl(Xt,qn,L),Pl(qn,Xt,F)}t(37,Xt=sn??new Map)}n.$$.dirty[1]&256&&t(10,a=!!h.fromHandle),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(9,r=((W=h.fromHandle)==null?void 0:W.nodeId)===j&&((zt=h.fromHandle)==null?void 0:zt.type)===E&&((st=h.fromHandle)==null?void 0:st.id)===o),n.$$.dirty[0]&66|n.$$.dirty[1]&256&&t(5,l=((et=h.toHandle)==null?void 0:et.nodeId)===j&&((ss=h.toHandle)==null?void 0:ss.type)===E&&((is=h.toHandle)==null?void 0:is.id)===o),n.$$.dirty[0]&66|n.$$.dirty[1]&768&&t(8,c=f===Gn.Strict?((os=h.fromHandle)==null?void 0:os.type)!==E:j!==((rs=h.fromHandle)==null?void 0:rs.nodeId)||o!==((En=h.fromHandle)==null?void 0:En.id)),n.$$.dirty[0]&32|n.$$.dirty[1]&256&&t(7,u=l&&h.isValid)},[w,E,A,R,H,l,o,u,c,r,a,s,i,b,j,B,re,J,ne,se,ge,Te,Ce,Q,_e,Ae,Ee,Ke,ie,kt,Ft,nn,pn,z,F,L,q,Xt,sn,h,f,d,m,P,I,D]}class X_ extends we{constructor(e){super(),be(this,e,H_,B_,ve,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}const Ot=X_;function Y_(n){var l;let e,t,s=((l=n[0])==null?void 0:l.label)+"",i,o,a,r;return e=new Ot({props:{type:"target",position:n[1]??fe.Top}}),a=new Ot({props:{type:"source",position:n[2]??fe.Bottom}}),{c(){he(e.$$.fragment),t=K(),i=Be(s),o=K(),he(a.$$.fragment)},m(c,u){ce(e,c,u),Z(c,t,u),Z(c,i,u),Z(c,o,u),ce(a,c,u),r=!0},p(c,[u]){var d;const h={};u&2&&(h.position=c[1]??fe.Top),e.$set(h),(!r||u&1)&&s!==(s=((d=c[0])==null?void 0:d.label)+"")&&ht(i,s);const f={};u&4&&(f.position=c[2]??fe.Bottom),a.$set(f)},i(c){r||(Y(e.$$.fragment,c),Y(a.$$.fragment,c),r=!0)},o(c){G(e.$$.fragment,c),G(a.$$.fragment,c),r=!1},d(c){c&&(U(t),U(i),U(o)),ue(e,c),ue(a,c)}}}function j_(n,e,t){const s=["data","targetPosition","sourcePosition"];$e(e,s);let{data:i={label:"Node"}}=e,{targetPosition:o=void 0}=e,{sourcePosition:a=void 0}=e;return n.$$set=r=>{e=Re(Re({},e),Qt(r)),t(3,$e(e,s)),"data"in r&&t(0,i=r.data),"targetPosition"in r&&t(1,o=r.targetPosition),"sourcePosition"in r&&t(2,a=r.sourcePosition)},[i,o,a]}class U_ extends we{constructor(e){super(),be(this,e,j_,Y_,ve,{data:0,targetPosition:1,sourcePosition:2})}}const hh=U_;function G_(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,s,i,o;return i=new Ot({props:{type:"source",position:n[1]??fe.Bottom}}),{c(){t=Be(e),s=K(),he(i.$$.fragment)},m(r,l){Z(r,t,l),Z(r,s,l),ce(i,r,l),o=!0},p(r,[l]){var u;(!o||l&1)&&e!==(e=((u=r[0])==null?void 0:u.label)+"")&&ht(t,e);const c={};l&2&&(c.position=r[1]??fe.Bottom),i.$set(c)},i(r){o||(Y(i.$$.fragment,r),o=!0)},o(r){G(i.$$.fragment,r),o=!1},d(r){r&&(U(t),U(s)),ue(i,r)}}}function Z_(n,e,t){const s=["data","sourcePosition"];$e(e,s);let{data:i={label:"Node"}}=e,{sourcePosition:o=void 0}=e;return n.$$set=a=>{e=Re(Re({},e),Qt(a)),t(2,$e(e,s)),"data"in a&&t(0,i=a.data),"sourcePosition"in a&&t(1,o=a.sourcePosition)},[i,o]}class K_ extends we{constructor(e){super(),be(this,e,Z_,G_,ve,{data:0,sourcePosition:1})}}const Q_=K_;function J_(n){var a;let e=((a=n[0])==null?void 0:a.label)+"",t,s,i,o;return i=new Ot({props:{type:"target",position:n[1]??fe.Top}}),{c(){t=Be(e),s=K(),he(i.$$.fragment)},m(r,l){Z(r,t,l),Z(r,s,l),ce(i,r,l),o=!0},p(r,[l]){var u;(!o||l&1)&&e!==(e=((u=r[0])==null?void 0:u.label)+"")&&ht(t,e);const c={};l&2&&(c.position=r[1]??fe.Top),i.$set(c)},i(r){o||(Y(i.$$.fragment,r),o=!0)},o(r){G(i.$$.fragment,r),o=!1},d(r){r&&(U(t),U(s)),ue(i,r)}}}function $_(n,e,t){const s=["data","targetPosition"];$e(e,s);let{data:i={label:"Node"}}=e,{targetPosition:o=void 0}=e;return n.$$set=a=>{e=Re(Re({},e),Qt(a)),t(2,$e(e,s)),"data"in a&&t(0,i=a.data),"targetPosition"in a&&t(1,o=a.targetPosition)},[i,o]}class e0 extends we{constructor(e){super(),be(this,e,$_,J_,ve,{data:0,targetPosition:1})}}const t0=e0;function n0(n,e,t){const s=[];return $e(e,s),n.$$set=i=>{e=Re(Re({},e),Qt(i)),t(0,$e(e,s))},[]}class s0 extends we{constructor(e){super(),be(this,e,n0,null,ve,{})}}const i0=s0;function jl(n,e,t){if(!e)return;const s=t?e.querySelector(t):e;s&&s.appendChild(n)}function o0(n,{target:e,domNode:t}){return jl(n,t,e),{async update({target:s,domNode:i}){jl(n,i,s)},destroy(){n.parentNode&&n.parentNode.removeChild(n)}}}function r0(n){let e,t,s,i,o;const a=n[3].default,r=Ct(a,n,n[2],null);return{c(){e=X("div"),r&&r.c()},m(l,c){Z(l,e,c),r&&r.m(e,null),s=!0,i||(o=yt(t=o0.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:n[0]})),i=!0)},p(l,[c]){r&&r.p&&(!s||c&4)&&Nt(r,a,l,l[2],s?At(a,l[2],c,null):Et(l[2]),null),t&&Ye(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})},i(l){s||(Y(r,l),s=!0)},o(l){G(r,l),s=!1},d(l){l&&U(e),r&&r.d(l),i=!1,o()}}}function a0(n,e,t){let s,{$$slots:i={},$$scope:o}=e;const{domNode:a}=ct();return ee(n,a,r=>t(0,s=r)),n.$$set=r=>{"$$scope"in r&&t(2,o=r.$$scope)},[s,a,o,i]}class l0 extends we{constructor(e){super(),be(this,e,a0,r0,ve,{})}}const c0=l0;function fh(){const{edgeLookup:n,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:s,addSelectedEdges:i,unselectNodesAndEdges:o,elementsSelectable:a}=ct();return r=>{const l=oe(n).get(r);if(!l){console.warn("012",Ds.error012(r));return}(l.selectable||oe(a)&&typeof l.selectable>"u")&&(e.set(null),t.set(null),l.selected?l.selected&&oe(s)&&o({nodes:[],edges:[l]}):i([r]))}}function u0(n){let e,t,s=`translate(-50%, -50%) translate(${n[1]}px,${n[2]}px)`,i,o,a;const r=n[5].default,l=Ct(r,n,n[7],null);return{c(){e=X("div"),l&&l.c(),C(e,"class","svelte-flow__edge-label"),C(e,"style",t="pointer-events: all;"+n[0]),C(e,"role","button"),C(e,"tabindex","-1"),Se(e,"transform",s)},m(c,u){Z(c,e,u),l&&l.m(e,null),i=!0,o||(a=[de(e,"keyup",f0),de(e,"click",n[6])],o=!0)},p(c,u){l&&l.p&&(!i||u&128)&&Nt(l,r,c,c[7],i?At(r,c[7],u,null):Et(c[7]),null),(!i||u&1&&t!==(t="pointer-events: all;"+c[0]))&&C(e,"style",t);const h=u&1;(u&7&&s!==(s=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||h)&&Se(e,"transform",s)},i(c){i||(Y(l,c),i=!0)},o(c){G(l,c),i=!1},d(c){c&&U(e),l&&l.d(c),o=!1,tt(a)}}}function h0(n){let e,t;return e=new c0({props:{$$slots:{default:[u0]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,[i]){const o={};i&135&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}const f0=()=>{};function d0(n,e,t){let{$$slots:s={},$$scope:i}=e,{style:o=void 0}=e,{x:a=void 0}=e,{y:r=void 0}=e;const l=fh(),c=no("svelteflow__edge_id"),u=()=>{c&&l(c)};return n.$$set=h=>{"style"in h&&t(0,o=h.style),"x"in h&&t(1,a=h.x),"y"in h&&t(2,r=h.y),"$$scope"in h&&t(7,i=h.$$scope)},[o,a,r,l,c,s,u,i]}class m0 extends we{constructor(e){super(),be(this,e,d0,h0,ve,{style:0,x:1,y:2})}}const p0=m0;function g0(n){let e;return{c(){e=Pe("path"),C(e,"d",n[1]),C(e,"stroke-opacity",0),C(e,"stroke-width",n[10]),C(e,"fill","none"),C(e,"class","svelte-flow__edge-interaction")},m(t,s){Z(t,e,s)},p(t,s){s&2&&C(e,"d",t[1])},d(t){t&&U(e)}}}function Ul(n){let e,t;return e=new p0({props:{x:n[3],y:n[4],style:n[5],$$slots:{default:[_0]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i&8&&(o.x=s[3]),i&16&&(o.y=s[4]),i&32&&(o.style=s[5]),i&4100&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function _0(n){let e;return{c(){e=Be(n[2])},m(t,s){Z(t,e,s)},p(t,s){s&4&&ht(e,t[2])},d(t){t&&U(e)}}}function y0(n){let e,t,s,i,o,a,r=n[10]&&g0(n),l=n[2]&&Ul(n);return{c(){e=Pe("path"),s=K(),r&&r.c(),i=K(),l&&l.c(),o=Ze(),C(e,"id",n[0]),C(e,"d",n[1]),C(e,"class",t=Le(["svelte-flow__edge-path",n[9]])),C(e,"marker-start",n[6]),C(e,"marker-end",n[7]),C(e,"fill","none"),C(e,"style",n[8])},m(c,u){Z(c,e,u),Z(c,s,u),r&&r.m(c,u),Z(c,i,u),l&&l.m(c,u),Z(c,o,u),a=!0},p(c,[u]){(!a||u&1)&&C(e,"id",c[0]),(!a||u&2)&&C(e,"d",c[1]),(!a||u&512&&t!==(t=Le(["svelte-flow__edge-path",c[9]])))&&C(e,"class",t),(!a||u&64)&&C(e,"marker-start",c[6]),(!a||u&128)&&C(e,"marker-end",c[7]),(!a||u&256)&&C(e,"style",c[8]),c[10]&&r.p(c,u),c[2]?l?(l.p(c,u),u&4&&Y(l,1)):(l=Ul(c),l.c(),Y(l,1),l.m(o.parentNode,o)):l&&(at(),G(l,1,1,()=>{l=null}),lt())},i(c){a||(Y(l),a=!0)},o(c){G(l),a=!1},d(c){c&&(U(e),U(s),U(i),U(o)),r&&r.d(c),l&&l.d(c)}}}function b0(n,e,t){let{id:s=void 0}=e,{path:i}=e,{label:o=void 0}=e,{labelX:a=void 0}=e,{labelY:r=void 0}=e,{labelStyle:l=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:u=void 0}=e,{style:h=void 0}=e,{interactionWidth:f=20}=e,{class:d=void 0}=e,m=f===void 0?20:f;return n.$$set=g=>{"id"in g&&t(0,s=g.id),"path"in g&&t(1,i=g.path),"label"in g&&t(2,o=g.label),"labelX"in g&&t(3,a=g.labelX),"labelY"in g&&t(4,r=g.labelY),"labelStyle"in g&&t(5,l=g.labelStyle),"markerStart"in g&&t(6,c=g.markerStart),"markerEnd"in g&&t(7,u=g.markerEnd),"style"in g&&t(8,h=g.style),"interactionWidth"in g&&t(11,f=g.interactionWidth),"class"in g&&t(9,d=g.class)},[s,i,o,a,r,l,c,u,h,d,m,f]}class w0 extends we{constructor(e){super(),be(this,e,b0,y0,ve,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}const Ho=w0;function v0(n){let e,t;return e=new Ho({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,[i]){const o={};i&256&&(o.path=s[8]),i&128&&(o.labelX=s[7]),i&64&&(o.labelY=s[6]),i&1&&(o.label=s[0]),i&2&&(o.labelStyle=s[1]),i&8&&(o.markerStart=s[3]),i&16&&(o.markerEnd=s[4]),i&32&&(o.interactionWidth=s[5]),i&4&&(o.style=s[2]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function k0(n,e,t){let s,i,o;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];$e(e,a);let{label:r=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:h=void 0}=e,{interactionWidth:f=void 0}=e,{sourceX:d}=e,{sourceY:m}=e,{sourcePosition:g}=e,{targetX:_}=e,{targetY:p}=e,{targetPosition:v}=e;return n.$$set=y=>{e=Re(Re({},e),Qt(y)),t(15,$e(e,a)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,l=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,h=y.markerEnd),"interactionWidth"in y&&t(5,f=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,m=y.sourceY),"sourcePosition"in y&&t(11,g=y.sourcePosition),"targetX"in y&&t(12,_=y.targetX),"targetY"in y&&t(13,p=y.targetY),"targetPosition"in y&&t(14,v=y.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[s,i,o]=Ju({sourceX:d,sourceY:m,targetX:_,targetY:p,sourcePosition:g,targetPosition:v}),s,(t(7,i),t(9,d),t(10,m),t(12,_),t(13,p),t(11,g),t(14,v)),(t(6,o),t(9,d),t(10,m),t(12,_),t(13,p),t(11,g),t(14,v)))},[r,l,c,u,h,f,o,i,s,d,m,g,_,p,v]}class T0 extends we{constructor(e){super(),be(this,e,k0,v0,ve,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}const dh=T0;function S0(n){let e,t;return e=new Ho({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,[i]){const o={};i&256&&(o.path=s[8]),i&128&&(o.labelX=s[7]),i&64&&(o.labelY=s[6]),i&1&&(o.label=s[0]),i&2&&(o.labelStyle=s[1]),i&8&&(o.markerStart=s[3]),i&16&&(o.markerEnd=s[4]),i&32&&(o.interactionWidth=s[5]),i&4&&(o.style=s[2]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function C0(n,e,t){let s,i,o;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];$e(e,a);let{label:r=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:h=void 0}=e,{interactionWidth:f=void 0}=e,{sourceX:d}=e,{sourceY:m}=e,{sourcePosition:g}=e,{targetX:_}=e,{targetY:p}=e,{targetPosition:v}=e;return n.$$set=y=>{e=Re(Re({},e),Qt(y)),t(15,$e(e,a)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,l=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,h=y.markerEnd),"interactionWidth"in y&&t(5,f=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,m=y.sourceY),"sourcePosition"in y&&t(11,g=y.sourcePosition),"targetX"in y&&t(12,_=y.targetX),"targetY"in y&&t(13,p=y.targetY),"targetPosition"in y&&t(14,v=y.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[s,i,o]=go({sourceX:d,sourceY:m,targetX:_,targetY:p,sourcePosition:g,targetPosition:v}),s,(t(7,i),t(9,d),t(10,m),t(12,_),t(13,p),t(11,g),t(14,v)),(t(6,o),t(9,d),t(10,m),t(12,_),t(13,p),t(11,g),t(14,v)))},[r,l,c,u,h,f,o,i,s,d,m,g,_,p,v]}class A0 extends we{constructor(e){super(),be(this,e,C0,S0,ve,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}const N0=A0;function E0(n){let e,t;return e=new Ho({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,[i]){const o={};i&256&&(o.path=s[8]),i&128&&(o.labelX=s[7]),i&64&&(o.labelY=s[6]),i&1&&(o.label=s[0]),i&2&&(o.labelStyle=s[1]),i&8&&(o.markerStart=s[3]),i&16&&(o.markerEnd=s[4]),i&32&&(o.interactionWidth=s[5]),i&4&&(o.style=s[2]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function M0(n,e,t){let s,i,o;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];$e(e,a);let{label:r=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:h=void 0}=e,{interactionWidth:f=void 0}=e,{sourceX:d}=e,{sourceY:m}=e,{targetX:g}=e,{targetY:_}=e;return n.$$set=p=>{e=Re(Re({},e),Qt(p)),t(13,$e(e,a)),"label"in p&&t(0,r=p.label),"labelStyle"in p&&t(1,l=p.labelStyle),"style"in p&&t(2,c=p.style),"markerStart"in p&&t(3,u=p.markerStart),"markerEnd"in p&&t(4,h=p.markerEnd),"interactionWidth"in p&&t(5,f=p.interactionWidth),"sourceX"in p&&t(9,d=p.sourceX),"sourceY"in p&&t(10,m=p.sourceY),"targetX"in p&&t(11,g=p.targetX),"targetY"in p&&t(12,_=p.targetY)},n.$$.update=()=>{n.$$.dirty&7680&&t(8,[s,i,o]=eh({sourceX:d,sourceY:m,targetX:g,targetY:_}),s,(t(7,i),t(9,d),t(10,m),t(11,g),t(12,_)),(t(6,o),t(9,d),t(10,m),t(11,g),t(12,_)))},[r,l,c,u,h,f,o,i,s,d,m,g,_]}class O0 extends we{constructor(e){super(),be(this,e,M0,E0,ve,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}const D0=O0;function I0(n){let e,t;return e=new Ho({props:{path:n[8],labelX:n[7],labelY:n[6],label:n[0],labelStyle:n[1],markerStart:n[3],markerEnd:n[4],interactionWidth:n[5],style:n[2]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,[i]){const o={};i&256&&(o.path=s[8]),i&128&&(o.labelX=s[7]),i&64&&(o.labelY=s[6]),i&1&&(o.label=s[0]),i&2&&(o.labelStyle=s[1]),i&8&&(o.markerStart=s[3]),i&16&&(o.markerEnd=s[4]),i&32&&(o.interactionWidth=s[5]),i&4&&(o.style=s[2]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function P0(n,e,t){let s,i,o;const a=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];$e(e,a);let{label:r=void 0}=e,{labelStyle:l=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:h=void 0}=e,{interactionWidth:f=void 0}=e,{sourceX:d}=e,{sourceY:m}=e,{sourcePosition:g}=e,{targetX:_}=e,{targetY:p}=e,{targetPosition:v}=e;return n.$$set=y=>{e=Re(Re({},e),Qt(y)),t(15,$e(e,a)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,l=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,h=y.markerEnd),"interactionWidth"in y&&t(5,f=y.interactionWidth),"sourceX"in y&&t(9,d=y.sourceX),"sourceY"in y&&t(10,m=y.sourceY),"sourcePosition"in y&&t(11,g=y.sourcePosition),"targetX"in y&&t(12,_=y.targetX),"targetY"in y&&t(13,p=y.targetY),"targetPosition"in y&&t(14,v=y.targetPosition)},n.$$.update=()=>{n.$$.dirty&32256&&t(8,[s,i,o]=go({sourceX:d,sourceY:m,targetX:_,targetY:p,sourcePosition:g,targetPosition:v,borderRadius:0}),s,(t(7,i),t(9,d),t(10,m),t(12,_),t(13,p),t(11,g),t(14,v)),(t(6,o),t(9,d),t(10,m),t(12,_),t(13,p),t(11,g),t(14,v)))},[r,l,c,u,h,f,o,i,s,d,m,g,_,p,v]}class R0 extends we{constructor(e){super(),be(this,e,P0,I0,ve,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}const x0=R0;function V0(n,e){const t=n.set,s=e.set,i=oe(n),o=oe(e);let r=i.length===0&&o.length>0?o:i;n.set(r);const l=c=>{const u=t(c);return r=u,s(r),u};n.set=e.set=l,n.update=e.update=c=>l(c(r))}function F0(n,e){const t=n.set,s=e.set;let i=oe(e);n.set(i);const o=a=>{t(a),s(a),i=a};n.set=e.set=o,n.update=e.update=a=>o(a(i))}const z0=(n,e,t)=>{if(!t)return;const s=oe(n),i=e.set,o=t.set;let a=t?oe(t):{x:0,y:0,zoom:1};e.set(a),e.set=r=>(i(r),o(r),a=r,r),t.set=r=>(s==null||s.syncViewport(r),i(r),o(r),a=r,r),e.update=r=>{e.set(r(a))},t.update=r=>{t.set(r(a))}},W0=(n,e,t,s=[0,0],i=uo,o,a,r,l,c,u,h,f)=>{const{subscribe:d,set:m,update:g}=ae([]);let _=n,p={},v=!0;const y=T=>{const S=th(T,e,t,{elevateNodesOnSelect:v,nodeOrigin:s,nodeExtent:i,defaults:p,checkEquality:!1});return oe(o)&&S&&oe(l)&&(Qg({nodes:e,width:oe(c),height:oe(u),panZoom:oe(l),minZoom:oe(h),maxZoom:oe(f)},oe(a)).then(O=>{var P;(P=oe(r))==null||P.resolve(O),r.set(null)}),o.set(!1),a.set(void 0)),_=T,m(_),_},k=T=>y(T(_)),b=T=>{p=T},N=T=>{v=T.elevateNodesOnSelect??v};return y(_),{subscribe:d,set:y,update:k,setDefaultOptions:b,setOptions:N}},L0=(n,e,t,s)=>{const{subscribe:i,set:o,update:a}=ae([]);let r=n,l=s||{};const c=f=>{const d=l?f.map(m=>({...l,...m})):f;sh(e,t,d),r=d,o(r)},u=f=>c(f(r)),h=f=>{l=f};return c(r),{subscribe:i,set:c,update:u,setDefaultOptions:h}},mh={input:Q_,output:t0,default:hh,group:i0},ph={straight:D0,smoothstep:N0,default:dh,step:x0},q0=({nodes:n=[],edges:e=[],width:t,height:s,fitView:i,nodeOrigin:o,nodeExtent:a})=>{const r=new Map,l=new Map,c=new Map,u=new Map,h=o??[0,0],f=a??uo;th(n,r,l,{nodeExtent:f,nodeOrigin:h,elevateNodesOnSelect:!1,checkEquality:!1}),sh(c,u,e);let d={x:0,y:0,zoom:1};if(i&&t&&s){const N=_i(r,{filter:T=>!!((T.width||T.initialWidth)&&(T.height||T.initialHeight))});d=Zu(N,t,s,.5,2,.1)}const m=ae(!1),g=ae(void 0),_=ae(null),p=ae(null),v=ae(500),y=ae(500),k=ae(.5),b=ae(2);return{flowId:ae(null),nodes:W0(n,r,l,h,f,m,g,_,p,v,y,k,b),nodeLookup:Wt(r),parentLookup:Wt(l),edgeLookup:Wt(u),visibleNodes:Wt([]),edges:L0(e,c,u),visibleEdges:Wt([]),connectionLookup:Wt(c),width:v,height:y,minZoom:k,maxZoom:b,nodeOrigin:ae(h),nodeDragThreshold:ae(1),nodeExtent:ae(f),translateExtent:ae(uo),autoPanOnNodeDrag:ae(!0),autoPanOnConnect:ae(!0),fitViewQueued:m,fitViewOptions:g,fitViewResolver:_,panZoom:p,snapGrid:ae(null),dragging:ae(!1),selectionRect:ae(null),selectionKeyPressed:ae(!1),multiselectionKeyPressed:ae(!1),deleteKeyPressed:ae(!1),panActivationKeyPressed:ae(!1),zoomActivationKeyPressed:ae(!1),selectionRectMode:ae(null),selectionMode:ae(ho.Partial),nodeTypes:ae(mh),edgeTypes:ae(ph),viewport:ae(d),connectionMode:ae(Gn.Strict),domNode:ae(null),connection:Wt(Rr),connectionLineType:ae(Ss.Bezier),connectionRadius:ae(20),isValidConnection:ae(()=>!0),nodesDraggable:ae(!0),nodesConnectable:ae(!0),elementsSelectable:ae(!0),selectNodesOnDrag:ae(!0),markers:Wt([]),defaultMarkerColor:ae("#b1b1b7"),lib:Wt("svelte"),onlyRenderVisibleElements:ae(!1),onerror:ae(e_),ondelete:ae(void 0),onedgecreate:ae(void 0),onconnect:ae(void 0),onconnectstart:ae(void 0),onconnectend:ae(void 0),onbeforedelete:ae(void 0),nodesInitialized:ae(!1),edgesInitialized:ae(!1),viewportInitialized:ae(!1),initialized:Wt(!1)}};function B0(n){const e=vs([n.edges,n.nodes,n.nodeLookup,n.onlyRenderVisibleElements,n.viewport,n.width,n.height],([t,,s,i,o,a,r])=>i&&a&&r?t.filter(c=>{const u=s.get(c.source),h=s.get(c.target);return u&&h&&c_({sourceNode:u,targetNode:h,width:a,height:r,transform:[o.x,o.y,o.zoom]})}):t);return vs([e,n.nodes,n.nodeLookup,n.connectionMode,n.onerror],([t,,s,i,o])=>t.reduce((r,l)=>{const c=s.get(l.source),u=s.get(l.target);if(!c||!u)return r;const h=g_({id:l.id,sourceNode:c,targetNode:u,sourceHandle:l.sourceHandle||null,targetHandle:l.targetHandle||null,connectionMode:i,onError:o});return h&&r.push({...l,zIndex:l_({selected:l.selected,zIndex:l.zIndex,sourceNode:c,targetNode:u,elevateOnSelect:!1}),...h}),r},[]))}function H0(n){return vs([n.nodeLookup,n.onlyRenderVisibleElements,n.width,n.height,n.viewport,n.nodes],([e,t,s,i,o])=>{const a=[o.x,o.y,o.zoom];return t?Yu(e,{x:0,y:0,width:s,height:i},a,!0):Array.from(e.values())})}const fa=Symbol();function X0({nodes:n,edges:e,width:t,height:s,fitView:i,nodeOrigin:o,nodeExtent:a}){const r=q0({nodes:n,edges:e,width:t,height:s,fitView:i,nodeOrigin:o,nodeExtent:a});function l(E){r.nodeTypes.set({...mh,...E})}function c(E){r.edgeTypes.set({...ph,...E})}function u(E){const A=oe(r.edges);r.edges.set(f_(E,A))}const h=(E,A=!1)=>{var z;const R=oe(r.nodeLookup);for(const[F,L]of E){const q=(z=R.get(F))==null?void 0:z.internals.userNode;q&&(q.position=L.position,q.dragging=A)}r.nodes.update(F=>F)};function f(E){var L,q,H;const A=oe(r.nodeLookup),R=oe(r.parentLookup),{changes:z,updatedInternals:F}=T_(E,A,oe(r.parentLookup),oe(r.domNode),oe(r.nodeOrigin));if(F){b_(A,R,{nodeOrigin:o,nodeExtent:a});for(const j of z){const B=(L=A.get(j.id))==null?void 0:L.internals.userNode;if(B)switch(j.type){case"dimensions":{const te={...B.measured,...j.dimensions};j.setAttributes&&(B.width=((q=j.dimensions)==null?void 0:q.width)??B.width,B.height=((H=j.dimensions)==null?void 0:H.height)??B.height),B.measured=te;break}case"position":B.position=j.position??B.position;break}}r.nodes.update(j=>j),oe(r.nodesInitialized)||r.nodesInitialized.set(!0)}}function d(E){const A=oe(r.fitViewResolver)??s_();return r.fitViewQueued.set(!0),r.fitViewOptions.set(E),r.fitViewResolver.set(A),r.nodes.set(oe(r.nodes)),A.promise}function m(E,A){const R=oe(r.panZoom);return R?R.scaleBy(E,A):Promise.resolve(!1)}function g(E){return m(1.2,E)}function _(E){return m(1/1.2,E)}function p(E){const A=oe(r.panZoom);A&&(A.setScaleExtent([E,oe(r.maxZoom)]),r.minZoom.set(E))}function v(E){const A=oe(r.panZoom);A&&(A.setScaleExtent([oe(r.minZoom),E]),r.maxZoom.set(E))}function y(E){const A=oe(r.panZoom);A&&(A.setTranslateExtent(E),r.translateExtent.set(E))}function k(E){let A=!1;return E.forEach(R=>{R.selected&&(R.selected=!1,A=!0)}),A}function b(E){var A;(A=oe(r.panZoom))==null||A.setClickDistance(E)}function N(E){k((E==null?void 0:E.nodes)||oe(r.nodes))&&r.nodes.set(oe(r.nodes)),k((E==null?void 0:E.edges)||oe(r.edges))&&r.edges.set(oe(r.edges))}r.deleteKeyPressed.subscribe(async E=>{var A;if(E){const R=oe(r.nodes),z=oe(r.edges),F=R.filter(j=>j.selected),L=z.filter(j=>j.selected),{nodes:q,edges:H}=await $g({nodesToRemove:F,edgesToRemove:L,nodes:R,edges:z,onBeforeDelete:oe(r.onbeforedelete)});(q.length||H.length)&&(r.nodes.update(j=>j.filter(B=>!q.some(te=>te.id===B.id))),r.edges.update(j=>j.filter(B=>!H.some(te=>te.id===B.id))),(A=oe(r.ondelete))==null||A({nodes:q,edges:H}))}});function T(E){const A=oe(r.multiselectionKeyPressed);r.nodes.update(R=>R.map(z=>{const F=E.includes(z.id),L=A&&z.selected||F;return z.selected=L,z})),A||r.edges.update(R=>R.map(z=>(z.selected=!1,z)))}function S(E){const A=oe(r.multiselectionKeyPressed);r.edges.update(R=>R.map(z=>{const F=E.includes(z.id),L=A&&z.selected||F;return z.selected=L,z})),A||r.nodes.update(R=>R.map(z=>(z.selected=!1,z)))}function M(E){var R;const A=(R=oe(r.nodes))==null?void 0:R.find(z=>z.id===E);if(!A){console.warn("012",Ds.error012(E));return}r.selectionRect.set(null),r.selectionRectMode.set(null),A.selected?A.selected&&oe(r.multiselectionKeyPressed)&&N({nodes:[A],edges:[]}):T([E])}function O(E){const A=oe(r.viewport);return S_({delta:E,panZoom:oe(r.panZoom),transform:[A.x,A.y,A.zoom],translateExtent:oe(r.translateExtent),width:oe(r.width),height:oe(r.height)})}const P=ae(Rr),D=E=>{P.set({...E})};function I(){P.set(Rr)}function w(){r.selectionRect.set(null),r.selectionRectMode.set(null),r.snapGrid.set(null),r.isValidConnection.set(()=>!0),N(),I()}return{...r,visibleEdges:B0(r),visibleNodes:H0(r),connection:vs([P,r.viewport],([E,A])=>E.inProgress?{...E,to:qo(E.to,[A.x,A.y,A.zoom])}:{...E}),markers:vs([r.edges,r.defaultMarkerColor,r.flowId],([E,A,R])=>__(E,{defaultColor:A,id:R})),initialized:(()=>{let E=!1;const A=oe(r.nodes).length,R=oe(r.edges).length;return vs([r.nodesInitialized,r.edgesInitialized,r.viewportInitialized],([z,F,L])=>E||(A===0?E=L:R===0?E=L&&z:E=L&&z&&F,E))})(),syncNodeStores:E=>V0(r.nodes,E),syncEdgeStores:E=>F0(r.edges,E),syncViewport:E=>z0(r.panZoom,r.viewport,E),setNodeTypes:l,setEdgeTypes:c,addEdge:u,updateNodePositions:h,updateNodeInternals:f,zoomIn:g,zoomOut:_,fitView:E=>d(E),setMinZoom:p,setMaxZoom:v,setTranslateExtent:y,setPaneClickDistance:b,unselectNodesAndEdges:N,addSelectedNodes:T,addSelectedEdges:S,handleNodeSelection:M,panBy:O,updateConnection:D,cancelConnection:I,reset:w}}function ct(){const n=no(fa);if(!n)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return n.getStore()}function Y0({nodes:n,edges:e,width:t,height:s,fitView:i,nodeOrigin:o,nodeExtent:a}){const r=X0({nodes:n,edges:e,width:t,height:s,fitView:i,nodeOrigin:o,nodeExtent:a});return to(fa,{getStore:()=>r}),r}function j0(n,e){const{panZoom:t,minZoom:s,maxZoom:i,initialViewport:o,viewport:a,dragging:r,translateExtent:l,paneClickDistance:c}=e,u=q_({domNode:n,minZoom:s,maxZoom:i,translateExtent:l,viewport:o,paneClickDistance:c,onDraggingChange:r.set}),h=u.getViewport();return a.set(h),t.set(u),u.update(e),{update(f){u.update(f)}}}function U0(n){let e,t,s,i,o;const a=n[35].default,r=Ct(a,n,n[34],null);return{c(){e=X("div"),r&&r.c(),C(e,"class","svelte-flow__zoom svelte-4xkw84")},m(l,c){Z(l,e,c),r&&r.m(e,null),s=!0,i||(o=yt(t=j0.call(null,e,{viewport:n[18],minZoom:n[12],maxZoom:n[13],initialViewport:n[11],dragging:n[23],panZoom:n[19],onPanZoomStart:n[0],onPanZoom:n[1],onPanZoomEnd:n[2],zoomOnScroll:n[5],zoomOnDoubleClick:n[6],zoomOnPinch:n[7],panOnScroll:n[9],panOnDrag:n[10],panOnScrollSpeed:.5,panOnScrollMode:n[3]||an.Free,zoomActivationKeyPressed:n[14],preventScrolling:typeof n[4]=="boolean"?n[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!n[15],translateExtent:n[16],lib:n[17],paneClickDistance:n[8],onTransformChange:n[29]})),i=!0)},p(l,c){r&&r.p&&(!s||c[1]&8)&&Nt(r,a,l,l[34],s?At(a,l[34],c,null):Et(l[34]),null),t&&Ye(t.update)&&c[0]&262143&&t.update.call(null,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||an.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})},i(l){s||(Y(r,l),s=!0)},o(l){G(r,l),s=!1},d(l){l&&U(e),r&&r.d(l),i=!1,o()}}}function G0(n,e,t){let s,i,o,a,r,l,c,u,h,f,d,{$$slots:m={},$$scope:g}=e,{initialViewport:_=void 0}=e,{onMoveStart:p=void 0}=e,{onMove:v=void 0}=e,{onMoveEnd:y=void 0}=e,{panOnScrollMode:k}=e,{preventScrolling:b}=e,{zoomOnScroll:N}=e,{zoomOnDoubleClick:T}=e,{zoomOnPinch:S}=e,{panOnDrag:M}=e,{panOnScroll:O}=e,{paneClickDistance:P}=e;const{viewport:D,panZoom:I,selectionRect:w,minZoom:E,maxZoom:A,dragging:R,translateExtent:z,lib:F,panActivationKeyPressed:L,zoomActivationKeyPressed:q,viewportInitialized:H}=ct();ee(n,w,B=>t(15,h=B)),ee(n,E,B=>t(12,l=B)),ee(n,A,B=>t(13,c=B)),ee(n,z,B=>t(16,f=B)),ee(n,F,B=>t(17,d=B)),ee(n,L,B=>t(33,r=B)),ee(n,q,B=>t(14,u=B)),ee(n,H,B=>t(36,a=B));const j=B=>D.set({x:B[0],y:B[1],zoom:B[2]});return di(()=>{$i(H,a=!0,a)}),n.$$set=B=>{"initialViewport"in B&&t(30,_=B.initialViewport),"onMoveStart"in B&&t(0,p=B.onMoveStart),"onMove"in B&&t(1,v=B.onMove),"onMoveEnd"in B&&t(2,y=B.onMoveEnd),"panOnScrollMode"in B&&t(3,k=B.panOnScrollMode),"preventScrolling"in B&&t(4,b=B.preventScrolling),"zoomOnScroll"in B&&t(5,N=B.zoomOnScroll),"zoomOnDoubleClick"in B&&t(6,T=B.zoomOnDoubleClick),"zoomOnPinch"in B&&t(7,S=B.zoomOnPinch),"panOnDrag"in B&&t(31,M=B.panOnDrag),"panOnScroll"in B&&t(32,O=B.panOnScroll),"paneClickDistance"in B&&t(8,P=B.paneClickDistance),"$$scope"in B&&t(34,g=B.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073741824&&t(11,s=_||{x:0,y:0,zoom:1}),n.$$.dirty[1]&5&&t(10,i=r||M),n.$$.dirty[1]&6&&t(9,o=r||O)},[p,v,y,k,b,N,T,S,P,o,i,s,l,c,u,h,f,d,D,I,w,E,A,R,z,F,L,q,H,j,_,M,O,r,g,m]}class Z0 extends we{constructor(e){super(),be(this,e,G0,U0,ve,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}const K0=Z0;function Q0(n){let e,t,s,i;const o=n[29].default,a=Ct(o,n,n[28],null);return{c(){e=X("div"),a&&a.c(),C(e,"class","svelte-flow__pane svelte-1esy7hx"),ke(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),ke(e,"dragging",n[4]),ke(e,"selection",n[1])},m(r,l){Z(r,e,l),a&&a.m(e,null),n[30](e),t=!0,s||(i=[de(e,"click",function(){Ye(n[3]?void 0:qi(n[16],n[2]))&&(n[3]?void 0:qi(n[16],n[2])).apply(this,arguments)}),de(e,"pointerdown",function(){Ye(n[3]?n[17]:void 0)&&(n[3]?n[17]:void 0).apply(this,arguments)}),de(e,"pointermove",function(){Ye(n[3]?n[18]:void 0)&&(n[3]?n[18]:void 0).apply(this,arguments)}),de(e,"pointerup",function(){Ye(n[3]?n[19]:void 0)&&(n[3]?n[19]:void 0).apply(this,arguments)}),de(e,"contextmenu",function(){Ye(qi(n[20],n[2]))&&qi(n[20],n[2]).apply(this,arguments)})],s=!0)},p(r,l){n=r,a&&a.p&&(!t||l[0]&268435456)&&Nt(a,o,n,n[28],t?At(o,n[28],l,null):Et(n[28]),null),(!t||l[0]&1)&&ke(e,"draggable",n[0]===!0||Array.isArray(n[0])&&n[0].includes(0)),(!t||l[0]&16)&&ke(e,"dragging",n[4]),(!t||l[0]&2)&&ke(e,"selection",n[1])},i(r){t||(Y(a,r),t=!0)},o(r){G(a,r),t=!1},d(r){r&&U(e),a&&a.d(r),n[30](null),s=!1,tt(i)}}}function qi(n,e){return t=>{t.target===e&&(n==null||n(t))}}function Gl(n){return e=>{const t=n.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function J0(n,e,t){let s,i,o,a,r,l,c,u,h,f,d,m,g,_,{$$slots:p={},$$scope:v}=e,{panOnDrag:y=void 0}=e,{selectionOnDrag:k=void 0}=e;const b=Io(),{nodes:N,nodeLookup:T,edges:S,viewport:M,dragging:O,elementsSelectable:P,selectionRect:D,selectionRectMode:I,selectionKeyPressed:w,selectionMode:E,panActivationKeyPressed:A,unselectNodesAndEdges:R,connection:z}=ct();ee(n,T,se=>t(37,h=se)),ee(n,S,se=>t(34,l=se)),ee(n,M,se=>t(36,u=se)),ee(n,O,se=>t(4,_=se)),ee(n,P,se=>t(26,m=se)),ee(n,D,se=>t(25,f=se)),ee(n,I,se=>t(24,r=se)),ee(n,w,se=>t(23,a=se)),ee(n,E,se=>t(35,c=se)),ee(n,A,se=>t(27,g=se)),ee(n,z,se=>t(38,d=se));let F,L=null,q=[],H=!1;function j(se){if(H||d.inProgress){H=!1;return}b("paneclick",{event:se}),R(),I.set(null)}function B(se){var Ce,ze;if(L=F.getBoundingClientRect(),!P||!i||se.button!==0||se.target!==F||!L)return;(ze=(Ce=se.target)==null?void 0:Ce.setPointerCapture)==null||ze.call(Ce,se.pointerId);const{x:ge,y:Te}=bn(se,L);R(),D.set({width:0,height:0,startX:ge,startY:Te,x:ge,y:Te})}function te(se){if(!i||!L||!f)return;H=!0;const ge=bn(se,L),Te=f.startX??0,Ce=f.startY??0,ze={...f,x:ge.x<Te?ge.x:Te,y:ge.y<Ce?ge.y:Ce,width:Math.abs(ge.x-Te),height:Math.abs(ge.y-Ce)},Q=q.map(_e=>_e.id),$=xr(q,l).map(_e=>_e.id);q=Yu(h,ze,[u.x,u.y,u.zoom],c===ho.Partial,!0);const le=xr(q,l).map(_e=>_e.id),Oe=q.map(_e=>_e.id);(Q.length!==Oe.length||Oe.some(_e=>!Q.includes(_e)))&&N.update(_e=>_e.map(Gl(Oe))),($.length!==le.length||le.some(_e=>!$.includes(_e)))&&S.update(_e=>_e.map(Gl(le))),I.set("user"),D.set(ze)}function re(se){var ge,Te;se.button===0&&((Te=(ge=se.target)==null?void 0:ge.releasePointerCapture)==null||Te.call(ge,se.pointerId),!i&&r==="user"&&se.target===F&&(j==null||j(se)),D.set(null),q.length>0&&$i(I,r="nodes",r),a&&(H=!1))}const J=se=>{if(Array.isArray(s)&&(s!=null&&s.includes(2))){se.preventDefault();return}b("panecontextmenu",{event:se})};function ne(se){ti[se?"unshift":"push"](()=>{F=se,t(2,F)})}return n.$$set=se=>{"panOnDrag"in se&&t(0,y=se.panOnDrag),"selectionOnDrag"in se&&t(21,k=se.selectionOnDrag),"$$scope"in se&&t(28,v=se.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&134217729&&t(22,s=g||y),n.$$.dirty[0]&48234496&&t(1,i=a||f||k&&s!==!0),n.$$.dirty[0]&83886082&&t(3,o=m&&(i||r==="user"))},[y,i,F,o,_,T,S,M,O,P,D,I,w,E,A,z,j,B,te,re,J,k,s,a,r,f,m,g,v,p,ne]}class $0 extends we{constructor(e){super(),be(this,e,J0,Q0,ve,{panOnDrag:0,selectionOnDrag:21},null,[-1,-1])}}const e1=$0;function t1(n){let e,t;const s=n[3].default,i=Ct(s,n,n[2],null);return{c(){e=X("div"),i&&i.c(),C(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),Se(e,"transform","translate("+n[0].x+"px, "+n[0].y+"px) scale("+n[0].zoom+")")},m(o,a){Z(o,e,a),i&&i.m(e,null),t=!0},p(o,[a]){i&&i.p&&(!t||a&4)&&Nt(i,s,o,o[2],t?At(s,o[2],a,null):Et(o[2]),null),(!t||a&1)&&Se(e,"transform","translate("+o[0].x+"px, "+o[0].y+"px) scale("+o[0].zoom+")")},i(o){t||(Y(i,o),t=!0)},o(o){G(i,o),t=!1},d(o){o&&U(e),i&&i.d(o)}}}function n1(n,e,t){let s,{$$slots:i={},$$scope:o}=e;const{viewport:a}=ct();return ee(n,a,r=>t(0,s=r)),n.$$set=r=>{"$$scope"in r&&t(2,o=r.$$scope)},[s,a,o,i]}class s1 extends we{constructor(e){super(),be(this,e,n1,t1,ve,{})}}const i1=s1;function gh(n,e){const{store:t,onDrag:s,onDragStart:i,onDragStop:o,onNodeMouseDown:a}=e,r=A_({onDrag:s,onDragStart:i,onDragStop:o,onNodeMouseDown:a,getStoreItems:()=>{const c=oe(t.snapGrid),u=oe(t.viewport);return{nodes:oe(t.nodes),nodeLookup:oe(t.nodeLookup),edges:oe(t.edges),nodeExtent:oe(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:oe(t.nodeOrigin),multiSelectionActive:oe(t.multiselectionKeyPressed),domNode:oe(t.domNode),transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:oe(t.autoPanOnNodeDrag),nodesDraggable:oe(t.nodesDraggable),selectNodesOnDrag:oe(t.selectNodesOnDrag),nodeDragThreshold:oe(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function l(c,u){if(u.disabled){r.destroy();return}r.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return l(n,e),{update(c){l(n,c)},destroy(){r.destroy()}}}function o1({width:n,height:e,initialWidth:t,initialHeight:s,measuredWidth:i,measuredHeight:o}){if(i===void 0&&o===void 0){const a=n??t,r=e??s;return{width:a?`width:${a}px;`:"",height:r?`height:${r}px;`:""}}return{width:n?`width:${n}px;`:"",height:e?`height:${e}px;`:""}}function Zl(n){let e,t,s,i,o,a=`translate(${n[12]}px, ${n[13]}px)`,r,l,c;var u=n[27];function h(f,d){return{props:{data:f[2],id:f[1],selected:f[3]??!1,selectable:f[5]??f[28]??!0,deletable:f[7]??!0,sourcePosition:f[14],targetPosition:f[15],zIndex:f[16],dragging:f[9],draggable:f[4]??f[29]??!0,dragHandle:f[19],parentId:f[21],type:f[25],isConnectable:f[30],positionAbsoluteX:f[12],positionAbsoluteY:f[13],width:f[17],height:f[18]}}}return u&&(t=eo(u,h(n))),{c(){e=X("div"),t&&he(t.$$.fragment),C(e,"data-id",n[1]),C(e,"class",s=Le(["svelte-flow__node",`svelte-flow__node-${n[25]}`,n[23]])),C(e,"style",i=(n[10]??"")+";"+n[26].width+n[26].height),ke(e,"dragging",n[9]),ke(e,"selected",n[3]),ke(e,"draggable",n[4]),ke(e,"connectable",n[6]),ke(e,"selectable",n[5]),ke(e,"nopan",n[4]),ke(e,"parent",n[11]),Se(e,"z-index",n[16]),Se(e,"transform",a),Se(e,"visibility",n[20]?"visible":"hidden")},m(f,d){Z(f,e,d),t&&ce(t,e,null),n[54](e),r=!0,l||(c=[yt(o=gh.call(null,e,{nodeId:n[1],isSelectable:n[5],disabled:!1,handleSelector:n[19],noDragClass:"nodrag",nodeClickDistance:n[22],onNodeMouseDown:n[33],onDrag:n[51],onDragStart:n[52],onDragStop:n[53],store:n[31]})),de(e,"click",n[38]),de(e,"mouseenter",n[55]),de(e,"mouseleave",n[56]),de(e,"mousemove",n[57]),de(e,"contextmenu",n[58])],l=!0)},p(f,d){if(d[0]&134217728&&u!==(u=f[27])){if(t){at();const g=t;G(g.$$.fragment,1,0,()=>{ue(g,1)}),lt()}u?(t=eo(u,h(f)),he(t.$$.fragment),Y(t.$$.fragment,1),ce(t,e,null)):t=null}else if(u){const g={};d[0]&4&&(g.data=f[2]),d[0]&2&&(g.id=f[1]),d[0]&8&&(g.selected=f[3]??!1),d[0]&268435488&&(g.selectable=f[5]??f[28]??!0),d[0]&128&&(g.deletable=f[7]??!0),d[0]&16384&&(g.sourcePosition=f[14]),d[0]&32768&&(g.targetPosition=f[15]),d[0]&65536&&(g.zIndex=f[16]),d[0]&512&&(g.dragging=f[9]),d[0]&536870928&&(g.draggable=f[4]??f[29]??!0),d[0]&524288&&(g.dragHandle=f[19]),d[0]&2097152&&(g.parentId=f[21]),d[0]&33554432&&(g.type=f[25]),d[0]&1073741824&&(g.isConnectable=f[30]),d[0]&4096&&(g.positionAbsoluteX=f[12]),d[0]&8192&&(g.positionAbsoluteY=f[13]),d[0]&131072&&(g.width=f[17]),d[0]&262144&&(g.height=f[18]),t.$set(g)}(!r||d[0]&2)&&C(e,"data-id",f[1]),(!r||d[0]&41943040&&s!==(s=Le(["svelte-flow__node",`svelte-flow__node-${f[25]}`,f[23]])))&&C(e,"class",s),(!r||d[0]&67109888&&i!==(i=(f[10]??"")+";"+f[26].width+f[26].height))&&C(e,"style",i),o&&Ye(o.update)&&d[0]&4718626&&o.update.call(null,{nodeId:f[1],isSelectable:f[5],disabled:!1,handleSelector:f[19],noDragClass:"nodrag",nodeClickDistance:f[22],onNodeMouseDown:f[33],onDrag:f[51],onDragStart:f[52],onDragStop:f[53],store:f[31]}),(!r||d[0]&41943552)&&ke(e,"dragging",f[9]),(!r||d[0]&41943048)&&ke(e,"selected",f[3]),(!r||d[0]&41943056)&&ke(e,"draggable",f[4]),(!r||d[0]&41943104)&&ke(e,"connectable",f[6]),(!r||d[0]&41943072)&&ke(e,"selectable",f[5]),(!r||d[0]&41943056)&&ke(e,"nopan",f[4]),(!r||d[0]&41945088)&&ke(e,"parent",f[11]);const m=d[0]&67109888;(d[0]&67175424||m)&&Se(e,"z-index",f[16]),(d[0]&67122176&&a!==(a=`translate(${f[12]}px, ${f[13]}px)`)||m)&&Se(e,"transform",a),(d[0]&68158464||m)&&Se(e,"visibility",f[20]?"visible":"hidden")},i(f){r||(t&&Y(t.$$.fragment,f),r=!0)},o(f){t&&G(t.$$.fragment,f),r=!1},d(f){f&&U(e),t&&ue(t),n[54](null),l=!1,tt(c)}}}function r1(n){let e,t,s=!n[8]&&Zl(n);return{c(){s&&s.c(),e=Ze()},m(i,o){s&&s.m(i,o),Z(i,e,o),t=!0},p(i,o){i[8]?s&&(at(),G(s,1,1,()=>{s=null}),lt()):s?(s.p(i,o),o[0]&256&&Y(s,1)):(s=Zl(i),s.c(),Y(s,1),s.m(e.parentNode,e))},i(i){t||(Y(s),t=!0)},o(i){G(s),t=!1},d(i){i&&U(e),s&&s.d(i)}}}function a1(n,e,t){let s,i,o,a,r,l,c,u,{node:h}=e,{id:f}=e,{data:d={}}=e,{selected:m=!1}=e,{draggable:g=void 0}=e,{selectable:_=void 0}=e,{connectable:p=!0}=e,{deletable:v=!0}=e,{hidden:y=!1}=e,{dragging:k=!1}=e,{resizeObserver:b=null}=e,{style:N=void 0}=e,{type:T="default"}=e,{isParent:S=!1}=e,{positionX:M}=e,{positionY:O}=e,{sourcePosition:P=void 0}=e,{targetPosition:D=void 0}=e,{zIndex:I}=e,{measuredWidth:w=void 0}=e,{measuredHeight:E=void 0}=e,{initialWidth:A=void 0}=e,{initialHeight:R=void 0}=e,{width:z=void 0}=e,{height:F=void 0}=e,{dragHandle:L=void 0}=e,{initialized:q=!1}=e,{parentId:H=void 0}=e,{nodeClickDistance:j=void 0}=e,{class:B=""}=e;const te=ct(),{nodeTypes:re,nodeDragThreshold:J,selectNodesOnDrag:ne,handleNodeSelection:se,updateNodeInternals:ge,elementsSelectable:Te,nodesDraggable:Ce}=te;ee(n,re,W=>t(50,r=W)),ee(n,Te,W=>t(28,l=W)),ee(n,Ce,W=>t(29,c=W));let ze,Q=null;const $=Io(),le=ae(p);ee(n,le,W=>t(30,u=W));let Oe,_e,Ae;to("svelteflow__node_id",f),to("svelteflow__node_connectable",le),du(()=>{Q&&(b==null||b.unobserve(Q))});function Ee(W){_&&(!oe(ne)||!g||oe(J)>0)&&se(f),$("nodeclick",{node:h.internals.userNode,event:W})}const Ke=(W,zt,st,et)=>{$("nodedrag",{event:W,targetNode:st,nodes:et})},ie=(W,zt,st,et)=>{$("nodedragstart",{event:W,targetNode:st,nodes:et})},kt=(W,zt,st,et)=>{$("nodedragstop",{event:W,targetNode:st,nodes:et})};function Ft(W){ti[W?"unshift":"push"](()=>{ze=W,t(24,ze)})}const nn=W=>$("nodemouseenter",{node:h,event:W}),pn=W=>$("nodemouseleave",{node:h,event:W}),Xt=W=>$("nodemousemove",{node:h,event:W}),sn=W=>$("nodecontextmenu",{node:h,event:W});return n.$$set=W=>{"node"in W&&t(0,h=W.node),"id"in W&&t(1,f=W.id),"data"in W&&t(2,d=W.data),"selected"in W&&t(3,m=W.selected),"draggable"in W&&t(4,g=W.draggable),"selectable"in W&&t(5,_=W.selectable),"connectable"in W&&t(6,p=W.connectable),"deletable"in W&&t(7,v=W.deletable),"hidden"in W&&t(8,y=W.hidden),"dragging"in W&&t(9,k=W.dragging),"resizeObserver"in W&&t(39,b=W.resizeObserver),"style"in W&&t(10,N=W.style),"type"in W&&t(40,T=W.type),"isParent"in W&&t(11,S=W.isParent),"positionX"in W&&t(12,M=W.positionX),"positionY"in W&&t(13,O=W.positionY),"sourcePosition"in W&&t(14,P=W.sourcePosition),"targetPosition"in W&&t(15,D=W.targetPosition),"zIndex"in W&&t(16,I=W.zIndex),"measuredWidth"in W&&t(41,w=W.measuredWidth),"measuredHeight"in W&&t(42,E=W.measuredHeight),"initialWidth"in W&&t(43,A=W.initialWidth),"initialHeight"in W&&t(44,R=W.initialHeight),"width"in W&&t(17,z=W.width),"height"in W&&t(18,F=W.height),"dragHandle"in W&&t(19,L=W.dragHandle),"initialized"in W&&t(20,q=W.initialized),"parentId"in W&&t(21,H=W.parentId),"nodeClickDistance"in W&&t(22,j=W.nodeClickDistance),"class"in W&&t(23,B=W.class)},n.$$.update=()=>{n.$$.dirty[1]&512&&t(25,s=T||"default"),n.$$.dirty[0]&33554432|n.$$.dirty[1]&524288&&t(49,i=!!r[s]),n.$$.dirty[0]&33554432|n.$$.dirty[1]&524288&&t(27,o=r[s]||hh),n.$$.dirty[1]&262656&&(i||console.warn("003",Ds.error003(T))),n.$$.dirty[0]&393216|n.$$.dirty[1]&15360&&t(26,a=o1({width:z,height:F,initialWidth:A,initialHeight:R,measuredWidth:w,measuredHeight:E})),n.$$.dirty[0]&64&&le.set(!!p),n.$$.dirty[0]&50380802|n.$$.dirty[1]&229376&&((Oe&&s!==Oe||_e&&P!==_e||Ae&&D!==Ae)&&requestAnimationFrame(()=>ge(new Map([[f,{id:f,nodeElement:ze,force:!0}]]))),t(46,Oe=s),t(47,_e=P),t(48,Ae=D)),n.$$.dirty[0]&17825792|n.$$.dirty[1]&16640&&b&&(ze!==Q||!q)&&(Q&&b.unobserve(Q),ze&&b.observe(ze),t(45,Q=ze))},[h,f,d,m,g,_,p,v,y,k,N,S,M,O,P,D,I,z,F,L,q,H,j,B,ze,s,a,o,l,c,u,te,re,se,Te,Ce,$,le,Ee,b,T,w,E,A,R,Q,Oe,_e,Ae,i,r,Ke,ie,kt,Ft,nn,pn,Xt,sn]}class l1 extends we{constructor(e){super(),be(this,e,a1,r1,hu,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:39,style:10,type:40,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:41,measuredHeight:42,initialWidth:43,initialHeight:44,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const c1=l1;const{Map:u1}=sd;function Kl(n,e,t){const s=n.slice();return s[21]=e[t],s}function Ql(n,e){let t,s,i;return s=new c1({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:po(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),s.$on("nodeclick",e[12]),s.$on("nodemouseenter",e[13]),s.$on("nodemousemove",e[14]),s.$on("nodemouseleave",e[15]),s.$on("nodedrag",e[16]),s.$on("nodedragstart",e[17]),s.$on("nodedragstop",e[18]),s.$on("nodecontextmenu",e[19]),{key:n,first:null,c(){t=Ze(),he(s.$$.fragment),this.first=t},m(o,a){Z(o,t,a),ce(s,o,a),i=!0},p(o,a){e=o;const r={};a&2&&(r.node=e[21]),a&2&&(r.id=e[21].id),a&2&&(r.data=e[21].data),a&2&&(r.selected=!!e[21].selected),a&2&&(r.hidden=!!e[21].hidden),a&6&&(r.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),a&10&&(r.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),a&18&&(r.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),a&2&&(r.deletable=e[21].deletable??!0),a&2&&(r.positionX=e[21].internals.positionAbsolute.x),a&2&&(r.positionY=e[21].internals.positionAbsolute.y),a&34&&(r.isParent=e[5].has(e[21].id)),a&2&&(r.style=e[21].style),a&2&&(r.class=e[21].class),a&2&&(r.type=e[21].type??"default"),a&2&&(r.sourcePosition=e[21].sourcePosition),a&2&&(r.targetPosition=e[21].targetPosition),a&2&&(r.dragging=e[21].dragging),a&2&&(r.zIndex=e[21].internals.z??0),a&2&&(r.dragHandle=e[21].dragHandle),a&2&&(r.initialized=po(e[21])),a&2&&(r.width=e[21].width),a&2&&(r.height=e[21].height),a&2&&(r.initialWidth=e[21].initialWidth),a&2&&(r.initialHeight=e[21].initialHeight),a&2&&(r.measuredWidth=e[21].measured.width),a&2&&(r.measuredHeight=e[21].measured.height),a&2&&(r.parentId=e[21].parentId),a&1&&(r.nodeClickDistance=e[0]),s.$set(r)},i(o){i||(Y(s.$$.fragment,o),i=!0)},o(o){G(s.$$.fragment,o),i=!1},d(o){o&&U(t),ue(s,o)}}}function h1(n){let e,t=[],s=new u1,i,o=Mt(n[1]);const a=r=>r[21].id;for(let r=0;r<o.length;r+=1){let l=Kl(n,o,r),c=a(l);s.set(c,t[r]=Ql(c,l))}return{c(){e=X("div");for(let r=0;r<t.length;r+=1)t[r].c();C(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(r,l){Z(r,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(r,[l]){l&2111&&(o=Mt(r[1]),at(),t=Ro(t,l,a,1,r,o,s,e,Po,Ql,null,Kl),lt())},i(r){if(!i){for(let l=0;l<o.length;l+=1)Y(t[l]);i=!0}},o(r){for(let l=0;l<t.length;l+=1)G(t[l]);i=!1},d(r){r&&U(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function f1(n,e,t){let s,i,o,a,r,{nodeClickDistance:l=0}=e;const{visibleNodes:c,nodesDraggable:u,nodesConnectable:h,elementsSelectable:f,updateNodeInternals:d,parentLookup:m}=ct();ee(n,c,S=>t(1,s=S)),ee(n,u,S=>t(2,i=S)),ee(n,h,S=>t(4,a=S)),ee(n,f,S=>t(3,o=S)),ee(n,m,S=>t(5,r=S));const g=typeof ResizeObserver>"u"?null:new ResizeObserver(S=>{const M=new Map;S.forEach(O=>{const P=O.target.getAttribute("data-id");M.set(P,{id:P,nodeElement:O.target,force:!0})}),d(M)});du(()=>{g==null||g.disconnect()});function _(S){De.call(this,n,S)}function p(S){De.call(this,n,S)}function v(S){De.call(this,n,S)}function y(S){De.call(this,n,S)}function k(S){De.call(this,n,S)}function b(S){De.call(this,n,S)}function N(S){De.call(this,n,S)}function T(S){De.call(this,n,S)}return n.$$set=S=>{"nodeClickDistance"in S&&t(0,l=S.nodeClickDistance)},[l,s,i,o,a,r,c,u,h,f,m,g,_,p,v,y,k,b,N,T]}class d1 extends we{constructor(e){super(),be(this,e,f1,h1,ve,{nodeClickDistance:0})}}const m1=d1;function Jl(n){let e,t,s,i,o,a,r,l;var c=n[27];function u(h,f){return{props:{id:h[0],source:h[1],target:h[2],sourceX:h[14],sourceY:h[15],targetX:h[16],targetY:h[17],sourcePosition:h[18],targetPosition:h[19],animated:h[6],selected:h[7],label:h[10],labelStyle:h[11],data:h[3],style:h[4],interactionWidth:h[21],selectable:h[24],deletable:h[8]??!0,type:h[23],sourceHandleId:h[12],targetHandleId:h[13],markerStart:h[26],markerEnd:h[25]}}}return c&&(s=eo(c,u(n))),{c(){e=Pe("svg"),t=Pe("g"),s&&he(s.$$.fragment),C(t,"class",i=Le(["svelte-flow__edge",n[22]])),C(t,"data-id",n[0]),C(t,"aria-label",o=n[20]===null?void 0:n[20]?n[20]:`Edge from ${n[1]} to ${n[2]}`),C(t,"role","img"),ke(t,"animated",n[6]),ke(t,"selected",n[7]),ke(t,"selectable",n[24]),Se(e,"z-index",n[5])},m(h,f){Z(h,e,f),x(e,t),s&&ce(s,t,null),a=!0,r||(l=[de(t,"click",n[32]),de(t,"contextmenu",n[41]),de(t,"mouseenter",n[42]),de(t,"mouseleave",n[43])],r=!0)},p(h,f){if(f[0]&134217728&&c!==(c=h[27])){if(s){at();const d=s;G(d.$$.fragment,1,0,()=>{ue(d,1)}),lt()}c?(s=eo(c,u(h)),he(s.$$.fragment),Y(s.$$.fragment,1),ce(s,t,null)):s=null}else if(c){const d={};f[0]&1&&(d.id=h[0]),f[0]&2&&(d.source=h[1]),f[0]&4&&(d.target=h[2]),f[0]&16384&&(d.sourceX=h[14]),f[0]&32768&&(d.sourceY=h[15]),f[0]&65536&&(d.targetX=h[16]),f[0]&131072&&(d.targetY=h[17]),f[0]&262144&&(d.sourcePosition=h[18]),f[0]&524288&&(d.targetPosition=h[19]),f[0]&64&&(d.animated=h[6]),f[0]&128&&(d.selected=h[7]),f[0]&1024&&(d.label=h[10]),f[0]&2048&&(d.labelStyle=h[11]),f[0]&8&&(d.data=h[3]),f[0]&16&&(d.style=h[4]),f[0]&2097152&&(d.interactionWidth=h[21]),f[0]&16777216&&(d.selectable=h[24]),f[0]&256&&(d.deletable=h[8]??!0),f[0]&8388608&&(d.type=h[23]),f[0]&4096&&(d.sourceHandleId=h[12]),f[0]&8192&&(d.targetHandleId=h[13]),f[0]&67108864&&(d.markerStart=h[26]),f[0]&33554432&&(d.markerEnd=h[25]),s.$set(d)}(!a||f[0]&4194304&&i!==(i=Le(["svelte-flow__edge",h[22]])))&&C(t,"class",i),(!a||f[0]&1)&&C(t,"data-id",h[0]),(!a||f[0]&1048582&&o!==(o=h[20]===null?void 0:h[20]?h[20]:`Edge from ${h[1]} to ${h[2]}`))&&C(t,"aria-label",o),(!a||f[0]&4194368)&&ke(t,"animated",h[6]),(!a||f[0]&4194432)&&ke(t,"selected",h[7]),(!a||f[0]&20971520)&&ke(t,"selectable",h[24]),f[0]&32&&Se(e,"z-index",h[5])},i(h){a||(s&&Y(s.$$.fragment,h),a=!0)},o(h){s&&G(s.$$.fragment,h),a=!1},d(h){h&&U(e),s&&ue(s),r=!1,tt(l)}}}function p1(n){let e,t,s=!n[9]&&Jl(n);return{c(){s&&s.c(),e=Ze()},m(i,o){s&&s.m(i,o),Z(i,e,o),t=!0},p(i,o){i[9]?s&&(at(),G(s,1,1,()=>{s=null}),lt()):s?(s.p(i,o),o[0]&512&&Y(s,1)):(s=Jl(i),s.c(),Y(s,1),s.m(e.parentNode,e))},i(i){t||(Y(s),t=!0)},o(i){G(s),t=!1},d(i){i&&U(e),s&&s.d(i)}}}function g1(n,e,t){let s,i,o,a,r,l,c,u,h,{id:f}=e,{type:d="default"}=e,{source:m=""}=e,{target:g=""}=e,{data:_={}}=e,{style:p=void 0}=e,{zIndex:v=void 0}=e,{animated:y=!1}=e,{selected:k=!1}=e,{selectable:b=void 0}=e,{deletable:N=void 0}=e,{hidden:T=!1}=e,{label:S=void 0}=e,{labelStyle:M=void 0}=e,{markerStart:O=void 0}=e,{markerEnd:P=void 0}=e,{sourceHandle:D=void 0}=e,{targetHandle:I=void 0}=e,{sourceX:w}=e,{sourceY:E}=e,{targetX:A}=e,{targetY:R}=e,{sourcePosition:z}=e,{targetPosition:F}=e,{ariaLabel:L=void 0}=e,{interactionWidth:q=void 0}=e,{class:H=""}=e;to("svelteflow__edge_id",f);const{edgeLookup:j,edgeTypes:B,flowId:te,elementsSelectable:re}=ct();ee(n,j,Q=>t(44,l=Q)),ee(n,B,Q=>t(40,h=Q)),ee(n,te,Q=>t(39,u=Q)),ee(n,re,Q=>t(38,c=Q));const J=Io(),ne=fh();function se(Q){const $=l.get(f);$&&(ne(f),J("edgeclick",{event:Q,edge:$}))}function ge(Q,$){const le=l.get(f);le&&J($,{event:Q,edge:le})}const Te=Q=>{ge(Q,"edgecontextmenu")},Ce=Q=>{ge(Q,"edgemouseenter")},ze=Q=>{ge(Q,"edgemouseleave")};return n.$$set=Q=>{"id"in Q&&t(0,f=Q.id),"type"in Q&&t(34,d=Q.type),"source"in Q&&t(1,m=Q.source),"target"in Q&&t(2,g=Q.target),"data"in Q&&t(3,_=Q.data),"style"in Q&&t(4,p=Q.style),"zIndex"in Q&&t(5,v=Q.zIndex),"animated"in Q&&t(6,y=Q.animated),"selected"in Q&&t(7,k=Q.selected),"selectable"in Q&&t(35,b=Q.selectable),"deletable"in Q&&t(8,N=Q.deletable),"hidden"in Q&&t(9,T=Q.hidden),"label"in Q&&t(10,S=Q.label),"labelStyle"in Q&&t(11,M=Q.labelStyle),"markerStart"in Q&&t(36,O=Q.markerStart),"markerEnd"in Q&&t(37,P=Q.markerEnd),"sourceHandle"in Q&&t(12,D=Q.sourceHandle),"targetHandle"in Q&&t(13,I=Q.targetHandle),"sourceX"in Q&&t(14,w=Q.sourceX),"sourceY"in Q&&t(15,E=Q.sourceY),"targetX"in Q&&t(16,A=Q.targetX),"targetY"in Q&&t(17,R=Q.targetY),"sourcePosition"in Q&&t(18,z=Q.sourcePosition),"targetPosition"in Q&&t(19,F=Q.targetPosition),"ariaLabel"in Q&&t(20,L=Q.ariaLabel),"interactionWidth"in Q&&t(21,q=Q.interactionWidth),"class"in Q&&t(22,H=Q.class)},n.$$.update=()=>{n.$$.dirty[1]&8&&t(23,s=d||"default"),n.$$.dirty[0]&8388608|n.$$.dirty[1]&512&&t(27,i=h[s]||dh),n.$$.dirty[1]&288&&t(26,o=O?`url('#${Wr(O,u)}')`:void 0),n.$$.dirty[1]&320&&t(25,a=P?`url('#${Wr(P,u)}')`:void 0),n.$$.dirty[1]&144&&t(24,r=b??c)},[f,m,g,_,p,v,y,k,N,T,S,M,D,I,w,E,A,R,z,F,L,q,H,s,r,a,o,i,j,B,te,re,se,ge,d,b,O,P,c,u,h,Te,Ce,ze]}class _1 extends we{constructor(e){super(),be(this,e,g1,p1,hu,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}const y1=_1;function b1(n,e,t){let{onMount:s=void 0}=e,{onDestroy:i=void 0}=e;return di(()=>(s==null||s(),i)),n.$$set=o=>{"onMount"in o&&t(0,s=o.onMount),"onDestroy"in o&&t(1,i=o.onDestroy)},[s,i]}class w1 extends we{constructor(e){super(),be(this,e,b1,null,ve,{onMount:0,onDestroy:1})}}const v1=w1;function $l(n,e,t){const s=n.slice();return s[2]=e[t],s}function ec(n,e){let t,s,i;const o=[e[2]];let a={};for(let r=0;r<o.length;r+=1)a=Re(a,o[r]);return s=new D1({props:a}),{key:n,first:null,c(){t=Ze(),he(s.$$.fragment),this.first=t},m(r,l){Z(r,t,l),ce(s,r,l),i=!0},p(r,l){e=r;const c=l&1?vn(o,[Es(e[2])]):{};s.$set(c)},i(r){i||(Y(s.$$.fragment,r),i=!0)},o(r){G(s.$$.fragment,r),i=!1},d(r){r&&U(t),ue(s,r)}}}function k1(n){let e,t=[],s=new Map,i,o=Mt(n[0]);const a=r=>r[2].id;for(let r=0;r<o.length;r+=1){let l=$l(n,o,r),c=a(l);s.set(c,t[r]=ec(c,l))}return{c(){e=Pe("defs");for(let r=0;r<t.length;r+=1)t[r].c()},m(r,l){Z(r,e,l);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);i=!0},p(r,[l]){l&1&&(o=Mt(r[0]),at(),t=Ro(t,l,a,1,r,o,s,e,Po,ec,null,$l),lt())},i(r){if(!i){for(let l=0;l<o.length;l+=1)Y(t[l]);i=!0}},o(r){for(let l=0;l<t.length;l+=1)G(t[l]);i=!1},d(r){r&&U(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function T1(n,e,t){let s;const{markers:i}=ct();return ee(n,i,o=>t(0,s=o)),[s,i]}class S1 extends we{constructor(e){super(),be(this,e,T1,k1,ve,{})}}const C1=S1;function A1(n){let e;return{c(){e=Pe("polyline"),C(e,"stroke",n[6]),C(e,"stroke-linecap","round"),C(e,"stroke-linejoin","round"),C(e,"stroke-width",n[7]),C(e,"fill",n[6]),C(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,s){Z(t,e,s)},p(t,s){s&64&&C(e,"stroke",t[6]),s&128&&C(e,"stroke-width",t[7]),s&64&&C(e,"fill",t[6])},d(t){t&&U(e)}}}function N1(n){let e;return{c(){e=Pe("polyline"),C(e,"stroke",n[6]),C(e,"stroke-linecap","round"),C(e,"stroke-linejoin","round"),C(e,"stroke-width",n[7]),C(e,"fill","none"),C(e,"points","-5,-4 0,0 -5,4")},m(t,s){Z(t,e,s)},p(t,s){s&64&&C(e,"stroke",t[6]),s&128&&C(e,"stroke-width",t[7])},d(t){t&&U(e)}}}function E1(n){let e,t,s;function i(r,l){if(r[1]===fo.Arrow)return N1;if(r[1]===fo.ArrowClosed)return A1}let o=i(n),a=o&&o(n);return{c(){e=Pe("marker"),a&&a.c(),C(e,"class","svelte-flow__arrowhead"),C(e,"id",n[0]),C(e,"markerWidth",t=`${n[2]}`),C(e,"markerHeight",s=`${n[3]}`),C(e,"viewBox","-10 -10 20 20"),C(e,"markerUnits",n[4]),C(e,"orient",n[5]),C(e,"refX","0"),C(e,"refY","0")},m(r,l){Z(r,e,l),a&&a.m(e,null)},p(r,[l]){o===(o=i(r))&&a?a.p(r,l):(a&&a.d(1),a=o&&o(r),a&&(a.c(),a.m(e,null))),l&1&&C(e,"id",r[0]),l&4&&t!==(t=`${r[2]}`)&&C(e,"markerWidth",t),l&8&&s!==(s=`${r[3]}`)&&C(e,"markerHeight",s),l&16&&C(e,"markerUnits",r[4]),l&32&&C(e,"orient",r[5])},i:pe,o:pe,d(r){r&&U(e),a&&a.d()}}}function M1(n,e,t){let{id:s}=e,{type:i}=e,{width:o=12.5}=e,{height:a=12.5}=e,{markerUnits:r="strokeWidth"}=e,{orient:l="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:u=void 0}=e;return n.$$set=h=>{"id"in h&&t(0,s=h.id),"type"in h&&t(1,i=h.type),"width"in h&&t(2,o=h.width),"height"in h&&t(3,a=h.height),"markerUnits"in h&&t(4,r=h.markerUnits),"orient"in h&&t(5,l=h.orient),"color"in h&&t(6,c=h.color),"strokeWidth"in h&&t(7,u=h.strokeWidth)},[s,i,o,a,r,l,c,u]}class O1 extends we{constructor(e){super(),be(this,e,M1,E1,ve,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}const D1=O1;function tc(n,e,t){const s=n.slice();return s[14]=e[t],s}function nc(n,e){let t,s,i;return s=new y1({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),s.$on("edgeclick",e[7]),s.$on("edgecontextmenu",e[8]),s.$on("edgemouseenter",e[9]),s.$on("edgemouseleave",e[10]),{key:n,first:null,c(){t=Ze(),he(s.$$.fragment),this.first=t},m(o,a){Z(o,t,a),ce(s,o,a),i=!0},p(o,a){e=o;const r={};a&1&&(r.id=e[14].id),a&1&&(r.source=e[14].source),a&1&&(r.target=e[14].target),a&1&&(r.data=e[14].data),a&1&&(r.style=e[14].style),a&1&&(r.animated=e[14].animated),a&1&&(r.selected=e[14].selected),a&3&&(r.selectable=e[14].selectable??e[1]),a&1&&(r.deletable=e[14].deletable),a&1&&(r.hidden=e[14].hidden),a&1&&(r.label=e[14].label),a&1&&(r.labelStyle=e[14].labelStyle),a&1&&(r.markerStart=e[14].markerStart),a&1&&(r.markerEnd=e[14].markerEnd),a&1&&(r.sourceHandle=e[14].sourceHandle),a&1&&(r.targetHandle=e[14].targetHandle),a&1&&(r.sourceX=e[14].sourceX),a&1&&(r.sourceY=e[14].sourceY),a&1&&(r.targetX=e[14].targetX),a&1&&(r.targetY=e[14].targetY),a&1&&(r.sourcePosition=e[14].sourcePosition),a&1&&(r.targetPosition=e[14].targetPosition),a&1&&(r.ariaLabel=e[14].ariaLabel),a&1&&(r.interactionWidth=e[14].interactionWidth),a&1&&(r.class=e[14].class),a&1&&(r.type=e[14].type||"default"),a&1&&(r.zIndex=e[14].zIndex),s.$set(r)},i(o){i||(Y(s.$$.fragment,o),i=!0)},o(o){G(s.$$.fragment,o),i=!1},d(o){o&&U(t),ue(s,o)}}}function sc(n){let e,t;return e=new v1({props:{onMount:n[11],onDestroy:n[12]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i&4&&(o.onMount=s[11]),i&4&&(o.onDestroy=s[12]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function I1(n){let e,t,s,i,o=[],a=new Map,r,l;s=new C1({});let c=Mt(n[0]);const u=f=>f[14].id;for(let f=0;f<c.length;f+=1){let d=tc(n,c,f),m=u(d);a.set(m,o[f]=nc(m,d))}let h=n[0].length>0&&sc(n);return{c(){e=X("div"),t=Pe("svg"),he(s.$$.fragment),i=K();for(let f=0;f<o.length;f+=1)o[f].c();r=K(),h&&h.c(),C(t,"class","svelte-flow__marker"),C(e,"class","svelte-flow__edges")},m(f,d){Z(f,e,d),x(e,t),ce(s,t,null),x(e,i);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(e,null);x(e,r),h&&h.m(e,null),l=!0},p(f,[d]){d&3&&(c=Mt(f[0]),at(),o=Ro(o,d,u,1,f,c,a,e,Po,nc,r,tc),lt()),f[0].length>0?h?(h.p(f,d),d&1&&Y(h,1)):(h=sc(f),h.c(),Y(h,1),h.m(e,null)):h&&(at(),G(h,1,1,()=>{h=null}),lt())},i(f){if(!l){Y(s.$$.fragment,f);for(let d=0;d<c.length;d+=1)Y(o[d]);Y(h),l=!0}},o(f){G(s.$$.fragment,f);for(let d=0;d<o.length;d+=1)G(o[d]);G(h),l=!1},d(f){f&&U(e),ue(s);for(let d=0;d<o.length;d+=1)o[d].d();h&&h.d()}}}function P1(n,e,t){let s,i,o,{defaultEdgeOptions:a}=e;const{visibleEdges:r,edgesInitialized:l,edges:{setDefaultOptions:c},elementsSelectable:u}=ct();ee(n,r,p=>t(0,s=p)),ee(n,l,p=>t(2,o=p)),ee(n,u,p=>t(1,i=p)),di(()=>{a&&c(a)});function h(p){De.call(this,n,p)}function f(p){De.call(this,n,p)}function d(p){De.call(this,n,p)}function m(p){De.call(this,n,p)}const g=()=>{$i(l,o=!0,o)},_=()=>{$i(l,o=!1,o)};return n.$$set=p=>{"defaultEdgeOptions"in p&&t(6,a=p.defaultEdgeOptions)},[s,i,o,r,l,u,a,h,f,d,m,g,_]}class R1 extends we{constructor(e){super(),be(this,e,P1,I1,ve,{defaultEdgeOptions:6})}}const x1=R1;function ic(n){let e;return{c(){e=X("div"),C(e,"class","svelte-flow__selection svelte-1iugwpu"),Se(e,"width",typeof n[2]=="string"?n[2]:`${n[2]}px`),Se(e,"height",typeof n[3]=="string"?n[3]:`${n[3]}px`),Se(e,"transform",`translate(${n[0]}px, ${n[1]}px)`)},m(t,s){Z(t,e,s)},p(t,s){s&4&&Se(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),s&8&&Se(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),s&3&&Se(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&U(e)}}}function V1(n){let e,t=n[4]&&ic(n);return{c(){t&&t.c(),e=Ze()},m(s,i){t&&t.m(s,i),Z(s,e,i)},p(s,[i]){s[4]?t?t.p(s,i):(t=ic(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:pe,o:pe,d(s){s&&U(e),t&&t.d(s)}}}function F1(n,e,t){let{x:s=0}=e,{y:i=0}=e,{width:o=0}=e,{height:a=0}=e,{isVisible:r=!0}=e;return n.$$set=l=>{"x"in l&&t(0,s=l.x),"y"in l&&t(1,i=l.y),"width"in l&&t(2,o=l.width),"height"in l&&t(3,a=l.height),"isVisible"in l&&t(4,r=l.isVisible)},[s,i,o,a,r]}class z1 extends we{constructor(e){super(),be(this,e,F1,V1,ve,{x:0,y:1,width:2,height:3,isVisible:4})}}const _h=z1;function W1(n){var s,i,o,a;let e,t;return e=new _h({props:{isVisible:!!(n[0]&&n[1]==="user"),width:(s=n[0])==null?void 0:s.width,height:(i=n[0])==null?void 0:i.height,x:(o=n[0])==null?void 0:o.x,y:(a=n[0])==null?void 0:a.y}}),{c(){he(e.$$.fragment)},m(r,l){ce(e,r,l),t=!0},p(r,[l]){var u,h,f,d;const c={};l&3&&(c.isVisible=!!(r[0]&&r[1]==="user")),l&1&&(c.width=(u=r[0])==null?void 0:u.width),l&1&&(c.height=(h=r[0])==null?void 0:h.height),l&1&&(c.x=(f=r[0])==null?void 0:f.x),l&1&&(c.y=(d=r[0])==null?void 0:d.y),e.$set(c)},i(r){t||(Y(e.$$.fragment,r),t=!0)},o(r){G(e.$$.fragment,r),t=!1},d(r){ue(e,r)}}}function L1(n,e,t){let s,i;const{selectionRect:o,selectionRectMode:a}=ct();return ee(n,o,r=>t(0,s=r)),ee(n,a,r=>t(1,i=r)),[s,i,o,a]}class q1 extends we{constructor(e){super(),be(this,e,L1,W1,ve,{})}}const B1=q1;function oc(n){let e,t,s,i,o;return t=new _h({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=X("div"),he(t.$$.fragment),C(e,"class","selection-wrapper nopan svelte-5pxri"),Se(e,"width",n[1].width+"px"),Se(e,"height",n[1].height+"px"),Se(e,"transform","translate("+n[1].x+"px, "+n[1].y+"px)"),C(e,"role","button"),C(e,"tabindex","-1")},m(a,r){Z(a,e,r),ce(t,e,null),s=!0,i||(o=[yt(gh.call(null,e,{disabled:!1,store:n[2],onDrag:n[11],onDragStart:n[12],onDragStop:n[13]})),de(e,"contextmenu",n[7]),de(e,"click",n[8]),de(e,"keyup",X1)],i=!0)},p(a,r){(!s||r&2)&&Se(e,"width",a[1].width+"px"),(!s||r&2)&&Se(e,"height",a[1].height+"px"),(!s||r&2)&&Se(e,"transform","translate("+a[1].x+"px, "+a[1].y+"px)")},i(a){s||(Y(t.$$.fragment,a),s=!0)},o(a){G(t.$$.fragment,a),s=!1},d(a){a&&U(e),ue(t),i=!1,tt(o)}}}function H1(n){let e=n[0]==="nodes"&&n[1]&&Yn(n[1].x)&&Yn(n[1].y),t,s,i=e&&oc(n);return{c(){i&&i.c(),t=Ze()},m(o,a){i&&i.m(o,a),Z(o,t,a),s=!0},p(o,[a]){a&3&&(e=o[0]==="nodes"&&o[1]&&Yn(o[1].x)&&Yn(o[1].y)),e?i?(i.p(o,a),a&3&&Y(i,1)):(i=oc(o),i.c(),Y(i,1),i.m(t.parentNode,t)):i&&(at(),G(i,1,1,()=>{i=null}),lt())},i(o){s||(Y(i),s=!0)},o(o){G(i),s=!1},d(o){o&&U(t),i&&i.d(o)}}}const X1=()=>{};function Y1(n,e,t){let s,i,o;const a=ct(),{selectionRectMode:r,nodes:l,nodeLookup:c}=a;ee(n,r,p=>t(0,o=p)),ee(n,l,p=>t(9,s=p)),ee(n,c,p=>t(10,i=p));const u=Io();let h=null;function f(p){const v=s.filter(y=>y.selected);u("selectioncontextmenu",{nodes:v,event:p})}function d(p){const v=s.filter(y=>y.selected);u("selectionclick",{nodes:v,event:p})}const m=(p,v,y,k)=>{u("nodedrag",{event:p,targetNode:null,nodes:k})},g=(p,v,y,k)=>{u("nodedragstart",{event:p,targetNode:null,nodes:k})},_=(p,v,y,k)=>{u("nodedragstop",{event:p,targetNode:null,nodes:k})};return n.$$.update=()=>{n.$$.dirty&1537&&o==="nodes"&&t(1,h=_i(i,{filter:p=>!!p.selected}))},[o,h,a,r,l,c,u,f,d,s,i,m,g,_]}class j1 extends we{constructor(e){super(),be(this,e,Y1,H1,ve,{})}}const U1=j1;function on(n,e){let{enabled:t=!0,trigger:s,type:i="keydown"}=e;function o(a){const r=Array.isArray(s)?s:[s],l={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey,meta:a.metaKey};for(const c of r){const u={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:h,key:f,callback:d,preventDefault:m,enabled:g}=u;if(g){if(h.length&&!(Array.isArray(h)?h:[h]).map(v=>typeof v=="string"?[v]:v).some(v=>v.every(y=>l[y])))continue;if(a.key===f){m&&a.preventDefault();const _={node:n,trigger:u,originalEvent:a};n.dispatchEvent(new CustomEvent("shortcut",{detail:_})),d==null||d(_)}}}}return t&&n.addEventListener(i,o),{update:a=>{const{enabled:r=!0,type:l="keydown"}=a;t&&(!r||i!==l)?n.removeEventListener(i,o):!t&&r&&n.addEventListener(l,o),t=r,i=l,s=a.trigger},destroy:()=>{n.removeEventListener(i,o)}}}function G1(n){let e,t,s,i,o,a,r,l,c,u,h,f;return{c:pe,m(d,m){h||(f=[yt(e=on.call(null,window,{trigger:it(n[0],n[11]),type:"keydown"})),yt(t=on.call(null,window,{trigger:it(n[0],n[12]),type:"keyup"})),yt(s=on.call(null,window,{trigger:it(n[1],n[13]),type:"keydown"})),yt(i=on.call(null,window,{trigger:it(n[1],n[14]),type:"keyup"})),yt(o=on.call(null,window,{trigger:it(n[2],n[15]),type:"keydown"})),yt(a=on.call(null,window,{trigger:it(n[2],n[16]),type:"keyup"})),yt(r=on.call(null,window,{trigger:it(n[3],n[17]),type:"keydown"})),yt(l=on.call(null,window,{trigger:it(n[3],n[18]),type:"keyup"})),yt(c=on.call(null,window,{trigger:it(n[4],n[19]),type:"keydown"})),yt(u=on.call(null,window,{trigger:it(n[4],n[20]),type:"keyup"})),de(window,"blur",n[10]),de(window,"contextmenu",n[10])],h=!0)},p(d,[m]){e&&Ye(e.update)&&m&1&&e.update.call(null,{trigger:it(d[0],d[11]),type:"keydown"}),t&&Ye(t.update)&&m&1&&t.update.call(null,{trigger:it(d[0],d[12]),type:"keyup"}),s&&Ye(s.update)&&m&2&&s.update.call(null,{trigger:it(d[1],d[13]),type:"keydown"}),i&&Ye(i.update)&&m&2&&i.update.call(null,{trigger:it(d[1],d[14]),type:"keyup"}),o&&Ye(o.update)&&m&4&&o.update.call(null,{trigger:it(d[2],d[15]),type:"keydown"}),a&&Ye(a.update)&&m&4&&a.update.call(null,{trigger:it(d[2],d[16]),type:"keyup"}),r&&Ye(r.update)&&m&8&&r.update.call(null,{trigger:it(d[3],d[17]),type:"keydown"}),l&&Ye(l.update)&&m&8&&l.update.call(null,{trigger:it(d[3],d[18]),type:"keyup"}),c&&Ye(c.update)&&m&16&&c.update.call(null,{trigger:it(d[4],d[19]),type:"keydown"}),u&&Ye(u.update)&&m&16&&u.update.call(null,{trigger:it(d[4],d[20]),type:"keyup"})},i:pe,o:pe,d(d){h=!1,tt(f)}}}function yh(n){return n!==null&&typeof n=="object"}function Z1(n){return yh(n)?n.modifier||[]:[]}function K1(n){return n==null?"":yh(n)?n.key:n}function it(n,e){return(Array.isArray(n)?n:[n]).map(s=>{const i=K1(s);return{key:i,modifier:Z1(s),enabled:i!==null,callback:e}})}function Q1(n,e,t){let{selectionKey:s="Shift"}=e,{multiSelectionKey:i=mo()?"Meta":"Control"}=e,{deleteKey:o="Backspace"}=e,{panActivationKey:a=" "}=e,{zoomActivationKey:r=mo()?"Meta":"Control"}=e;const{selectionKeyPressed:l,multiselectionKeyPressed:c,deleteKeyPressed:u,panActivationKeyPressed:h,zoomActivationKeyPressed:f,selectionRect:d}=ct();function m(){d.set(null),l.set(!1),c.set(!1),u.set(!1),h.set(!1),f.set(!1)}const g=()=>l.set(!0),_=()=>l.set(!1),p=()=>c.set(!0),v=()=>c.set(!1),y=M=>{!(M.originalEvent.ctrlKey||M.originalEvent.metaKey||M.originalEvent.shiftKey)&&!r_(M.originalEvent)&&u.set(!0)},k=()=>u.set(!1),b=()=>h.set(!0),N=()=>h.set(!1),T=()=>f.set(!0),S=()=>f.set(!1);return n.$$set=M=>{"selectionKey"in M&&t(0,s=M.selectionKey),"multiSelectionKey"in M&&t(1,i=M.multiSelectionKey),"deleteKey"in M&&t(2,o=M.deleteKey),"panActivationKey"in M&&t(3,a=M.panActivationKey),"zoomActivationKey"in M&&t(4,r=M.zoomActivationKey)},[s,i,o,a,r,l,c,u,h,f,m,g,_,p,v,y,k,b,N,T,S]}class J1 extends we{constructor(e){super(),be(this,e,Q1,G1,ve,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const $1=J1,ey=n=>({}),rc=n=>({});function ac(n){let e,t,s,i;const o=n[13].connectionLine,a=Ct(o,n,n[12],rc);let r=!n[2]&&lc(n);return{c(){e=Pe("svg"),t=Pe("g"),a&&a.c(),r&&r.c(),C(t,"class",s=Le(["svelte-flow__connection",Rl(n[3].isValid)])),C(e,"width",n[5]),C(e,"height",n[6]),C(e,"class","svelte-flow__connectionline"),C(e,"style",n[0])},m(l,c){Z(l,e,c),x(e,t),a&&a.m(t,null),r&&r.m(t,null),i=!0},p(l,c){a&&a.p&&(!i||c&4096)&&Nt(a,o,l,l[12],i?At(o,l[12],c,ey):Et(l[12]),rc),l[2]?r&&(r.d(1),r=null):r?r.p(l,c):(r=lc(l),r.c(),r.m(t,null)),(!i||c&8&&s!==(s=Le(["svelte-flow__connection",Rl(l[3].isValid)])))&&C(t,"class",s),(!i||c&32)&&C(e,"width",l[5]),(!i||c&64)&&C(e,"height",l[6]),(!i||c&1)&&C(e,"style",l[0])},i(l){i||(Y(a,l),i=!0)},o(l){G(a,l),i=!1},d(l){l&&U(e),a&&a.d(l),r&&r.d()}}}function lc(n){let e;return{c(){e=Pe("path"),C(e,"d",n[4]),C(e,"style",n[1]),C(e,"fill","none"),C(e,"class","svelte-flow__connection-path")},m(t,s){Z(t,e,s)},p(t,s){s&16&&C(e,"d",t[4]),s&2&&C(e,"style",t[1])},d(t){t&&U(e)}}}function ty(n){let e,t,s=n[3].inProgress&&ac(n);return{c(){s&&s.c(),e=Ze()},m(i,o){s&&s.m(i,o),Z(i,e,o),t=!0},p(i,[o]){i[3].inProgress?s?(s.p(i,o),o&8&&Y(s,1)):(s=ac(i),s.c(),Y(s,1),s.m(e.parentNode,e)):s&&(at(),G(s,1,1,()=>{s=null}),lt())},i(i){t||(Y(s),t=!0)},o(i){G(s),t=!1},d(i){i&&U(e),s&&s.d(i)}}}function ny(n,e,t){let s,i,o,a,{$$slots:r={},$$scope:l}=e,{containerStyle:c=""}=e,{style:u=""}=e,{isCustomComponent:h=!1}=e;const{width:f,height:d,connection:m,connectionLineType:g}=ct();ee(n,f,p=>t(5,o=p)),ee(n,d,p=>t(6,a=p)),ee(n,m,p=>t(3,i=p)),ee(n,g,p=>t(11,s=p));let _=null;return n.$$set=p=>{"containerStyle"in p&&t(0,c=p.containerStyle),"style"in p&&t(1,u=p.style),"isCustomComponent"in p&&t(2,h=p.isCustomComponent),"$$scope"in p&&t(12,l=p.$$scope)},n.$$.update=()=>{if(n.$$.dirty&2060&&i.inProgress&&!h){const{from:p,to:v,fromPosition:y,toPosition:k}=i,b={sourceX:p.x,sourceY:p.y,sourcePosition:y,targetX:v.x,targetY:v.y,targetPosition:k};switch(s){case Ss.Bezier:t(4,[_]=Ju(b),_);break;case Ss.Step:t(4,[_]=go({...b,borderRadius:0}),_);break;case Ss.SmoothStep:t(4,[_]=go(b),_);break;default:t(4,[_]=eh(b),_)}}},[c,u,h,i,_,o,a,f,d,m,g,s,l,r]}class sy extends we{constructor(e){super(),be(this,e,ny,ty,ve,{containerStyle:0,style:1,isCustomComponent:2})}}const iy=sy;function oy(n){let e,t,s;const i=n[8].default,o=Ct(i,n,n[7],null);let a=[{class:t=Le(["svelte-flow__panel",n[1],...n[2]])},{style:n[0]},n[5]],r={};for(let l=0;l<a.length;l+=1)r=Re(r,a[l]);return{c(){e=X("div"),o&&o.c(),Ns(e,r),Se(e,"pointer-events",n[3]?"none":"")},m(l,c){Z(l,e,c),o&&o.m(e,null),s=!0},p(l,[c]){o&&o.p&&(!s||c&128)&&Nt(o,i,l,l[7],s?At(i,l[7],c,null):Et(l[7]),null),Ns(e,r=vn(a,[(!s||c&6&&t!==(t=Le(["svelte-flow__panel",l[1],...l[2]])))&&{class:t},(!s||c&1)&&{style:l[0]},c&32&&l[5]])),Se(e,"pointer-events",l[3]?"none":"")},i(l){s||(Y(o,l),s=!0)},o(l){G(o,l),s=!1},d(l){l&&U(e),o&&o.d(l)}}}function ry(n,e,t){let s;const i=["position","style","class"];let o=$e(e,i),a,{$$slots:r={},$$scope:l}=e,{position:c="top-right"}=e,{style:u=void 0}=e,{class:h=void 0}=e;const{selectionRectMode:f}=ct();return ee(n,f,d=>t(3,a=d)),n.$$set=d=>{e=Re(Re({},e),Qt(d)),t(5,o=$e(e,i)),"position"in d&&t(6,c=d.position),"style"in d&&t(0,u=d.style),"class"in d&&t(1,h=d.class),"$$scope"in d&&t(7,l=d.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(2,s=`${c}`.split("-"))},[u,h,s,a,f,o,c,l,r]}class ay extends we{constructor(e){super(),be(this,e,ry,oy,ve,{position:6,style:0,class:1})}}const da=ay;function cc(n){let e,t;return e=new da({props:{position:n[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[ly]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i&2&&(o.position=s[1]),i&4&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function ly(n){let e;return{c(){e=X("a"),e.textContent="Svelte Flow",C(e,"href","https://svelteflow.dev"),C(e,"target","_blank"),C(e,"rel","noopener noreferrer"),C(e,"aria-label","Svelte Flow attribution")},m(t,s){Z(t,e,s)},p:pe,d(t){t&&U(e)}}}function cy(n){var i;let e,t,s=!((i=n[0])!=null&&i.hideAttribution)&&cc(n);return{c(){s&&s.c(),e=Ze()},m(o,a){s&&s.m(o,a),Z(o,e,a),t=!0},p(o,[a]){var r;(r=o[0])!=null&&r.hideAttribution?s&&(at(),G(s,1,1,()=>{s=null}),lt()):s?(s.p(o,a),a&1&&Y(s,1)):(s=cc(o),s.c(),Y(s,1),s.m(e.parentNode,e))},i(o){t||(Y(s),t=!0)},o(o){G(s),t=!1},d(o){o&&U(e),s&&s.d(o)}}}function uy(n,e,t){let{proOptions:s=void 0}=e,{position:i="bottom-right"}=e;return n.$$set=o=>{"proOptions"in o&&t(0,s=o.proOptions),"position"in o&&t(1,i=o.position)},[s,i]}class hy extends we{constructor(e){super(),be(this,e,uy,cy,ve,{proOptions:0,position:1})}}const fy=hy;function uc(n,{nodeTypes:e,edgeTypes:t,minZoom:s,maxZoom:i,translateExtent:o,paneClickDistance:a}){e!==void 0&&n.setNodeTypes(e),t!==void 0&&n.setEdgeTypes(t),s!==void 0&&n.setMinZoom(s),i!==void 0&&n.setMaxZoom(i),o!==void 0&&n.setTranslateExtent(o),a!==void 0&&n.setPaneClickDistance(a)}const dy=n=>Object.keys(n);function my(n,e){dy(e).forEach(t=>{const s=e[t];s!==void 0&&n[t].set(s)})}function py(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function gy(n="light"){return Wt("light",t=>{if(n!=="system"){t(n);return}const s=py(),i=()=>t(s!=null&&s.matches?"dark":"light");return t(s!=null&&s.matches?"dark":"light"),s==null||s.addEventListener("change",i),()=>{s==null||s.removeEventListener("change",i)}})}const _y=n=>({}),hc=n=>({slot:"connectionLine"});function yy(n){let e;const t=n[75].connectionLine,s=Ct(t,n,n[99],hc);return{c(){s&&s.c()},m(i,o){s&&s.m(i,o),e=!0},p(i,o){s&&s.p&&(!e||o[3]&64)&&Nt(s,t,i,i[99],e?At(t,i[99],o,_y):Et(i[99]),hc)},i(i){e||(Y(s,i),e=!0)},o(i){G(s,i),e=!1},d(i){s&&s.d(i)}}}function by(n){let e,t,s,i,o,a,r,l,c,u,h,f;return e=new x1({props:{defaultEdgeOptions:n[21]}}),e.$on("edgeclick",n[78]),e.$on("edgecontextmenu",n[79]),e.$on("edgemouseenter",n[80]),e.$on("edgemouseleave",n[81]),s=new iy({props:{containerStyle:n[7],style:n[6],isCustomComponent:n[34].connectionLine,$$slots:{connectionLine:[yy]},$$scope:{ctx:n}}}),c=new m1({props:{nodeClickDistance:n[23]}}),c.$on("nodeclick",n[82]),c.$on("nodemouseenter",n[83]),c.$on("nodemousemove",n[84]),c.$on("nodemouseleave",n[85]),c.$on("nodedragstart",n[86]),c.$on("nodedrag",n[87]),c.$on("nodedragstop",n[88]),c.$on("nodecontextmenu",n[89]),h=new U1({}),h.$on("selectionclick",n[90]),h.$on("selectioncontextmenu",n[91]),h.$on("nodedragstart",n[92]),h.$on("nodedrag",n[93]),h.$on("nodedragstop",n[94]),{c(){he(e.$$.fragment),t=K(),he(s.$$.fragment),i=K(),o=X("div"),a=K(),r=X("div"),l=K(),he(c.$$.fragment),u=K(),he(h.$$.fragment),C(o,"class","svelte-flow__edgelabel-renderer"),C(r,"class","svelte-flow__viewport-portal")},m(d,m){ce(e,d,m),Z(d,t,m),ce(s,d,m),Z(d,i,m),Z(d,o,m),Z(d,a,m),Z(d,r,m),Z(d,l,m),ce(c,d,m),Z(d,u,m),ce(h,d,m),f=!0},p(d,m){const g={};m[0]&2097152&&(g.defaultEdgeOptions=d[21]),e.$set(g);const _={};m[0]&128&&(_.containerStyle=d[7]),m[0]&64&&(_.style=d[6]),m[1]&8&&(_.isCustomComponent=d[34].connectionLine),m[3]&64&&(_.$$scope={dirty:m,ctx:d}),s.$set(_);const p={};m[0]&8388608&&(p.nodeClickDistance=d[23]),c.$set(p)},i(d){f||(Y(e.$$.fragment,d),Y(s.$$.fragment,d),Y(c.$$.fragment,d),Y(h.$$.fragment,d),f=!0)},o(d){G(e.$$.fragment,d),G(s.$$.fragment,d),G(c.$$.fragment,d),G(h.$$.fragment,d),f=!1},d(d){d&&(U(t),U(i),U(o),U(a),U(r),U(l),U(u)),ue(e,d),ue(s,d),ue(c,d),ue(h,d)}}}function wy(n){let e,t,s,i;return e=new i1({props:{$$slots:{default:[by]},$$scope:{ctx:n}}}),s=new B1({}),{c(){he(e.$$.fragment),t=K(),he(s.$$.fragment)},m(o,a){ce(e,o,a),Z(o,t,a),ce(s,o,a),i=!0},p(o,a){const r={};a[0]&10485952|a[1]&8|a[3]&64&&(r.$$scope={dirty:a,ctx:o}),e.$set(r)},i(o){i||(Y(e.$$.fragment,o),Y(s.$$.fragment,o),i=!0)},o(o){G(e.$$.fragment,o),G(s.$$.fragment,o),i=!1},d(o){o&&U(t),ue(e,o),ue(s,o)}}}function vy(n){let e,t;return e=new e1({props:{panOnDrag:n[17]===void 0?!0:n[17],selectionOnDrag:n[18],$$slots:{default:[wy]},$$scope:{ctx:n}}}),e.$on("paneclick",n[95]),e.$on("panecontextmenu",n[96]),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i[0]&131072&&(o.panOnDrag=s[17]===void 0?!0:s[17]),i[0]&262144&&(o.selectionOnDrag=s[18]),i[0]&10485952|i[1]&8|i[3]&64&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function ky(n){let e,t,s,i,o,a,r,l,c,u,h,f;t=new $1({props:{selectionKey:n[1],deleteKey:n[5],panActivationKey:n[2],multiSelectionKey:n[3],zoomActivationKey:n[4]}}),i=new K0({props:{initialViewport:n[31],onMoveStart:n[8],onMove:n[9],onMoveEnd:n[10],panOnScrollMode:n[11]===void 0?an.Free:n[11],preventScrolling:n[12]===void 0?!0:n[12],zoomOnScroll:n[13]===void 0?!0:n[13],zoomOnDoubleClick:n[14]===void 0?!0:n[14],zoomOnPinch:n[15]===void 0?!0:n[15],panOnScroll:n[16]===void 0?!1:n[16],panOnDrag:n[17]===void 0?!0:n[17],paneClickDistance:n[22]===void 0?0:n[22],$$slots:{default:[vy]},$$scope:{ctx:n}}}),a=new fy({props:{proOptions:n[20],position:n[19]}});const d=n[75].default,m=Ct(d,n,n[99],null);let g=[{style:n[24]},{class:l=Le(["svelte-flow",n[25],n[30]])},{"data-testid":"svelte-flow__wrapper"},n[33],{role:"application"}],_={};for(let p=0;p<g.length;p+=1)_=Re(_,g[p]);return{c(){e=X("div"),he(t.$$.fragment),s=K(),he(i.$$.fragment),o=K(),he(a.$$.fragment),r=K(),m&&m.c(),Ns(e,_),so(()=>n[98].call(e)),ke(e,"svelte-18e9ir1",!0)},m(p,v){Z(p,e,v),ce(t,e,null),x(e,s),ce(i,e,null),x(e,o),ce(a,e,null),x(e,r),m&&m.m(e,null),n[97](e),c=ld(e,n[98].bind(e)),u=!0,h||(f=[de(e,"dragover",n[76]),de(e,"drop",n[77])],h=!0)},p(p,v){const y={};v[0]&2&&(y.selectionKey=p[1]),v[0]&32&&(y.deleteKey=p[5]),v[0]&4&&(y.panActivationKey=p[2]),v[0]&8&&(y.multiSelectionKey=p[3]),v[0]&16&&(y.zoomActivationKey=p[4]),t.$set(y);const k={};v[0]&256&&(k.onMoveStart=p[8]),v[0]&512&&(k.onMove=p[9]),v[0]&1024&&(k.onMoveEnd=p[10]),v[0]&2048&&(k.panOnScrollMode=p[11]===void 0?an.Free:p[11]),v[0]&4096&&(k.preventScrolling=p[12]===void 0?!0:p[12]),v[0]&8192&&(k.zoomOnScroll=p[13]===void 0?!0:p[13]),v[0]&16384&&(k.zoomOnDoubleClick=p[14]===void 0?!0:p[14]),v[0]&32768&&(k.zoomOnPinch=p[15]===void 0?!0:p[15]),v[0]&65536&&(k.panOnScroll=p[16]===void 0?!1:p[16]),v[0]&131072&&(k.panOnDrag=p[17]===void 0?!0:p[17]),v[0]&4194304&&(k.paneClickDistance=p[22]===void 0?0:p[22]),v[0]&10879168|v[1]&8|v[3]&64&&(k.$$scope={dirty:v,ctx:p}),i.$set(k);const b={};v[0]&1048576&&(b.proOptions=p[20]),v[0]&524288&&(b.position=p[19]),a.$set(b),m&&m.p&&(!u||v[3]&64)&&Nt(m,d,p,p[99],u?At(d,p[99],v,null):Et(p[99]),null),Ns(e,_=vn(g,[(!u||v[0]&16777216)&&{style:p[24]},(!u||v[0]&1107296256&&l!==(l=Le(["svelte-flow",p[25],p[30]])))&&{class:l},{"data-testid":"svelte-flow__wrapper"},v[1]&4&&p[33],{role:"application"}])),ke(e,"svelte-18e9ir1",!0)},i(p){u||(Y(t.$$.fragment,p),Y(i.$$.fragment,p),Y(a.$$.fragment,p),Y(m,p),u=!0)},o(p){G(t.$$.fragment,p),G(i.$$.fragment,p),G(a.$$.fragment,p),G(m,p),u=!1},d(p){p&&U(e),ue(t),ue(i),ue(a),m&&m.d(p),n[97](null),c(),h=!1,tt(f)}}}function Ty(n,e,t){let s;const i=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let o=$e(e,i),a,r,l=pe,c=()=>(l(),l=$s(S,V=>t(100,r=V)),S),u,h=pe,f=()=>(h(),h=$s(s,V=>t(30,u=V)),s);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>h());let{$$slots:d={},$$scope:m}=e;const g=nd(d);let{id:_="1"}=e,{nodes:p}=e,{edges:v}=e,{fitView:y=void 0}=e,{fitViewOptions:k=void 0}=e,{minZoom:b=void 0}=e,{maxZoom:N=void 0}=e,{initialViewport:T=void 0}=e,{viewport:S=void 0}=e;c();let{nodeTypes:M=void 0}=e,{edgeTypes:O=void 0}=e,{selectionKey:P=void 0}=e,{selectionMode:D=void 0}=e,{panActivationKey:I=void 0}=e,{multiSelectionKey:w=void 0}=e,{zoomActivationKey:E=void 0}=e,{nodesDraggable:A=void 0}=e,{nodesConnectable:R=void 0}=e,{nodeDragThreshold:z=void 0}=e,{elementsSelectable:F=void 0}=e,{snapGrid:L=void 0}=e,{deleteKey:q=void 0}=e,{connectionRadius:H=void 0}=e,{connectionLineType:j=void 0}=e,{connectionMode:B=Gn.Strict}=e,{connectionLineStyle:te=""}=e,{connectionLineContainerStyle:re=""}=e,{onMoveStart:J=void 0}=e,{onMove:ne=void 0}=e,{onMoveEnd:se=void 0}=e,{isValidConnection:ge=void 0}=e,{translateExtent:Te=void 0}=e,{nodeExtent:Ce=void 0}=e,{onlyRenderVisibleElements:ze=void 0}=e,{panOnScrollMode:Q=an.Free}=e,{preventScrolling:$=!0}=e,{zoomOnScroll:le=!0}=e,{zoomOnDoubleClick:Oe=!0}=e,{zoomOnPinch:_e=!0}=e,{panOnScroll:Ae=!1}=e,{panOnDrag:Ee=!0}=e,{selectionOnDrag:Ke=void 0}=e,{autoPanOnConnect:ie=!0}=e,{autoPanOnNodeDrag:kt=!0}=e,{onerror:Ft=void 0}=e,{ondelete:nn=void 0}=e,{onedgecreate:pn=void 0}=e,{attributionPosition:Xt=void 0}=e,{proOptions:sn=void 0}=e,{defaultEdgeOptions:W=void 0}=e,{width:zt=void 0}=e,{height:st=void 0}=e,{colorMode:et="light"}=e,{onconnect:ss=void 0}=e,{onconnectstart:is=void 0}=e,{onconnectend:os=void 0}=e,{onbeforedelete:rs=void 0}=e,{oninit:En=void 0}=e,{nodeOrigin:qn=void 0}=e,{paneClickDistance:Ii=0}=e,{nodeClickDistance:ol=0}=e,{defaultMarkerColor:hr="#b1b1b7"}=e,{style:rl=void 0}=e,{class:al=void 0}=e,Pi,as,ls;const Mf=r||T,_t=ud(fa)?ct():Y0({nodes:oe(p),edges:oe(v),width:zt,height:st,fitView:y,nodeOrigin:qn,nodeExtent:Ce});di(()=>(_t.width.set(as),_t.height.set(ls),_t.domNode.set(Pi),_t.syncNodeStores(p),_t.syncEdgeStores(v),_t.syncViewport(S),y!==void 0&&_t.fitViewQueued.set(y),k&&_t.fitViewOptions.set(k),uc(_t,{nodeTypes:M,edgeTypes:O,minZoom:b,maxZoom:N,translateExtent:Te,paneClickDistance:Ii}),()=>{_t.reset()}));const{initialized:ll}=_t;ee(n,ll,V=>t(74,a=V));let fr=!1;function Of(V){De.call(this,n,V)}function Df(V){De.call(this,n,V)}function If(V){De.call(this,n,V)}function Pf(V){De.call(this,n,V)}function Rf(V){De.call(this,n,V)}function xf(V){De.call(this,n,V)}function Vf(V){De.call(this,n,V)}function Ff(V){De.call(this,n,V)}function zf(V){De.call(this,n,V)}function Wf(V){De.call(this,n,V)}function Lf(V){De.call(this,n,V)}function qf(V){De.call(this,n,V)}function Bf(V){De.call(this,n,V)}function Hf(V){De.call(this,n,V)}function Xf(V){De.call(this,n,V)}function Yf(V){De.call(this,n,V)}function jf(V){De.call(this,n,V)}function Uf(V){De.call(this,n,V)}function Gf(V){De.call(this,n,V)}function Zf(V){De.call(this,n,V)}function Kf(V){De.call(this,n,V)}function Qf(V){ti[V?"unshift":"push"](()=>{Pi=V,t(28,Pi)})}function Jf(){as=this.clientWidth,ls=this.clientHeight,t(26,as),t(27,ls)}return n.$$set=V=>{e=Re(Re({},e),Qt(V)),t(33,o=$e(e,i)),"id"in V&&t(35,_=V.id),"nodes"in V&&t(36,p=V.nodes),"edges"in V&&t(37,v=V.edges),"fitView"in V&&t(38,y=V.fitView),"fitViewOptions"in V&&t(39,k=V.fitViewOptions),"minZoom"in V&&t(40,b=V.minZoom),"maxZoom"in V&&t(41,N=V.maxZoom),"initialViewport"in V&&t(42,T=V.initialViewport),"viewport"in V&&c(t(0,S=V.viewport)),"nodeTypes"in V&&t(43,M=V.nodeTypes),"edgeTypes"in V&&t(44,O=V.edgeTypes),"selectionKey"in V&&t(1,P=V.selectionKey),"selectionMode"in V&&t(45,D=V.selectionMode),"panActivationKey"in V&&t(2,I=V.panActivationKey),"multiSelectionKey"in V&&t(3,w=V.multiSelectionKey),"zoomActivationKey"in V&&t(4,E=V.zoomActivationKey),"nodesDraggable"in V&&t(46,A=V.nodesDraggable),"nodesConnectable"in V&&t(47,R=V.nodesConnectable),"nodeDragThreshold"in V&&t(48,z=V.nodeDragThreshold),"elementsSelectable"in V&&t(49,F=V.elementsSelectable),"snapGrid"in V&&t(50,L=V.snapGrid),"deleteKey"in V&&t(5,q=V.deleteKey),"connectionRadius"in V&&t(51,H=V.connectionRadius),"connectionLineType"in V&&t(52,j=V.connectionLineType),"connectionMode"in V&&t(53,B=V.connectionMode),"connectionLineStyle"in V&&t(6,te=V.connectionLineStyle),"connectionLineContainerStyle"in V&&t(7,re=V.connectionLineContainerStyle),"onMoveStart"in V&&t(8,J=V.onMoveStart),"onMove"in V&&t(9,ne=V.onMove),"onMoveEnd"in V&&t(10,se=V.onMoveEnd),"isValidConnection"in V&&t(54,ge=V.isValidConnection),"translateExtent"in V&&t(55,Te=V.translateExtent),"nodeExtent"in V&&t(56,Ce=V.nodeExtent),"onlyRenderVisibleElements"in V&&t(57,ze=V.onlyRenderVisibleElements),"panOnScrollMode"in V&&t(11,Q=V.panOnScrollMode),"preventScrolling"in V&&t(12,$=V.preventScrolling),"zoomOnScroll"in V&&t(13,le=V.zoomOnScroll),"zoomOnDoubleClick"in V&&t(14,Oe=V.zoomOnDoubleClick),"zoomOnPinch"in V&&t(15,_e=V.zoomOnPinch),"panOnScroll"in V&&t(16,Ae=V.panOnScroll),"panOnDrag"in V&&t(17,Ee=V.panOnDrag),"selectionOnDrag"in V&&t(18,Ke=V.selectionOnDrag),"autoPanOnConnect"in V&&t(58,ie=V.autoPanOnConnect),"autoPanOnNodeDrag"in V&&t(59,kt=V.autoPanOnNodeDrag),"onerror"in V&&t(60,Ft=V.onerror),"ondelete"in V&&t(61,nn=V.ondelete),"onedgecreate"in V&&t(62,pn=V.onedgecreate),"attributionPosition"in V&&t(19,Xt=V.attributionPosition),"proOptions"in V&&t(20,sn=V.proOptions),"defaultEdgeOptions"in V&&t(21,W=V.defaultEdgeOptions),"width"in V&&t(63,zt=V.width),"height"in V&&t(64,st=V.height),"colorMode"in V&&t(65,et=V.colorMode),"onconnect"in V&&t(66,ss=V.onconnect),"onconnectstart"in V&&t(67,is=V.onconnectstart),"onconnectend"in V&&t(68,os=V.onconnectend),"onbeforedelete"in V&&t(69,rs=V.onbeforedelete),"oninit"in V&&t(70,En=V.oninit),"nodeOrigin"in V&&t(71,qn=V.nodeOrigin),"paneClickDistance"in V&&t(22,Ii=V.paneClickDistance),"nodeClickDistance"in V&&t(23,ol=V.nodeClickDistance),"defaultMarkerColor"in V&&t(72,hr=V.defaultMarkerColor),"style"in V&&t(24,rl=V.style),"class"in V&&t(25,al=V.class),"$$scope"in V&&t(99,m=V.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&201326592&&as!==void 0&&ls!==void 0&&(_t.width.set(as),_t.height.set(ls)),n.$$.dirty[2]&6400&&!fr&&a&&(En==null||En(),t(73,fr=!0)),n.$$.dirty[1]&2097135632|n.$$.dirty[2]&1777&&my(_t,{flowId:_,connectionLineType:j,connectionRadius:H,selectionMode:D,snapGrid:L,defaultMarkerColor:hr,nodesDraggable:A,nodesConnectable:R,elementsSelectable:F,onlyRenderVisibleElements:ze,isValidConnection:ge,autoPanOnConnect:ie,autoPanOnNodeDrag:kt,onerror:Ft,ondelete:nn,onedgecreate:pn,connectionMode:B,nodeDragThreshold:z,onconnect:ss,onconnectstart:is,onconnectend:os,onbeforedelete:rs,nodeOrigin:qn}),n.$$.dirty[0]&4194304|n.$$.dirty[1]&16791040&&uc(_t,{nodeTypes:M,edgeTypes:O,minZoom:b,maxZoom:N,translateExtent:Te,paneClickDistance:Ii}),n.$$.dirty[2]&8&&f(t(29,s=gy(et)))},[S,P,I,w,E,q,te,re,J,ne,se,Q,$,le,Oe,_e,Ae,Ee,Ke,Xt,sn,W,Ii,ol,rl,al,as,ls,Pi,s,u,Mf,ll,o,g,_,p,v,y,k,b,N,T,M,O,D,A,R,z,F,L,H,j,B,ge,Te,Ce,ze,ie,kt,Ft,nn,pn,zt,st,et,ss,is,os,rs,En,qn,hr,fr,a,d,Of,Df,If,Pf,Rf,xf,Vf,Ff,zf,Wf,Lf,qf,Bf,Hf,Xf,Yf,jf,Uf,Gf,Zf,Kf,Qf,Jf,m]}class Sy extends we{constructor(e){super(),be(this,e,Ty,ky,ve,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}const Cy=Sy,Ay=n=>({}),fc=n=>({class:"button-svg"});function Ny(n){let e,t,s,i,o;const a=n[8].default,r=Ct(a,n,n[7],fc);let l=[{type:"button"},{class:t=Le(["svelte-flow__controls-button",n[0]])},n[6]],c={};for(let u=0;u<l.length;u+=1)c=Re(c,l[u]);return{c(){e=X("button"),r&&r.c(),Ns(e,c),Se(e,"--xy-controls-button-background-color-props",n[1]),Se(e,"--xy-controls-button-background-color-hover-props",n[2]),Se(e,"--xy-controls-button-color-props",n[3]),Se(e,"--xy-controls-button-color-hover-props",n[4]),Se(e,"--xy-controls-button-border-color-props",n[5])},m(u,h){Z(u,e,h),r&&r.m(e,null),e.autofocus&&e.focus(),s=!0,i||(o=de(e,"click",n[9]),i=!0)},p(u,[h]){r&&r.p&&(!s||h&128)&&Nt(r,a,u,u[7],s?At(a,u[7],h,Ay):Et(u[7]),fc),Ns(e,c=vn(l,[{type:"button"},(!s||h&1&&t!==(t=Le(["svelte-flow__controls-button",u[0]])))&&{class:t},h&64&&u[6]])),Se(e,"--xy-controls-button-background-color-props",u[1]),Se(e,"--xy-controls-button-background-color-hover-props",u[2]),Se(e,"--xy-controls-button-color-props",u[3]),Se(e,"--xy-controls-button-color-hover-props",u[4]),Se(e,"--xy-controls-button-border-color-props",u[5])},i(u){s||(Y(r,u),s=!0)},o(u){G(r,u),s=!1},d(u){u&&U(e),r&&r.d(u),i=!1,o()}}}function Ey(n,e,t){const s=["class","bgColor","bgColorHover","color","colorHover","borderColor"];let i=$e(e,s),{$$slots:o={},$$scope:a}=e,{class:r=void 0}=e,{bgColor:l=void 0}=e,{bgColorHover:c=void 0}=e,{color:u=void 0}=e,{colorHover:h=void 0}=e,{borderColor:f=void 0}=e;function d(m){De.call(this,n,m)}return n.$$set=m=>{e=Re(Re({},e),Qt(m)),t(6,i=$e(e,s)),"class"in m&&t(0,r=m.class),"bgColor"in m&&t(1,l=m.bgColor),"bgColorHover"in m&&t(2,c=m.bgColorHover),"color"in m&&t(3,u=m.color),"colorHover"in m&&t(4,h=m.colorHover),"borderColor"in m&&t(5,f=m.borderColor),"$$scope"in m&&t(7,a=m.$$scope)},[r,l,c,u,h,f,i,a,o,d]}class My extends we{constructor(e){super(),be(this,e,Ey,Ny,ve,{class:0,bgColor:1,bgColorHover:2,color:3,colorHover:4,borderColor:5})}}const _o=My;function Oy(n){let e,t;return{c(){e=Pe("svg"),t=Pe("path"),C(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"viewBox","0 0 32 32")},m(s,i){Z(s,e,i),x(e,t)},p:pe,i:pe,o:pe,d(s){s&&U(e)}}}class Dy extends we{constructor(e){super(),be(this,e,null,Oy,ve,{})}}const Iy=Dy;function Py(n){let e,t;return{c(){e=Pe("svg"),t=Pe("path"),C(t,"d","M0 0h32v4.2H0z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"viewBox","0 0 32 5")},m(s,i){Z(s,e,i),x(e,t)},p:pe,i:pe,o:pe,d(s){s&&U(e)}}}class Ry extends we{constructor(e){super(),be(this,e,null,Py,ve,{})}}const xy=Ry;function Vy(n){let e,t;return{c(){e=Pe("svg"),t=Pe("path"),C(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"viewBox","0 0 32 30")},m(s,i){Z(s,e,i),x(e,t)},p:pe,i:pe,o:pe,d(s){s&&U(e)}}}class Fy extends we{constructor(e){super(),be(this,e,null,Vy,ve,{})}}const zy=Fy;function Wy(n){let e,t;return{c(){e=Pe("svg"),t=Pe("path"),C(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"viewBox","0 0 25 32")},m(s,i){Z(s,e,i),x(e,t)},p:pe,i:pe,o:pe,d(s){s&&U(e)}}}class Ly extends we{constructor(e){super(),be(this,e,null,Wy,ve,{})}}const qy=Ly;function By(n){let e,t;return{c(){e=Pe("svg"),t=Pe("path"),C(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"viewBox","0 0 25 32")},m(s,i){Z(s,e,i),x(e,t)},p:pe,i:pe,o:pe,d(s){s&&U(e)}}}class Hy extends we{constructor(e){super(),be(this,e,null,By,ve,{})}}const Xy=Hy,Yy=n=>({}),dc=n=>({}),jy=n=>({}),mc=n=>({});function pc(n){let e,t,s,i;const o=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:n[9]},n[17]];let a={$$slots:{default:[Uy]},$$scope:{ctx:n}};for(let c=0;c<o.length;c+=1)a=Re(a,o[c]);e=new _o({props:a}),e.$on("click",n[18]);const r=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:n[10]},n[17]];let l={$$slots:{default:[Gy]},$$scope:{ctx:n}};for(let c=0;c<r.length;c+=1)l=Re(l,r[c]);return s=new _o({props:l}),s.$on("click",n[19]),{c(){he(e.$$.fragment),t=K(),he(s.$$.fragment)},m(c,u){ce(e,c,u),Z(c,t,u),ce(s,c,u),i=!0},p(c,u){const h=u[0]&131584?vn(o,[o[0],o[1],o[2],u[0]&512&&{disabled:c[9]},u[0]&131072&&Es(c[17])]):{};u[1]&32&&(h.$$scope={dirty:u,ctx:c}),e.$set(h);const f=u[0]&132096?vn(r,[r[0],r[1],r[2],u[0]&1024&&{disabled:c[10]},u[0]&131072&&Es(c[17])]):{};u[1]&32&&(f.$$scope={dirty:u,ctx:c}),s.$set(f)},i(c){i||(Y(e.$$.fragment,c),Y(s.$$.fragment,c),i=!0)},o(c){G(e.$$.fragment,c),G(s.$$.fragment,c),i=!1},d(c){c&&U(t),ue(e,c),ue(s,c)}}}function Uy(n){let e,t;return e=new Iy({}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function Gy(n){let e,t;return e=new xy({}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function gc(n){let e,t;const s=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},n[17]];let i={$$slots:{default:[Zy]},$$scope:{ctx:n}};for(let o=0;o<s.length;o+=1)i=Re(i,s[o]);return e=new _o({props:i}),e.$on("click",n[20]),{c(){he(e.$$.fragment)},m(o,a){ce(e,o,a),t=!0},p(o,a){const r=a[0]&131072?vn(s,[s[0],s[1],s[2],Es(o[17])]):{};a[1]&32&&(r.$$scope={dirty:a,ctx:o}),e.$set(r)},i(o){t||(Y(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){ue(e,o)}}}function Zy(n){let e,t;return e=new zy({}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function _c(n){let e,t;const s=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},n[17]];let i={$$slots:{default:[Jy]},$$scope:{ctx:n}};for(let o=0;o<s.length;o+=1)i=Re(i,s[o]);return e=new _o({props:i}),e.$on("click",n[21]),{c(){he(e.$$.fragment)},m(o,a){ce(e,o,a),t=!0},p(o,a){const r=a[0]&131072?vn(s,[s[0],s[1],s[2],Es(o[17])]):{};a[0]&256|a[1]&32&&(r.$$scope={dirty:a,ctx:o}),e.$set(r)},i(o){t||(Y(e.$$.fragment,o),t=!0)},o(o){G(e.$$.fragment,o),t=!1},d(o){ue(e,o)}}}function Ky(n){let e,t;return e=new qy({}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function Qy(n){let e,t;return e=new Xy({}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function Jy(n){let e,t,s,i;const o=[Qy,Ky],a=[];function r(l,c){return l[8]?0:1}return e=r(n),t=a[e]=o[e](n),{c(){t.c(),s=Ze()},m(l,c){a[e].m(l,c),Z(l,s,c),i=!0},p(l,c){let u=e;e=r(l),e!==u&&(at(),G(a[u],1,1,()=>{a[u]=null}),lt(),t=a[e],t||(t=a[e]=o[e](l),t.c()),Y(t,1),t.m(s.parentNode,s))},i(l){i||(Y(t),i=!0)},o(l){G(t),i=!1},d(l){l&&U(s),a[e].d(l)}}}function $y(n){let e,t,s,i,o,a;const r=n[35].before,l=Ct(r,n,n[36],mc);let c=n[1]&&pc(n),u=n[2]&&gc(n),h=n[3]&&_c(n);const f=n[35].default,d=Ct(f,n,n[36],null),m=n[35].after,g=Ct(m,n,n[36],dc);return{c(){l&&l.c(),e=K(),c&&c.c(),t=K(),u&&u.c(),s=K(),h&&h.c(),i=K(),d&&d.c(),o=K(),g&&g.c()},m(_,p){l&&l.m(_,p),Z(_,e,p),c&&c.m(_,p),Z(_,t,p),u&&u.m(_,p),Z(_,s,p),h&&h.m(_,p),Z(_,i,p),d&&d.m(_,p),Z(_,o,p),g&&g.m(_,p),a=!0},p(_,p){l&&l.p&&(!a||p[1]&32)&&Nt(l,r,_,_[36],a?At(r,_[36],p,jy):Et(_[36]),mc),_[1]?c?(c.p(_,p),p[0]&2&&Y(c,1)):(c=pc(_),c.c(),Y(c,1),c.m(t.parentNode,t)):c&&(at(),G(c,1,1,()=>{c=null}),lt()),_[2]?u?(u.p(_,p),p[0]&4&&Y(u,1)):(u=gc(_),u.c(),Y(u,1),u.m(s.parentNode,s)):u&&(at(),G(u,1,1,()=>{u=null}),lt()),_[3]?h?(h.p(_,p),p[0]&8&&Y(h,1)):(h=_c(_),h.c(),Y(h,1),h.m(i.parentNode,i)):h&&(at(),G(h,1,1,()=>{h=null}),lt()),d&&d.p&&(!a||p[1]&32)&&Nt(d,f,_,_[36],a?At(f,_[36],p,null):Et(_[36]),null),g&&g.p&&(!a||p[1]&32)&&Nt(g,m,_,_[36],a?At(m,_[36],p,Yy):Et(_[36]),dc)},i(_){a||(Y(l,_),Y(c),Y(u),Y(h),Y(d,_),Y(g,_),a=!0)},o(_){G(l,_),G(c),G(u),G(h),G(d,_),G(g,_),a=!1},d(_){_&&(U(e),U(t),U(s),U(i),U(o)),l&&l.d(_),c&&c.d(_),u&&u.d(_),h&&h.d(_),d&&d.d(_),g&&g.d(_)}}}function eb(n){let e,t;return e=new da({props:{class:Le(["svelte-flow__controls",n[7],n[6]]),position:n[0],"data-testid":"svelte-flow__controls","aria-label":n[4]??"Svelte Flow controls",style:n[5],$$slots:{default:[$y]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i[0]&192&&(o.class=Le(["svelte-flow__controls",s[7],s[6]])),i[0]&1&&(o.position=s[0]),i[0]&16&&(o["aria-label"]=s[4]??"Svelte Flow controls"),i[0]&32&&(o.style=s[5]),i[0]&1806|i[1]&32&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function tb(n,e,t){let s,i,o,a,r,l,c,u,h,f,{$$slots:d={},$$scope:m}=e,{position:g="bottom-left"}=e,{showZoom:_=!0}=e,{showFitView:p=!0}=e,{showLock:v=!0}=e,{buttonBgColor:y=void 0}=e,{buttonBgColorHover:k=void 0}=e,{buttonColor:b=void 0}=e,{buttonColorHover:N=void 0}=e,{buttonBorderColor:T=void 0}=e,{ariaLabel:S=void 0}=e,{style:M=void 0}=e,{orientation:O="vertical"}=e,{fitViewOptions:P=void 0}=e,{class:D=""}=e;const{zoomIn:I,zoomOut:w,fitView:E,viewport:A,minZoom:R,maxZoom:z,nodesDraggable:F,nodesConnectable:L,elementsSelectable:q}=ct();ee(n,A,J=>t(30,l=J)),ee(n,R,J=>t(31,c=J)),ee(n,z,J=>t(29,r=J)),ee(n,F,J=>t(34,f=J)),ee(n,L,J=>t(33,h=J)),ee(n,q,J=>t(32,u=J));const H={bgColor:y,bgColorHover:k,color:b,colorHover:N,borderColor:T},j=()=>{I()},B=()=>{w()},te=()=>{E(P)},re=()=>{t(8,s=!s),F.set(s),L.set(s),q.set(s)};return n.$$set=J=>{"position"in J&&t(0,g=J.position),"showZoom"in J&&t(1,_=J.showZoom),"showFitView"in J&&t(2,p=J.showFitView),"showLock"in J&&t(3,v=J.showLock),"buttonBgColor"in J&&t(22,y=J.buttonBgColor),"buttonBgColorHover"in J&&t(23,k=J.buttonBgColorHover),"buttonColor"in J&&t(24,b=J.buttonColor),"buttonColorHover"in J&&t(25,N=J.buttonColorHover),"buttonBorderColor"in J&&t(26,T=J.buttonBorderColor),"ariaLabel"in J&&t(4,S=J.ariaLabel),"style"in J&&t(5,M=J.style),"orientation"in J&&t(27,O=J.orientation),"fitViewOptions"in J&&t(28,P=J.fitViewOptions),"class"in J&&t(6,D=J.class),"$$scope"in J&&t(36,m=J.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&14&&t(8,s=f||h||u),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1&&t(10,i=l.zoom<=c),n.$$.dirty[0]&1610612736&&t(9,o=l.zoom>=r),n.$$.dirty[0]&134217728&&t(7,a=O==="horizontal"?"horizontal":"vertical")},[g,_,p,v,S,M,D,a,s,o,i,A,R,z,F,L,q,H,j,B,te,re,y,k,b,N,T,O,P,r,l,c,u,h,f,d,m]}class nb extends we{constructor(e){super(),be(this,e,tb,eb,ve,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}}const sb=nb;var In;(function(n){n.Lines="lines",n.Dots="dots",n.Cross="cross"})(In||(In={}));function ib(n){let e,t;return{c(){e=Pe("circle"),C(e,"cx",n[0]),C(e,"cy",n[0]),C(e,"r",n[0]),C(e,"class",t=Le(["svelte-flow__background-pattern","dots",n[1]]))},m(s,i){Z(s,e,i)},p(s,[i]){i&1&&C(e,"cx",s[0]),i&1&&C(e,"cy",s[0]),i&1&&C(e,"r",s[0]),i&2&&t!==(t=Le(["svelte-flow__background-pattern","dots",s[1]]))&&C(e,"class",t)},i:pe,o:pe,d(s){s&&U(e)}}}function ob(n,e,t){let{radius:s=5}=e,{class:i=""}=e;return n.$$set=o=>{"radius"in o&&t(0,s=o.radius),"class"in o&&t(1,i=o.class)},[s,i]}class rb extends we{constructor(e){super(),be(this,e,ob,ib,ve,{radius:0,class:1})}}const ab=rb;function lb(n){let e,t,s;return{c(){e=Pe("path"),C(e,"stroke-width",n[0]),C(e,"d",t=`M${n[1][0]/2} 0 V${n[1][1]} M0 ${n[1][1]/2} H${n[1][0]}`),C(e,"class",s=Le(["svelte-flow__background-pattern",n[2],n[3]]))},m(i,o){Z(i,e,o)},p(i,[o]){o&1&&C(e,"stroke-width",i[0]),o&2&&t!==(t=`M${i[1][0]/2} 0 V${i[1][1]} M0 ${i[1][1]/2} H${i[1][0]}`)&&C(e,"d",t),o&12&&s!==(s=Le(["svelte-flow__background-pattern",i[2],i[3]]))&&C(e,"class",s)},i:pe,o:pe,d(i){i&&U(e)}}}function cb(n,e,t){let{lineWidth:s=1}=e,{dimensions:i}=e,{variant:o=void 0}=e,{class:a=""}=e;return n.$$set=r=>{"lineWidth"in r&&t(0,s=r.lineWidth),"dimensions"in r&&t(1,i=r.dimensions),"variant"in r&&t(2,o=r.variant),"class"in r&&t(3,a=r.class)},[s,i,o,a]}class ub extends we{constructor(e){super(),be(this,e,cb,lb,ve,{lineWidth:0,dimensions:1,variant:2,class:3})}}const hb=ub;function fb(n){let e,t;return e=new hb({props:{dimensions:n[6],variant:n[0],lineWidth:n[1],class:n[4]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i&64&&(o.dimensions=s[6]),i&1&&(o.variant=s[0]),i&2&&(o.lineWidth=s[1]),i&16&&(o.class=s[4]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function db(n){let e,t;return e=new ab({props:{radius:n[7]/2,class:n[4]}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i&128&&(o.radius=s[7]/2),i&16&&(o.class=s[4]),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function mb(n){let e,t,s,i,o,a,r,l,c,u,h,f,d;const m=[db,fb],g=[];function _(p,v){return p[14]?0:1}return s=_(n),i=g[s]=m[s](n),{c(){e=Pe("svg"),t=Pe("pattern"),i.c(),u=Pe("rect"),C(t,"id",n[11]),C(t,"x",o=n[9].x%n[8][0]),C(t,"y",a=n[9].y%n[8][1]),C(t,"width",r=n[8][0]),C(t,"height",l=n[8][1]),C(t,"patternUnits","userSpaceOnUse"),C(t,"patternTransform",c=`translate(-${n[10][0]},-${n[10][1]})`),C(u,"x","0"),C(u,"y","0"),C(u,"width","100%"),C(u,"height","100%"),C(u,"fill",h=`url(#${n[11]})`),C(e,"class",f=ul(Le(["svelte-flow__background",n[5]]))+" svelte-1r7pe8d"),C(e,"data-testid","svelte-flow__background"),Se(e,"--xy-background-color-props",n[2]),Se(e,"--xy-background-pattern-color-props",n[3])},m(p,v){Z(p,e,v),x(e,t),g[s].m(t,null),x(e,u),d=!0},p(p,[v]){i.p(p,v),(!d||v&2048)&&C(t,"id",p[11]),(!d||v&768&&o!==(o=p[9].x%p[8][0]))&&C(t,"x",o),(!d||v&768&&a!==(a=p[9].y%p[8][1]))&&C(t,"y",a),(!d||v&256&&r!==(r=p[8][0]))&&C(t,"width",r),(!d||v&256&&l!==(l=p[8][1]))&&C(t,"height",l),(!d||v&1024&&c!==(c=`translate(-${p[10][0]},-${p[10][1]})`))&&C(t,"patternTransform",c),(!d||v&2048&&h!==(h=`url(#${p[11]})`))&&C(u,"fill",h),(!d||v&32&&f!==(f=ul(Le(["svelte-flow__background",p[5]]))+" svelte-1r7pe8d"))&&C(e,"class",f),v&4&&Se(e,"--xy-background-color-props",p[2]),v&8&&Se(e,"--xy-background-pattern-color-props",p[3])},i(p){d||(Y(i),d=!0)},o(p){G(i),d=!1},d(p){p&&U(e),g[s].d()}}}const pb={[In.Dots]:1,[In.Lines]:1,[In.Cross]:6};function gb(n,e,t){let s,i,o,a,r,l,c,{id:u=void 0}=e,{variant:h=In.Dots}=e,{gap:f=20}=e,{size:d=1}=e,{lineWidth:m=1}=e,{bgColor:g=void 0}=e,{patternColor:_=void 0}=e,{patternClass:p=void 0}=e,{class:v=""}=e;const{viewport:y,flowId:k}=ct();ee(n,y,M=>t(9,l=M)),ee(n,k,M=>t(18,c=M));const b=d||pb[h],N=h===In.Dots,T=h===In.Cross,S=Array.isArray(f)?f:[f,f];return n.$$set=M=>{"id"in M&&t(15,u=M.id),"variant"in M&&t(0,h=M.variant),"gap"in M&&t(16,f=M.gap),"size"in M&&t(17,d=M.size),"lineWidth"in M&&t(1,m=M.lineWidth),"bgColor"in M&&t(2,g=M.bgColor),"patternColor"in M&&t(3,_=M.patternColor),"patternClass"in M&&t(4,p=M.patternClass),"class"in M&&t(5,v=M.class)},n.$$.update=()=>{n.$$.dirty&294912&&t(11,s=`background-pattern-${c}-${u||""}`),n.$$.dirty&512&&t(8,i=[S[0]*l.zoom||1,S[1]*l.zoom||1]),n.$$.dirty&512&&t(7,o=b*l.zoom),n.$$.dirty&384&&t(6,a=T?[o,o]:i),n.$$.dirty&192&&t(10,r=N?[o/2,o/2]:[a[0]/2,a[1]/2])},[h,m,g,_,p,v,a,o,i,l,r,s,y,k,N,u,f,d,c]}class _b extends we{constructor(e){super(),be(this,e,gb,mb,ve,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const yb=_b;function bb(n){let e,t,s;return{c(){e=Pe("rect"),C(e,"class",t=Le(["svelte-flow__minimap-node",n[10]])),C(e,"x",n[0]),C(e,"y",n[1]),C(e,"rx",n[4]),C(e,"ry",n[4]),C(e,"width",n[2]),C(e,"height",n[3]),C(e,"style",s=`${n[5]?`fill: ${n[5]};`:""}${n[7]?`stroke: ${n[7]};`:""}${n[8]?`stroke-width: ${n[8]};`:""}`),C(e,"shape-rendering",n[6]),ke(e,"selected",n[9])},m(i,o){Z(i,e,o)},p(i,[o]){o&1024&&t!==(t=Le(["svelte-flow__minimap-node",i[10]]))&&C(e,"class",t),o&1&&C(e,"x",i[0]),o&2&&C(e,"y",i[1]),o&16&&C(e,"rx",i[4]),o&16&&C(e,"ry",i[4]),o&4&&C(e,"width",i[2]),o&8&&C(e,"height",i[3]),o&416&&s!==(s=`${i[5]?`fill: ${i[5]};`:""}${i[7]?`stroke: ${i[7]};`:""}${i[8]?`stroke-width: ${i[8]};`:""}`)&&C(e,"style",s),o&64&&C(e,"shape-rendering",i[6]),o&1536&&ke(e,"selected",i[9])},i:pe,o:pe,d(i){i&&U(e)}}}function wb(n,e,t){let{x:s}=e,{y:i}=e,{width:o=0}=e,{height:a=0}=e,{borderRadius:r=5}=e,{color:l=void 0}=e,{shapeRendering:c}=e,{strokeColor:u=void 0}=e,{strokeWidth:h=2}=e,{selected:f=!1}=e,{class:d=""}=e;return n.$$set=m=>{"x"in m&&t(0,s=m.x),"y"in m&&t(1,i=m.y),"width"in m&&t(2,o=m.width),"height"in m&&t(3,a=m.height),"borderRadius"in m&&t(4,r=m.borderRadius),"color"in m&&t(5,l=m.color),"shapeRendering"in m&&t(6,c=m.shapeRendering),"strokeColor"in m&&t(7,u=m.strokeColor),"strokeWidth"in m&&t(8,h=m.strokeWidth),"selected"in m&&t(9,f=m.selected),"class"in m&&t(10,d=m.class)},[s,i,o,a,r,l,c,u,h,f,d]}class vb extends we{constructor(e){super(),be(this,e,wb,bb,ve,{x:0,y:1,width:2,height:3,borderRadius:4,color:5,shapeRendering:6,strokeColor:7,strokeWidth:8,selected:9,class:10})}}const kb=vb;function Tb(n,e){const t=P_({domNode:n,panZoom:e.panZoom,getTransform:()=>{const i=oe(e.viewport);return[i.x,i.y,i.zoom]},getViewScale:e.getViewScale});function s(i){t.update({translateExtent:i.translateExtent,width:i.width,height:i.height,inversePan:i.inversePan,zoomStep:i.zoomStep,pannable:i.pannable,zoomable:i.zoomable})}return{update:s,destroy(){t.destroy()}}}function yc(n,e,t){const s=n.slice();s[55]=e[t];const i=s[20].get(s[55].id);return s[56]=i,s}function kr(n){const e=n.slice(),t=Fn(e[56]);return e[59]=t,e}function bc(n){let e,t,s=[],i=new Map,o,a,r,l,c,u,h,f=n[1]&&wc(n),d=Mt(n[19]);const m=g=>g[55].id;for(let g=0;g<d.length;g+=1){let _=yc(n,d,g),p=m(_);i.set(p,s[g]=kc(p,_))}return{c(){e=Pe("svg"),f&&f.c(),t=Ze();for(let g=0;g<s.length;g+=1)s[g].c();o=Pe("path"),C(o,"class","svelte-flow__minimap-mask"),C(o,"d",a="M"+(n[26]-n[15])+","+(n[25]-n[15])+"h"+(n[24]+n[15]*2)+"v"+(n[23]+n[15]*2)+"h"+(-n[24]-n[15]*2)+`z
      M`+n[18].x+","+n[18].y+"h"+n[18].width+"v"+n[18].height+"h"+-n[18].width+"z"),C(o,"fill-rule","evenodd"),C(o,"pointer-events","none"),C(e,"width",n[17]),C(e,"height",n[16]),C(e,"viewBox",r=n[26]+" "+n[25]+" "+n[24]+" "+n[23]),C(e,"class","svelte-flow__minimap-svg"),C(e,"role","img"),C(e,"aria-labelledby",n[41]),Se(e,"--xy-minimap-mask-background-color-props",n[5]),Se(e,"--xy-minimap-mask-stroke-color-props",n[6]),Se(e,"--xy-minimap-mask-stroke-width-props",n[7]?n[7]*n[14]:void 0)},m(g,_){Z(g,e,_),f&&f.m(e,null),x(e,t);for(let p=0;p<s.length;p+=1)s[p]&&s[p].m(e,null);x(e,o),c=!0,u||(h=yt(l=Tb.call(null,e,{panZoom:n[27],viewport:n[31],getViewScale:n[42],translateExtent:n[28],width:n[22],height:n[21],inversePan:n[10],zoomStep:n[11],pannable:n[8],zoomable:n[9]})),u=!0)},p(g,_){g[1]?f?f.p(g,_):(f=wc(g),f.c(),f.m(e,t)):f&&(f.d(1),f=null),_[0]&1572876|_[1]&960&&(d=Mt(g[19]),at(),s=Ro(s,_,m,1,g,d,i,e,Po,kc,o,yc),lt()),(!c||_[0]&126124032&&a!==(a="M"+(g[26]-g[15])+","+(g[25]-g[15])+"h"+(g[24]+g[15]*2)+"v"+(g[23]+g[15]*2)+"h"+(-g[24]-g[15]*2)+`z
      M`+g[18].x+","+g[18].y+"h"+g[18].width+"v"+g[18].height+"h"+-g[18].width+"z"))&&C(o,"d",a),(!c||_[0]&131072)&&C(e,"width",g[17]),(!c||_[0]&65536)&&C(e,"height",g[16]),(!c||_[0]&125829120&&r!==(r=g[26]+" "+g[25]+" "+g[24]+" "+g[23]))&&C(e,"viewBox",r),l&&Ye(l.update)&&_[0]&408948480&&l.update.call(null,{panZoom:g[27],viewport:g[31],getViewScale:g[42],translateExtent:g[28],width:g[22],height:g[21],inversePan:g[10],zoomStep:g[11],pannable:g[8],zoomable:g[9]}),_[0]&32&&Se(e,"--xy-minimap-mask-background-color-props",g[5]),_[0]&64&&Se(e,"--xy-minimap-mask-stroke-color-props",g[6]),_[0]&16512&&Se(e,"--xy-minimap-mask-stroke-width-props",g[7]?g[7]*g[14]:void 0)},i(g){if(!c){for(let _=0;_<d.length;_+=1)Y(s[_]);c=!0}},o(g){for(let _=0;_<s.length;_+=1)G(s[_]);c=!1},d(g){g&&U(e),f&&f.d();for(let _=0;_<s.length;_+=1)s[_].d();u=!1,h()}}}function wc(n){let e,t;return{c(){e=Pe("title"),t=Be(n[1]),C(e,"id",n[41])},m(s,i){Z(s,e,i),x(e,t)},p(s,i){i[0]&2&&ht(t,s[1])},d(s){s&&U(e)}}}function vc(n){var o;let e,t;const s=[{x:n[56].internals.positionAbsolute.x},{y:n[56].internals.positionAbsolute.y},n[59],{selected:n[56].selected},{color:(o=n[37])==null?void 0:o.call(n,n[56])},{borderRadius:n[2]},{strokeColor:n[38](n[56])},{strokeWidth:n[3]},{shapeRendering:n[40]},{class:n[39](n[56])}];let i={};for(let a=0;a<s.length;a+=1)i=Re(i,s[a]);return e=new kb({props:i}),{c(){he(e.$$.fragment)},m(a,r){ce(e,a,r),t=!0},p(a,r){var c;const l=r[0]&1572876|r[1]&960?vn(s,[r[0]&1572864&&{x:a[56].internals.positionAbsolute.x},r[0]&1572864&&{y:a[56].internals.positionAbsolute.y},r[0]&1572864&&Es(a[59]),r[0]&1572864&&{selected:a[56].selected},r[0]&1572864|r[1]&64&&{color:(c=a[37])==null?void 0:c.call(a,a[56])},r[0]&4&&{borderRadius:a[2]},r[0]&1572864|r[1]&128&&{strokeColor:a[38](a[56])},r[0]&8&&{strokeWidth:a[3]},r[1]&512&&{shapeRendering:a[40]},r[0]&1572864|r[1]&256&&{class:a[39](a[56])}]):{};e.$set(l)},i(a){t||(Y(e.$$.fragment,a),t=!0)},o(a){G(e.$$.fragment,a),t=!1},d(a){ue(e,a)}}}function kc(n,e){let t,s=e[56]&&po(e[56]),i,o,a=s&&vc(kr(e));return{key:n,first:null,c(){t=Ze(),a&&a.c(),i=Ze(),this.first=t},m(r,l){Z(r,t,l),a&&a.m(r,l),Z(r,i,l),o=!0},p(r,l){e=r,l[0]&1572864&&(s=e[56]&&po(e[56])),s?a?(a.p(kr(e),l),l[0]&1572864&&Y(a,1)):(a=vc(kr(e)),a.c(),Y(a,1),a.m(i.parentNode,i)):a&&(at(),G(a,1,1,()=>{a=null}),lt())},i(r){o||(Y(a),o=!0)},o(r){G(a),o=!1},d(r){r&&(U(t),U(i)),a&&a.d(r)}}}function Sb(n){let e,t,s=n[27]&&bc(n);return{c(){s&&s.c(),e=Ze()},m(i,o){s&&s.m(i,o),Z(i,e,o),t=!0},p(i,o){i[27]?s?(s.p(i,o),o[0]&134217728&&Y(s,1)):(s=bc(i),s.c(),Y(s,1),s.m(e.parentNode,e)):s&&(at(),G(s,1,1,()=>{s=null}),lt())},i(i){t||(Y(s),t=!0)},o(i){G(s),t=!1},d(i){i&&U(e),s&&s.d(i)}}}function Cb(n){let e,t;return e=new da({props:{position:n[0],style:n[12]+(n[4]?`;--xy-minimap-background-color-props:${n[4]}`:""),class:Le(["svelte-flow__minimap",n[13]]),"data-testid":"svelte-flow__minimap",$$slots:{default:[Sb]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p(s,i){const o={};i[0]&1&&(o.position=s[0]),i[0]&4112&&(o.style=s[12]+(s[4]?`;--xy-minimap-background-color-props:${s[4]}`:"")),i[0]&8192&&(o.class=Le(["svelte-flow__minimap",s[13]])),i[0]&536858606|i[1]&536870912&&(o.$$scope={dirty:i,ctx:s}),e.$set(o)},i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}const Tr=n=>n instanceof Function?n:()=>n,Ab=200,Nb=150;function Eb(n,e,t){let s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y,k,b,N,T,{position:S="bottom-right"}=e,{ariaLabel:M="Mini map"}=e,{nodeStrokeColor:O="transparent"}=e,{nodeColor:P=void 0}=e,{nodeClass:D=""}=e,{nodeBorderRadius:I=5}=e,{nodeStrokeWidth:w=2}=e,{bgColor:E=void 0}=e,{maskColor:A=void 0}=e,{maskStrokeColor:R=void 0}=e,{maskStrokeWidth:z=void 0}=e,{width:F=void 0}=e,{height:L=void 0}=e,{pannable:q=!0}=e,{zoomable:H=!0}=e,{inversePan:j=void 0}=e,{zoomStep:B=void 0}=e,{style:te=""}=e,{class:re=""}=e;const{nodes:J,nodeLookup:ne,viewport:se,width:ge,height:Te,flowId:Ce,panZoom:ze,translateExtent:Q}=ct();ee(n,J,ie=>t(19,_=ie)),ee(n,ne,ie=>t(20,p=ie)),ee(n,se,ie=>t(53,v=ie)),ee(n,ge,ie=>t(22,k=ie)),ee(n,Te,ie=>t(21,y=ie)),ee(n,Ce,ie=>t(54,b=ie)),ee(n,ze,ie=>t(27,N=ie)),ee(n,Q,ie=>t(28,T=ie));const $=P===void 0?void 0:Tr(P),le=Tr(O),Oe=Tr(D),_e=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision",Ae=`svelte-flow__minimap-desc-${b}`;let Ee=s;const Ke=()=>l;return n.$$set=ie=>{"position"in ie&&t(0,S=ie.position),"ariaLabel"in ie&&t(1,M=ie.ariaLabel),"nodeStrokeColor"in ie&&t(43,O=ie.nodeStrokeColor),"nodeColor"in ie&&t(44,P=ie.nodeColor),"nodeClass"in ie&&t(45,D=ie.nodeClass),"nodeBorderRadius"in ie&&t(2,I=ie.nodeBorderRadius),"nodeStrokeWidth"in ie&&t(3,w=ie.nodeStrokeWidth),"bgColor"in ie&&t(4,E=ie.bgColor),"maskColor"in ie&&t(5,A=ie.maskColor),"maskStrokeColor"in ie&&t(6,R=ie.maskStrokeColor),"maskStrokeWidth"in ie&&t(7,z=ie.maskStrokeWidth),"width"in ie&&t(46,F=ie.width),"height"in ie&&t(47,L=ie.height),"pannable"in ie&&t(8,q=ie.pannable),"zoomable"in ie&&t(9,H=ie.zoomable),"inversePan"in ie&&t(10,j=ie.inversePan),"zoomStep"in ie&&t(11,B=ie.zoomStep),"style"in ie&&t(12,te=ie.style),"class"in ie&&t(13,re=ie.class)},n.$$.update=()=>{n.$$.dirty[0]&6291456|n.$$.dirty[1]&4194304&&t(18,s={x:-v.x/v.zoom,y:-v.y/v.zoom,width:k/v.zoom,height:y/v.zoom}),n.$$.dirty[0]&1835008&&t(48,Ee=p.size>0?Gu(_i(p,{filter:ie=>!ie.hidden}),s):s),n.$$.dirty[1]&32768&&t(17,i=F??Ab),n.$$.dirty[1]&65536&&t(16,o=L??Nb),n.$$.dirty[0]&131072|n.$$.dirty[1]&131072&&t(52,a=Ee.width/i),n.$$.dirty[0]&65536|n.$$.dirty[1]&131072&&t(51,r=Ee.height/o),n.$$.dirty[1]&3145728&&t(14,l=Math.max(a,r)),n.$$.dirty[0]&147456&&t(50,c=l*i),n.$$.dirty[0]&81920&&t(49,u=l*o),n.$$.dirty[0]&16384&&t(15,h=5*l),n.$$.dirty[0]&32768|n.$$.dirty[1]&655360&&t(26,f=Ee.x-(c-Ee.width)/2-h),n.$$.dirty[0]&32768|n.$$.dirty[1]&393216&&t(25,d=Ee.y-(u-Ee.height)/2-h),n.$$.dirty[0]&32768|n.$$.dirty[1]&524288&&t(24,m=c+h*2),n.$$.dirty[0]&32768|n.$$.dirty[1]&262144&&t(23,g=u+h*2)},[S,M,I,w,E,A,R,z,q,H,j,B,te,re,l,h,o,i,s,_,p,y,k,g,m,d,f,N,T,J,ne,se,ge,Te,Ce,ze,Q,$,le,Oe,_e,Ae,Ke,O,P,D,F,L,Ee,u,c,r,a,v]}class Mb extends we{constructor(e){super(),be(this,e,Eb,Cb,ve,{position:0,ariaLabel:1,nodeStrokeColor:43,nodeColor:44,nodeClass:45,nodeBorderRadius:2,nodeStrokeWidth:3,bgColor:4,maskColor:5,maskStrokeColor:6,maskStrokeWidth:7,width:46,height:47,pannable:8,zoomable:9,inversePan:10,zoomStep:11,style:12,class:13},null,[-1,-1])}}const Ob=Mb,bh="15.0.4",Tc=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),Sc=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),Lr=(n,e)=>({startTime:e,type:"setValue",value:n}),wh=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),vh=(n,e,{startTime:t,target:s,timeConstant:i})=>s+(e-s)*Math.exp((t-n)/i),gs=n=>n.type==="exponentialRampToValue",yo=n=>n.type==="linearRampToValue",Dn=n=>gs(n)||yo(n),ma=n=>n.type==="setValue",_n=n=>n.type==="setValueCurve",bo=(n,e,t,s)=>{const i=n[e];return i===void 0?s:Dn(i)||ma(i)?i.value:_n(i)?i.values[i.values.length-1]:vh(t,bo(n,e-1,i.startTime,s),i)},Cc=(n,e,t,s,i)=>t===void 0?[s.insertTime,i]:Dn(t)?[t.endTime,t.value]:ma(t)?[t.startTime,t.value]:_n(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,bo(n,e-1,t.startTime,i)],qr=n=>n.type==="cancelAndHold",Br=n=>n.type==="cancelScheduledValues",Mn=n=>qr(n)||Br(n)?n.cancelTime:gs(n)||yo(n)?n.endTime:n.startTime,Ac=(n,e,t,{endTime:s,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(s-e)):0,Nc=(n,e,t,{endTime:s,value:i})=>t+(n-e)/(s-e)*(i-t),Db=(n,e)=>{const t=Math.floor(e),s=Math.ceil(e);return t===s?n[t]:(1-(e-t))*n[t]+(1-(s-e))*n[s]},Ib=(n,{duration:e,startTime:t,values:s})=>{const i=(n-t)/e*(s.length-1);return Db(s,i)},Bi=n=>n.type==="setTarget";class Pb{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Mn(e);if(qr(e)||Br(e)){const s=this._automationEvents.findIndex(o=>Br(e)&&_n(o)?o.startTime+o.duration>=t:Mn(o)>=t),i=this._automationEvents[s];if(s!==-1&&(this._automationEvents=this._automationEvents.slice(0,s)),qr(e)){const o=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Dn(i)){if(o!==void 0&&Bi(o))throw new Error("The internal list is malformed.");const a=o===void 0?i.insertTime:_n(o)?o.startTime+o.duration:Mn(o),r=o===void 0?this._defaultValue:_n(o)?o.values[o.values.length-1]:o.value,l=gs(i)?Ac(t,a,r,i):Nc(t,a,r,i),c=gs(i)?Tc(l,t,this._currenTime):Sc(l,t,this._currenTime);this._automationEvents.push(c)}if(o!==void 0&&Bi(o)&&this._automationEvents.push(Lr(this.getValue(t),t)),o!==void 0&&_n(o)&&o.startTime+o.duration>t){const a=t-o.startTime,r=(o.values.length-1)/o.duration,l=Math.max(2,1+Math.ceil(a*r)),c=a/(l-1)*r,u=o.values.slice(0,l);if(c<1)for(let h=1;h<l;h+=1){const f=c*h%1;u[h]=o.values[h-1]*(1-f)+o.values[h]*f}this._automationEvents[this._automationEvents.length-1]=wh(u,o.startTime,a)}}}else{const s=this._automationEvents.findIndex(a=>Mn(a)>t),i=s===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(i!==void 0&&_n(i)&&Mn(i)+i.duration>t)return!1;const o=gs(e)?Tc(e.value,e.endTime,this._currenTime):yo(e)?Sc(e.value,t,this._currenTime):e;if(s===-1)this._automationEvents.push(o);else{if(_n(e)&&t+e.duration>Mn(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,o)}}return!0}flush(e){const t=this._automationEvents.findIndex(s=>Mn(s)>e);if(t>1){const s=this._automationEvents.slice(t-1),i=s[0];Bi(i)&&s.unshift(Lr(bo(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=s}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>Mn(a)>e),s=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,o=this._automationEvents[i];if(o!==void 0&&Bi(o)&&(s===void 0||!Dn(s)||s.insertTime>e))return vh(e,bo(this._automationEvents,i-1,o.startTime,this._defaultValue),o);if(o!==void 0&&ma(o)&&(s===void 0||!Dn(s)))return o.value;if(o!==void 0&&_n(o)&&(s===void 0||!Dn(s)||o.startTime+o.duration>e))return e<o.startTime+o.duration?Ib(e,o):o.values[o.values.length-1];if(o!==void 0&&Dn(o)&&(s===void 0||!Dn(s)))return o.value;if(s!==void 0&&gs(s)){const[a,r]=Cc(this._automationEvents,i,o,s,this._defaultValue);return Ac(e,a,r,s)}if(s!==void 0&&yo(s)){const[a,r]=Cc(this._automationEvents,i,o,s,this._defaultValue);return Nc(e,a,r,s)}return this._defaultValue}}const Rb=n=>({cancelTime:n,type:"cancelAndHold"}),xb=n=>({cancelTime:n,type:"cancelScheduledValues"}),Vb=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),Fb=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),zb=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),Wb=()=>new DOMException("","AbortError"),Lb=n=>(e,t,[s,i,o],a)=>{n(e[i],[t,s,o],r=>r[0]===t&&r[1]===s,a)},qb=n=>(e,t,s)=>{const i=[];for(let o=0;o<s.numberOfInputs;o+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},Bb=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Rs=new WeakSet,kh=new WeakMap,pa=new WeakMap,Th=new WeakMap,ga=new WeakMap,Xo=new WeakMap,Sh=new WeakMap,Hr=new WeakMap,Xr=new WeakMap,Yr=new WeakMap,Ch={construct(){return Ch}},Hb=n=>{try{const e=new Proxy(n,Ch);new e}catch{return!1}return!0},Ec=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Mc=(n,e)=>{const t=[];let s=n.replace(/^[\s]+/,""),i=s.match(Ec);for(;i!==null;){const o=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());t.push(a),s=s.slice(i[0].length).replace(/^[\s]+/,""),i=s.match(Ec)}return[t.join(";"),s]},Oc=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Dc=n=>{if(!Hb(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Xb=(n,e,t,s,i,o,a,r,l,c,u,h,f)=>{let d=0;return(m,g,_={credentials:"omit"})=>{const p=u.get(m);if(p!==void 0&&p.has(g))return Promise.resolve();const v=c.get(m);if(v!==void 0){const b=v.get(g);if(b!==void 0)return b}const y=o(m),k=y.audioWorklet===void 0?i(g).then(([b,N])=>{const[T,S]=Mc(b,N),M=`${T};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return t(M)}).then(()=>{const b=f._AWGS.pop();if(b===void 0)throw new SyntaxError;s(y.currentTime,y.sampleRate,()=>b(class{},void 0,(N,T)=>{if(N.trim()==="")throw e();const S=Xr.get(y);if(S!==void 0){if(S.has(N))throw e();Dc(T),Oc(T.parameterDescriptors),S.set(N,T)}else Dc(T),Oc(T.parameterDescriptors),Xr.set(y,new Map([[N,T]]))},y.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(n(h,h))]).then(([[b,N],T])=>{const S=d+1;d=S;const[M,O]=Mc(b,N),w=`${M};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${T?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${T?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${T?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,E=new Blob([w],{type:"application/javascript; charset=utf-8"}),A=URL.createObjectURL(E);return y.audioWorklet.addModule(A,_).then(()=>{if(r(y))return y;const R=a(y);return R.audioWorklet.addModule(A,_).then(()=>R)}).then(R=>{if(l===null)throw new SyntaxError;try{new l(R,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(A))});return v===void 0?c.set(m,new Map([[g,k]])):v.set(g,k),k.then(()=>{const b=u.get(m);b===void 0?u.set(m,new Set([g])):b.add(g)}).finally(()=>{const b=c.get(m);b!==void 0&&b.delete(g)}),k}},Zt=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},Yo=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[s]=t;return n.delete(s),s},Ah=(n,e,t,s)=>{const i=Zt(n,e),o=Yo(i,a=>a[0]===t&&a[1]===s);return i.size===0&&n.delete(e),o},yi=n=>Zt(Sh,n),xs=n=>{if(Rs.has(n))throw new Error("The AudioNode is already stored.");Rs.add(n),yi(n).forEach(e=>e(!0))},Nh=n=>"port"in n,bi=n=>{if(!Rs.has(n))throw new Error("The AudioNode is not stored.");Rs.delete(n),yi(n).forEach(e=>e(!1))},jr=(n,e)=>{!Nh(n)&&e.every(t=>t.size===0)&&bi(n)},Yb=(n,e,t,s,i,o,a,r,l,c,u,h,f)=>{const d=new WeakMap;return(m,g,_,p,v)=>{const{activeInputs:y,passiveInputs:k}=o(g),{outputs:b}=o(m),N=r(m),T=S=>{const M=l(g),O=l(m);if(S){const P=Ah(k,m,_,p);n(y,m,P,!1),!v&&!h(m)&&t(O,M,_,p),f(g)&&xs(g)}else{const P=s(y,m,_,p);e(k,p,P,!1),!v&&!h(m)&&i(O,M,_,p);const D=a(g);if(D===0)u(g)&&jr(g,y);else{const I=d.get(g);I!==void 0&&clearTimeout(I),d.set(g,setTimeout(()=>{u(g)&&jr(g,y)},D*1e3))}}};return c(b,[g,_,p],S=>S[0]===g&&S[1]===_&&S[2]===p,!0)?(N.add(T),u(m)?n(y,m,[_,p,T],!0):e(k,p,[m,_,T],!0),!0):!1}},jb=n=>(e,t,[s,i,o],a)=>{const r=e.get(s);r===void 0?e.set(s,new Set([[i,t,o]])):n(r,[i,t,o],l=>l[0]===i&&l[1]===t,a)},Ub=n=>(e,t)=>{const s=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(s).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(s),s.disconnect()};t.addEventListener("ended",i)},Gb=n=>(e,t)=>{n(e).add(t)},Zb={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Kb=(n,e,t,s,i,o)=>class extends n{constructor(r,l){const c=i(r),u={...Zb,...l},h=s(c,u),f=o(c)?e():null;super(r,!1,h,f),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(r){this._nativeAnalyserNode.fftSize=r}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(r){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=r,!(r>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(r){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=r,!(this._nativeAnalyserNode.maxDecibels>r))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(r){this._nativeAnalyserNode.smoothingTimeConstant=r}getByteFrequencyData(r){this._nativeAnalyserNode.getByteFrequencyData(r)}getByteTimeDomainData(r){this._nativeAnalyserNode.getByteTimeDomainData(r)}getFloatFrequencyData(r){this._nativeAnalyserNode.getFloatFrequencyData(r)}getFloatTimeDomainData(r){this._nativeAnalyserNode.getFloatTimeDomainData(r)}},gt=(n,e)=>n.context===e,Qb=(n,e,t)=>()=>{const s=new WeakMap,i=async(o,a)=>{let r=e(o);if(!gt(r,a)){const c={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,fftSize:r.fftSize,maxDecibels:r.maxDecibels,minDecibels:r.minDecibels,smoothingTimeConstant:r.smoothingTimeConstant};r=n(a,c)}return s.set(a,r),await t(o,a,r),r};return{render(o,a){const r=s.get(a);return r!==void 0?Promise.resolve(r):i(o,a)}}},wo=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},fn=()=>new DOMException("","IndexSizeError"),_a=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(s){throw s.code===12?fn():s}})(n.getChannelData)},Jb={numberOfChannels:1},$b=(n,e,t,s,i,o,a,r)=>{let l=null;return class Eh{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:f,sampleRate:d}={...Jb,...u};l===null&&(l=new i(1,1,44100));const m=s!==null&&e(o,o)?new s({length:h,numberOfChannels:f,sampleRate:d}):l.createBuffer(f,h,d);if(m.numberOfChannels===0)throw t();return typeof m.copyFromChannel!="function"?(a(m),_a(m)):e(wo,()=>wo(m))||r(m),n.add(m),m}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===Eh.prototype||n.has(u)}}},Tt=-34028234663852886e22,bt=-Tt,wn=n=>Rs.has(n),ew={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},tw=(n,e,t,s,i,o,a,r)=>class extends n{constructor(c,u){const h=o(c),f={...ew,...u},d=i(h,f),m=a(h),g=m?e():null;super(c,!1,d,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=t(this,m,d.playbackRate,bt,Tt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?r(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?c:h}get playbackRate(){return this._playbackRate}start(c=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(c,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[c,u]:[c,u,h]),this.context.state!=="closed"){xs(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),wn(this)&&bi(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},nw=(n,e,t,s,i)=>()=>{const o=new WeakMap;let a=null,r=null;const l=async(c,u)=>{let h=t(c);const f=gt(h,u);if(!f){const d={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,d),a!==null&&h.start(...a),r!==null&&h.stop(r)}return o.set(u,h),f?await n(u,c.playbackRate,h.playbackRate):await s(u,c.playbackRate,h.playbackRate),await i(c,u,h),h};return{set start(c){a=c},set stop(c){r=c},render(c,u){const h=o.get(u);return h!==void 0?Promise.resolve(h):l(c,u)}}},sw=n=>"playbackRate"in n,iw=n=>"frequency"in n&&"gain"in n,ow=n=>"offset"in n,rw=n=>!("frequency"in n)&&"gain"in n,aw=n=>"detune"in n&&"frequency"in n&&!("gain"in n),lw=n=>"pan"in n,wt=n=>Zt(kh,n),wi=n=>Zt(Th,n),Ur=(n,e)=>{const{activeInputs:t}=wt(n);t.forEach(i=>i.forEach(([o])=>{e.includes(n)||Ur(o,[...e,n])}));const s=sw(n)?[n.playbackRate]:Nh(n)?Array.from(n.parameters.values()):iw(n)?[n.Q,n.detune,n.frequency,n.gain]:ow(n)?[n.offset]:rw(n)?[n.gain]:aw(n)?[n.detune,n.frequency]:lw(n)?[n.pan]:[];for(const i of s){const o=wi(i);o!==void 0&&o.activeInputs.forEach(([a])=>Ur(a,e))}wn(n)&&bi(n)},Mh=n=>{Ur(n.destination,[])},cw=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),uw=(n,e,t,s,i,o,a,r,l)=>class extends n{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new l(u)}catch(m){throw m.code===12&&m.message==="sampleRate is not in range"?t():m}if(h===null)throw s();if(!cw(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw t();super(h,2);const{latencyHint:f}=u,{sampleRate:d}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=h,l.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const m=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",m)};h.addEventListener("statechange",m)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Mh(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new r(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},hw=(n,e,t,s,i,o,a,r)=>class extends n{constructor(c,u){const h=o(c),f=a(h),d=i(h,u,f),m=f?e(r):null;super(c,!1,d,m),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},fw=n=>{const e=new WeakMap,t=async(s,i)=>{const o=i.destination;return e.set(i,o),await n(s,i,o),o};return{render(s,i){const o=e.get(i);return o!==void 0?Promise.resolve(o):t(s,i)}}},dw=(n,e,t,s,i,o,a,r)=>(l,c)=>{const u=c.listener,h=()=>{const b=new Float32Array(1),N=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),T=a(c);let S=!1,M=[0,0,-1,0,1,0],O=[0,0,0];const P=()=>{if(S)return;S=!0;const E=s(c,256,9,0);E.onaudioprocess=({inputBuffer:A})=>{const R=[o(A,b,0),o(A,b,1),o(A,b,2),o(A,b,3),o(A,b,4),o(A,b,5)];R.some((F,L)=>F!==M[L])&&(u.setOrientation(...R),M=R);const z=[o(A,b,6),o(A,b,7),o(A,b,8)];z.some((F,L)=>F!==O[L])&&(u.setPosition(...z),O=z)},N.connect(E)},D=E=>A=>{A!==M[E]&&(M[E]=A,u.setOrientation(...M))},I=E=>A=>{A!==O[E]&&(O[E]=A,u.setPosition(...O))},w=(E,A,R)=>{const z=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:A});z.connect(N,0,E),z.start(),Object.defineProperty(z.offset,"defaultValue",{get(){return A}});const F=n({context:l},T,z.offset,bt,Tt);return r(F,"value",L=>()=>L.call(F),L=>q=>{try{L.call(F,q)}catch(H){if(H.code!==9)throw H}P(),T&&R(q)}),F.cancelAndHoldAtTime=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.cancelAndHoldAtTime),F.cancelScheduledValues=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.cancelScheduledValues),F.exponentialRampToValueAtTime=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.exponentialRampToValueAtTime),F.linearRampToValueAtTime=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.linearRampToValueAtTime),F.setTargetAtTime=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.setTargetAtTime),F.setValueAtTime=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.setValueAtTime),F.setValueCurveAtTime=(L=>T?()=>{throw i()}:(...q)=>{const H=L.apply(F,q);return P(),H})(F.setValueCurveAtTime),F};return{forwardX:w(0,0,D(0)),forwardY:w(1,0,D(1)),forwardZ:w(2,-1,D(2)),positionX:w(6,0,I(0)),positionY:w(7,0,I(1)),positionZ:w(8,0,I(2)),upX:w(3,0,D(3)),upY:w(4,1,D(4)),upZ:w(5,0,D(5))}},{forwardX:f,forwardY:d,forwardZ:m,positionX:g,positionY:_,positionZ:p,upX:v,upY:y,upZ:k}=u.forwardX===void 0?h():u;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return m},get positionX(){return g},get positionY(){return _},get positionZ(){return p},get upX(){return v},get upY(){return y},get upZ(){return k}}},vo=n=>"context"in n,vi=n=>vo(n[0]),es=(n,e,t,s)=>{for(const i of n)if(t(i)){if(s)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},Ic=(n,e,[t,s],i)=>{es(n,[e,t,s],o=>o[0]===e&&o[1]===t,i)},Pc=(n,[e,t,s],i)=>{const o=n.get(e);o===void 0?n.set(e,new Set([[t,s]])):es(o,[t,s],a=>a[0]===t,i)},qs=n=>"inputs"in n,ko=(n,e,t,s)=>{if(qs(e)){const i=e.inputs[s];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,s),[e,t,s]},Oh=(n,e,t)=>{for(const s of n)if(s[0]===e&&s[1]===t)return n.delete(s),s;return null},mw=(n,e,t)=>Yo(n,s=>s[0]===e&&s[1]===t),Dh=(n,e)=>{if(!yi(n).delete(e))throw new Error("Missing the expected event listener.")},Ih=(n,e,t)=>{const s=Zt(n,e),i=Yo(s,o=>o[0]===t);return s.size===0&&n.delete(e),i},To=(n,e,t,s)=>{qs(e)?n.disconnect(e.inputs[s],t,0):n.disconnect(e,t,s)},je=n=>Zt(pa,n),li=n=>Zt(ga,n),Kn=n=>Hr.has(n),Qi=n=>!Rs.has(n),Rc=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const s=n.createScriptProcessor(256,1,1),i=n.createGain(),o=n.createBuffer(1,2,44100),a=o.getChannelData(0);a[0]=1,a[1]=1;const r=n.createBufferSource();r.buffer=o,r.loop=!0,r.connect(s).connect(n.destination),r.connect(i),r.disconnect(i),s.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?t(!0):t(!1),r.stop(),s.onaudioprocess=null,r.disconnect(s),s.disconnect(n.destination)},r.start()}}),Sr=(n,e)=>{const t=new Map;for(const s of n)for(const i of s){const o=t.get(i);t.set(i,o===void 0?1:o+1)}t.forEach((s,i)=>e(i,s))},So=n=>"context"in n,pw=n=>{const e=new Map;n.connect=(t=>(s,i=0,o=0)=>{const a=So(s)?t(s,i,o):t(s,i),r=e.get(s);return r===void 0?e.set(s,[{input:o,output:i}]):r.every(l=>l.input!==o||l.output!==i)&&r.push({input:o,output:i}),a})(n.connect.bind(n)),n.disconnect=(t=>(s,i,o)=>{if(t.apply(n),s===void 0)e.clear();else if(typeof s=="number")for(const[a,r]of e){const l=r.filter(c=>c.output!==s);l.length===0?e.delete(a):e.set(a,l)}else if(e.has(s))if(i===void 0)e.delete(s);else{const a=e.get(s);if(a!==void 0){const r=a.filter(l=>l.output!==i&&(l.input!==o||o===void 0));r.length===0?e.delete(s):e.set(s,r)}}for(const[a,r]of e)r.forEach(l=>{So(a)?n.connect(a,l.output,l.input):n.connect(a,l.output)})})(n.disconnect)},gw=(n,e,t,s)=>{const{activeInputs:i,passiveInputs:o}=wi(e),{outputs:a}=wt(n),r=yi(n),l=c=>{const u=je(n),h=li(e);if(c){const f=Ih(o,n,t);Ic(i,n,f,!1),!s&&!Kn(n)&&u.connect(h,t)}else{const f=mw(i,n,t);Pc(o,f,!1),!s&&!Kn(n)&&u.disconnect(h,t)}};return es(a,[e,t],c=>c[0]===e&&c[1]===t,!0)?(r.add(l),wn(n)?Ic(i,n,[t,l],!0):Pc(o,[n,t,l],!0),!0):!1},_w=(n,e,t,s)=>{const{activeInputs:i,passiveInputs:o}=wt(e),a=Oh(i[s],n,t);return a===null?[Ah(o,n,t,s)[2],!1]:[a[2],!0]},yw=(n,e,t)=>{const{activeInputs:s,passiveInputs:i}=wi(e),o=Oh(s,n,t);return o===null?[Ih(i,n,t)[1],!1]:[o[2],!0]},ya=(n,e,t,s,i)=>{const[o,a]=_w(n,t,s,i);if(o!==null&&(Dh(n,o),a&&!e&&!Kn(n)&&To(je(n),je(t),s,i)),wn(t)){const{activeInputs:r}=wt(t);jr(t,r)}},ba=(n,e,t,s)=>{const[i,o]=yw(n,t,s);i!==null&&(Dh(n,i),o&&!e&&!Kn(n)&&je(n).disconnect(li(t),s))},bw=(n,e)=>{const t=wt(n),s=[];for(const i of t.outputs)vi(i)?ya(n,e,...i):ba(n,e,...i),s.push(i[0]);return t.outputs.clear(),s},ww=(n,e,t)=>{const s=wt(n),i=[];for(const o of s.outputs)o[1]===t&&(vi(o)?ya(n,e,...o):ba(n,e,...o),i.push(o[0]),s.outputs.delete(o));return i},vw=(n,e,t,s,i)=>{const o=wt(n);return Array.from(o.outputs).filter(a=>a[0]===t&&(s===void 0||a[1]===s)&&(i===void 0||a[2]===i)).map(a=>(vi(a)?ya(n,e,...a):ba(n,e,...a),o.outputs.delete(a),a[0]))},kw=(n,e,t,s,i,o,a,r,l,c,u,h,f,d,m,g)=>class extends c{constructor(p,v,y,k){super(y),this._context=p,this._nativeAudioNode=y;const b=u(p);h(b)&&t(Rc,()=>Rc(b,g))!==!0&&pw(y),pa.set(this,y),Sh.set(this,new Set),p.state!=="closed"&&v&&xs(this),n(this,k,y)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(p){this._nativeAudioNode.channelCount=p}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(p){this._nativeAudioNode.channelCountMode=p}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(p){this._nativeAudioNode.channelInterpretation=p}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(p,v=0,y=0){if(v<0||v>=this._nativeAudioNode.numberOfOutputs)throw i();const k=u(this._context),b=m(k);if(f(p)||d(p))throw o();if(vo(p)){const S=je(p);try{const O=ko(this._nativeAudioNode,S,v,y),P=Qi(this);(b||P)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!P&&Qi(p)&&xs(p)}catch(O){throw O.code===12?o():O}if(e(this,p,v,y,b)){const O=l([this],p);Sr(O,s(b))}return p}const N=li(p);if(N.name==="playbackRate"&&N.maxValue===1024)throw a();try{this._nativeAudioNode.connect(N,v),(b||Qi(this))&&this._nativeAudioNode.disconnect(N,v)}catch(S){throw S.code===12?o():S}if(gw(this,p,v,b)){const S=l([this],p);Sr(S,s(b))}}disconnect(p,v,y){let k;const b=u(this._context),N=m(b);if(p===void 0)k=bw(this,N);else if(typeof p=="number"){if(p<0||p>=this.numberOfOutputs)throw i();k=ww(this,N,p)}else{if(v!==void 0&&(v<0||v>=this.numberOfOutputs)||vo(p)&&y!==void 0&&(y<0||y>=p.numberOfInputs))throw i();if(k=vw(this,N,p,v,y),k.length===0)throw o()}for(const T of k){const S=l([this],T);Sr(S,r)}}},Tw=(n,e,t,s,i,o,a,r,l,c,u,h,f)=>(d,m,g,_=null,p=null)=>{const v=g.value,y=new Pb(v),k=m?s(y):null,b={get defaultValue(){return v},get maxValue(){return _===null?g.maxValue:_},get minValue(){return p===null?g.minValue:p},get value(){return g.value},set value(N){g.value=N,b.setValueAtTime(N,d.context.currentTime)},cancelAndHoldAtTime(N){if(typeof g.cancelAndHoldAtTime=="function")k===null&&y.flush(d.context.currentTime),y.add(i(N)),g.cancelAndHoldAtTime(N);else{const T=Array.from(y).pop();k===null&&y.flush(d.context.currentTime),y.add(i(N));const S=Array.from(y).pop();g.cancelScheduledValues(N),T!==S&&S!==void 0&&(S.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(S.value,S.endTime):S.type==="linearRampToValue"?g.linearRampToValueAtTime(S.value,S.endTime):S.type==="setValue"?g.setValueAtTime(S.value,S.startTime):S.type==="setValueCurve"&&g.setValueCurveAtTime(S.values,S.startTime,S.duration))}return b},cancelScheduledValues(N){return k===null&&y.flush(d.context.currentTime),y.add(o(N)),g.cancelScheduledValues(N),b},exponentialRampToValueAtTime(N,T){if(N===0)throw new RangeError;if(!Number.isFinite(T)||T<0)throw new RangeError;const S=d.context.currentTime;return k===null&&y.flush(S),Array.from(y).length===0&&(y.add(c(v,S)),g.setValueAtTime(v,S)),y.add(a(N,T)),g.exponentialRampToValueAtTime(N,T),b},linearRampToValueAtTime(N,T){const S=d.context.currentTime;return k===null&&y.flush(S),Array.from(y).length===0&&(y.add(c(v,S)),g.setValueAtTime(v,S)),y.add(r(N,T)),g.linearRampToValueAtTime(N,T),b},setTargetAtTime(N,T,S){return k===null&&y.flush(d.context.currentTime),y.add(l(N,T,S)),g.setTargetAtTime(N,T,S),b},setValueAtTime(N,T){return k===null&&y.flush(d.context.currentTime),y.add(c(N,T)),g.setValueAtTime(N,T),b},setValueCurveAtTime(N,T,S){const M=N instanceof Float32Array?N:new Float32Array(N);if(h!==null&&h.name==="webkitAudioContext"){const O=T+S,P=d.context.sampleRate,D=Math.ceil(T*P),I=Math.floor(O*P),w=I-D,E=new Float32Array(w);for(let R=0;R<w;R+=1){const z=(M.length-1)/S*((D+R)/P-T),F=Math.floor(z),L=Math.ceil(z);E[R]=F===L?M[F]:(1-(z-F))*M[F]+(1-(L-z))*M[L]}k===null&&y.flush(d.context.currentTime),y.add(u(E,T,S)),g.setValueCurveAtTime(E,T,S);const A=I/P;A<O&&f(b,E[E.length-1],A),f(b,M[M.length-1],O)}else k===null&&y.flush(d.context.currentTime),y.add(u(M,T,S)),g.setValueCurveAtTime(M,T,S);return b}};return t.set(b,g),e.set(b,d),n(b,k),b},Sw=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:s,value:i}=t;e.exponentialRampToValueAtTime(i,s)}else if(t.type==="linearRampToValue"){const{endTime:s,value:i}=t;e.linearRampToValueAtTime(i,s)}else if(t.type==="setTarget"){const{startTime:s,target:i,timeConstant:o}=t;e.setTargetAtTime(i,s,o)}else if(t.type==="setValue"){const{startTime:s,value:i}=t;e.setValueAtTime(i,s)}else if(t.type==="setValueCurve"){const{duration:s,startTime:i,values:o}=t;e.setValueCurveAtTime(o,i,s)}else throw new Error("Can't apply an unknown automation.")}});class Ph{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((s,i)=>e.call(t,s,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Cw={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Aw=(n,e,t,s,i,o,a,r,l,c,u,h,f,d)=>class extends e{constructor(g,_,p){var v;const y=r(g),k=l(y),b=u({...Cw,...p});f(b);const N=Xr.get(y),T=N==null?void 0:N.get(_),S=k||y.state!=="closed"?y:(v=a(y))!==null&&v!==void 0?v:y,M=i(S,k?null:g.baseLatency,c,_,T,b),O=k?s(_,b,T):null;super(g,!0,M,O);const P=[];M.parameters.forEach((I,w)=>{const E=t(this,k,I);P.push([w,E])}),this._nativeAudioWorkletNode=M,this._onprocessorerror=null,this._parameters=new Ph(P),k&&n(y,this);const{activeInputs:D}=o(this);h(M,D)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const _=typeof g=="function"?d(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=_;const p=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=p!==null&&p===_?g:p}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Co(n,e,t,s,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],s,i);else{const o=n.getChannelData(s);if(e[t].byteLength===0)e[t]=o.slice(i,i+128);else{const a=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const Rh=(n,e,t,s,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],s,i):e[t].byteLength!==0&&n.getChannelData(s).set(e[t],i)},Ao=(n,e)=>{const t=[];for(let s=0;s<n;s+=1){const i=[],o=typeof e=="number"?e:e[s];for(let a=0;a<o;a+=1)i.push(new Float32Array(128));t.push(i)}return t},Nw=(n,e)=>{const t=Zt(Yr,n),s=je(e);return Zt(t,s)},Ew=async(n,e,t,s,i,o,a)=>{const r=e===null?Math.ceil(n.context.length/128)*128:e.length,l=s.channelCount*s.numberOfInputs,c=i.reduce((_,p)=>_+p,0),u=c===0?null:t.createBuffer(c,r,t.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const h=wt(n),f=await Nw(t,n),d=Ao(s.numberOfInputs,s.channelCount),m=Ao(s.numberOfOutputs,i),g=Array.from(n.parameters.keys()).reduce((_,p)=>({..._,[p]:new Float32Array(128)}),{});for(let _=0;_<r;_+=128){if(s.numberOfInputs>0&&e!==null)for(let p=0;p<s.numberOfInputs;p+=1)for(let v=0;v<s.channelCount;v+=1)Co(e,d[p],v,v,_);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:p},v)=>{Co(e,g,p,l+v,_)});for(let p=0;p<s.numberOfInputs;p+=1)for(let v=0;v<i[p];v+=1)m[p][v].byteLength===0&&(m[p][v]=new Float32Array(128));try{const p=d.map((y,k)=>h.activeInputs[k].size===0?[]:y),v=a(_/t.sampleRate,t.sampleRate,()=>f.process(p,m,g));if(u!==null)for(let y=0,k=0;y<s.numberOfOutputs;y+=1){for(let b=0;b<i[y];b+=1)Rh(u,m[y],b,k+b,_);k+=i[y]}if(!v)break}catch(p){n.dispatchEvent(new ErrorEvent("processorerror",{colno:p.colno,filename:p.filename,lineno:p.lineno,message:p.message}));break}}return u},Mw=(n,e,t,s,i,o,a,r,l,c,u,h,f,d,m,g)=>(_,p,v)=>{const y=new WeakMap;let k=null;const b=async(N,T)=>{let S=u(N),M=null;const O=gt(S,T),P=Array.isArray(p.outputChannelCount)?p.outputChannelCount:Array.from(p.outputChannelCount);if(h===null){const D=P.reduce((A,R)=>A+R,0),I=i(T,{channelCount:Math.max(1,D),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,D)}),w=[];for(let A=0;A<N.numberOfOutputs;A+=1)w.push(s(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:P[A]}));const E=a(T,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:1});E.connect=e.bind(null,w),E.disconnect=l.bind(null,w),M=[I,w,E]}else O||(S=new h(T,_));if(y.set(T,M===null?S:M[2]),M!==null){if(k===null){if(v===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const R=N.channelCount*N.numberOfInputs,z=v.parameterDescriptors===void 0?0:v.parameterDescriptors.length,F=R+z;k=Ew(N,F===0?null:await(async()=>{const q=new f(F,Math.ceil(N.context.length/128)*128,T.sampleRate),H=[],j=[];for(let re=0;re<p.numberOfInputs;re+=1)H.push(a(q,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:1})),j.push(i(q,{channelCount:p.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:p.channelCount}));const B=await Promise.all(Array.from(N.parameters.values()).map(async re=>{const J=o(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:re.value});return await d(q,re,J.offset),J})),te=s(q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,R+z)});for(let re=0;re<p.numberOfInputs;re+=1){H[re].connect(j[re]);for(let J=0;J<p.channelCount;J+=1)j[re].connect(te,J,re*p.channelCount+J)}for(const[re,J]of B.entries())J.connect(te,0,R+re),J.start(0);return te.connect(q.destination),await Promise.all(H.map(re=>m(N,q,re))),g(q)})(),T,p,P,v,c)}const D=await k,I=t(T,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[w,E,A]=M;D!==null&&(I.buffer=D,I.start(0)),I.connect(w);for(let R=0,z=0;R<N.numberOfOutputs;R+=1){const F=E[R];for(let L=0;L<P[R];L+=1)w.connect(F,z+L,L);z+=P[R]}return A}if(O)for(const[D,I]of N.parameters.entries())await n(T,I,S.parameters.get(D));else for(const[D,I]of N.parameters.entries())await d(T,I,S.parameters.get(D));return await m(N,T,S),S};return{render(N,T){r(T,N);const S=y.get(T);return S!==void 0?Promise.resolve(S):b(N,T)}}},Ow=(n,e,t,s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y)=>class extends m{constructor(b,N){super(b,N),this._nativeContext=b,this._audioWorklet=n===void 0?void 0:{addModule:(T,S)=>n(this,T,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(b,N,T){return new t({length:N,numberOfChannels:b,sampleRate:T})}createBufferSource(){return new s(this)}createChannelMerger(b=6){return new o(this,{numberOfInputs:b})}createChannelSplitter(b=6){return new a(this,{numberOfOutputs:b})}createConstantSource(){return new r(this)}createConvolver(){return new l(this)}createDelay(b=1){return new u(this,{maxDelayTime:b})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(b,N){return new d(this,{feedback:N,feedforward:b})}createOscillator(){return new g(this)}createPanner(){return new _(this)}createPeriodicWave(b,N,T={disableNormalization:!1}){return new p(this,{...T,imag:N,real:b})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(b,N,T){return c(this._nativeContext,b).then(S=>(typeof N=="function"&&N(S),S),S=>{throw typeof T=="function"&&T(S),S})}},Dw={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Iw=(n,e,t,s,i,o,a,r)=>class extends n{constructor(c,u){const h=o(c),f={...Dw,...u},d=i(h,f),m=a(h),g=m?t():null;super(c,!1,d,g),this._Q=e(this,m,d.Q,bt,Tt),this._detune=e(this,m,d.detune,1200*Math.log2(bt),-1200*Math.log2(bt)),this._frequency=e(this,m,d.frequency,c.sampleRate/2,0),this._gain=e(this,m,d.gain,40*Math.log10(bt),Tt),this._nativeBiquadFilterNode=d,r(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,h)}catch(f){throw f.code===11?s():f}if(c.length!==u.length||u.length!==h.length)throw s()}},Pw=(n,e,t,s,i)=>()=>{const o=new WeakMap,a=async(r,l)=>{let c=t(r);const u=gt(c,l);if(!u){const h={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,h)}return o.set(l,c),u?(await n(l,r.Q,c.Q),await n(l,r.detune,c.detune),await n(l,r.frequency,c.frequency),await n(l,r.gain,c.gain)):(await s(l,r.Q,c.Q),await s(l,r.detune,c.detune),await s(l,r.frequency,c.frequency),await s(l,r.gain,c.gain)),await i(r,l,c),c};return{render(r,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):a(r,l)}}},Rw=(n,e)=>(t,s)=>{const i=e.get(t);if(i!==void 0)return i;const o=n.get(t);if(o!==void 0)return o;try{const a=s();return a instanceof Promise?(n.set(t,a),a.catch(()=>!1).then(r=>(n.delete(t),e.set(t,r),r))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},xw={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Vw=(n,e,t,s,i)=>class extends n{constructor(a,r){const l=s(a),c={...xw,...r},u=t(l,c),h=i(l)?e():null;super(a,!1,u,h)}},Fw=(n,e,t)=>()=>{const s=new WeakMap,i=async(o,a)=>{let r=e(o);if(!gt(r,a)){const c={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfInputs:r.numberOfInputs};r=n(a,c)}return s.set(a,r),await t(o,a,r),r};return{render(o,a){const r=s.get(a);return r!==void 0?Promise.resolve(r):i(o,a)}}},zw={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Ww=(n,e,t,s,i,o)=>class extends n{constructor(r,l){const c=s(r),u=o({...zw,...l}),h=t(c,u),f=i(c)?e():null;super(r,!1,h,f)}},Lw=(n,e,t)=>()=>{const s=new WeakMap,i=async(o,a)=>{let r=e(o);if(!gt(r,a)){const c={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfOutputs:r.numberOfOutputs};r=n(a,c)}return s.set(a,r),await t(o,a,r),r};return{render(o,a){const r=s.get(a);return r!==void 0?Promise.resolve(r):i(o,a)}}},qw=n=>(e,t,s)=>n(t,e,s),Bw=n=>(e,t,s=0,i=0)=>{const o=e[s];if(o===void 0)throw n();return So(t)?o.connect(t,0,i):o.connect(t,0)},Hw=n=>(e,t)=>{const s=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return s.buffer=i,s.loop=!0,s.connect(t),s.start(),()=>{s.stop(),s.disconnect(t)}},Xw={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Yw=(n,e,t,s,i,o,a)=>class extends n{constructor(l,c){const u=i(l),h={...Xw,...c},f=s(u,h),d=o(u),m=d?t():null;super(l,!1,f,m),this._constantSourceNodeRenderer=m,this._nativeConstantSourceNode=f,this._offset=e(this,d,f.offset,bt,Tt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){xs(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),wn(this)&&bi(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},jw=(n,e,t,s,i)=>()=>{const o=new WeakMap;let a=null,r=null;const l=async(c,u)=>{let h=t(c);const f=gt(h,u);if(!f){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,d),a!==null&&h.start(a),r!==null&&h.stop(r)}return o.set(u,h),f?await n(u,c.offset,h.offset):await s(u,c.offset,h.offset),await i(c,u,h),h};return{set start(c){a=c},set stop(c){r=c},render(c,u){const h=o.get(u);return h!==void 0?Promise.resolve(h):l(c,u)}}},Uw=n=>e=>(n[0]=e,n[0]),Gw={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Zw=(n,e,t,s,i,o)=>class extends n{constructor(r,l){const c=s(r),u={...Gw,...l},h=t(c,u),d=i(c)?e():null;super(r,!1,h,d),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&o(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(r){if(this._nativeConvolverNode.buffer=r,r===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(r){this._nativeConvolverNode.normalize=r}},Kw=(n,e,t)=>()=>{const s=new WeakMap,i=async(o,a)=>{let r=e(o);if(!gt(r,a)){const c={buffer:r.buffer,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,disableNormalization:!r.normalize};r=n(a,c)}return s.set(a,r),qs(r)?await t(o,a,r.inputs[0]):await t(o,a,r),r};return{render(o,a){const r=s.get(a);return r!==void 0?Promise.resolve(r):i(o,a)}}},Qw=(n,e)=>(t,s,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,s,i)}catch(o){throw o.name==="SyntaxError"?n():o}},Jw=()=>new DOMException("","DataCloneError"),xc=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(s=>{const i=()=>{t.onmessage=null,e.close(),t.close(),s()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},$w=(n,e,t,s,i,o,a,r,l,c,u)=>(h,f)=>{const d=a(h)?h:o(h);if(i.has(f)){const m=t();return Promise.reject(m)}try{i.add(f)}catch{}return e(l,()=>l(d))?d.decodeAudioData(f).then(m=>(xc(f).catch(()=>{}),e(r,()=>r(m))||u(m),n.add(m),m)):new Promise((m,g)=>{const _=async()=>{try{await xc(f)}catch{}},p=v=>{g(v),_()};try{d.decodeAudioData(f,v=>{typeof v.copyFromChannel!="function"&&(c(v),_a(v)),n.add(v),_().then(()=>m(v))},v=>{p(v===null?s():v)})}catch(v){p(v)}})},ev=(n,e,t,s,i,o,a,r)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=o(l.context),f=r(h);if(u===c){if(e.delete(l),!f&&a(l)){const d=s(l),{outputs:m}=t(l);for(const g of m)if(vi(g)){const _=s(g[0]);n(d,_,g[1],g[2])}else{const _=i(g[0]);d.connect(_,g[1])}}}else e.set(l,u-c)},tv={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},nv=(n,e,t,s,i,o,a)=>class extends n{constructor(l,c){const u=i(l),h={...tv,...c},f=s(u,h),d=o(u),m=d?t(h.maxDelayTime):null;super(l,!1,f,m),this._delayTime=e(this,d,f.delayTime),a(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},sv=(n,e,t,s,i)=>o=>{const a=new WeakMap,r=async(l,c)=>{let u=t(l);const h=gt(u,c);if(!h){const f={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,f)}return a.set(c,u),h?await n(c,l.delayTime,u.delayTime):await s(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=a.get(c);return u!==void 0?Promise.resolve(u):r(l,c)}}},iv=n=>(e,t,s,i)=>n(e[i],o=>o[0]===t&&o[1]===s),ov=n=>(e,t)=>{n(e).delete(t)},rv=n=>"delayTime"in n,av=(n,e,t)=>function s(i,o){const a=vo(o)?o:t(n,o);if(rv(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:r}=e(a);return Array.from(r).map(l=>s([...i,a],l[0])).reduce((l,c)=>l.concat(c),[])},Hi=(n,e,t)=>{const s=e[t];if(s===void 0)throw n();return s},lv=n=>(e,t=void 0,s=void 0,i=0)=>t===void 0?e.forEach(o=>o.disconnect()):typeof t=="number"?Hi(n,e,t).disconnect():So(t)?s===void 0?e.forEach(o=>o.disconnect(t)):i===void 0?Hi(n,e,s).disconnect(t,0):Hi(n,e,s).disconnect(t,0,i):s===void 0?e.forEach(o=>o.disconnect(t)):Hi(n,e,s).disconnect(t,0),cv={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},uv=(n,e,t,s,i,o,a,r)=>class extends n{constructor(c,u){const h=o(c),f={...cv,...u},d=s(h,f),m=a(h),g=m?t():null;super(c,!1,d,g),this._attack=e(this,m,d.attack),this._knee=e(this,m,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=e(this,m,d.ratio),this._release=e(this,m,d.release),this._threshold=e(this,m,d.threshold),r(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},hv=(n,e,t,s,i)=>()=>{const o=new WeakMap,a=async(r,l)=>{let c=t(r);const u=gt(c,l);if(!u){const h={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,h)}return o.set(l,c),u?(await n(l,r.attack,c.attack),await n(l,r.knee,c.knee),await n(l,r.ratio,c.ratio),await n(l,r.release,c.release),await n(l,r.threshold,c.threshold)):(await s(l,r.attack,c.attack),await s(l,r.knee,c.knee),await s(l,r.ratio,c.ratio),await s(l,r.release,c.release),await s(l,r.threshold,c.threshold)),await i(r,l,c),c};return{render(r,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):a(r,l)}}},fv=()=>new DOMException("","EncodingError"),dv=n=>e=>new Promise((t,s)=>{if(n===null){s(new SyntaxError);return}const i=n.document.head;if(i===null)s(new SyntaxError);else{const o=n.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),r=URL.createObjectURL(a),l=n.onerror,c=()=>{n.onerror=l,URL.revokeObjectURL(r)};n.onerror=(u,h,f,d,m)=>{if(h===r||h===n.location.href&&f===1&&d===1)return c(),s(m),!1;if(l!==null)return l(u,h,f,d,m)},o.onerror=()=>{c(),s(new SyntaxError)},o.onload=()=>{c(),t()},o.src=r,o.type="module",i.appendChild(o)}}),mv=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,s,i){if(s!==null){let o=this._listeners.get(s);o===void 0&&(o=n(this,s),typeof s=="function"&&this._listeners.set(s,o)),this._nativeEventTarget.addEventListener(t,o,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,s,i){const o=s===null?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(t,o===void 0?null:o,i)}},pv=n=>(e,t,s)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return s()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},gv=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},_v={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},yv=(n,e,t,s,i,o)=>class extends n{constructor(r,l){const c=i(r),u={..._v,...l},h=s(c,u),f=o(c),d=f?t():null;super(r,!1,h,d),this._gain=e(this,f,h.gain,bt,Tt)}get gain(){return this._gain}},bv=(n,e,t,s,i)=>()=>{const o=new WeakMap,a=async(r,l)=>{let c=t(r);const u=gt(c,l);if(!u){const h={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,h)}return o.set(l,c),u?await n(l,r.gain,c.gain):await s(l,r.gain,c.gain),await i(r,l,c),c};return{render(r,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):a(r,l)}}},wv=(n,e)=>t=>e(n,t),vv=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},kv=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},Tv=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},Sv=n=>e=>n.get(e),dt=()=>new DOMException("","InvalidStateError"),Cv=n=>e=>{const t=n.get(e);if(t===void 0)throw dt();return t},Av=(n,e)=>t=>{let s=n.get(t);if(s!==void 0)return s;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,44100),n.set(t,s),s},Nv=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},jo=()=>new DOMException("","InvalidAccessError"),Ev=n=>{n.getFrequencyResponse=(e=>(t,s,i)=>{if(t.length!==s.length||s.length!==i.length)throw jo();return e.call(n,t,s,i)})(n.getFrequencyResponse)},Mv={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Ov=(n,e,t,s,i,o)=>class extends n{constructor(r,l){const c=s(r),u=i(c),h={...Mv,...l},f=e(c,u?null:r.baseLatency,h),d=u?t(h.feedback,h.feedforward):null;super(r,!1,f,d),Ev(f),this._nativeIIRFilterNode=f,o(this,1)}getFrequencyResponse(r,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(r,l,c)}},xh=(n,e,t,s,i,o,a,r,l,c,u)=>{const h=c.length;let f=r;for(let d=0;d<h;d+=1){let m=t[0]*c[d];for(let g=1;g<i;g+=1){const _=f-g&l-1;m+=t[g]*o[_],m-=n[g]*a[_]}for(let g=i;g<s;g+=1)m+=t[g]*o[f-g&l-1];for(let g=i;g<e;g+=1)m-=n[g]*a[f-g&l-1];o[f]=c[d],a[f]=m,f=f+1&l-1,u[d]=m}return f},Dv=(n,e,t,s)=>{const i=t instanceof Float64Array?t:new Float64Array(t),o=s instanceof Float64Array?s:new Float64Array(s),a=i.length,r=o.length,l=Math.min(a,r);if(i[0]!==1){for(let m=0;m<a;m+=1)o[m]/=i[0];for(let m=1;m<r;m+=1)i[m]/=i[0]}const c=32,u=new Float32Array(c),h=new Float32Array(c),f=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),d=n.numberOfChannels;for(let m=0;m<d;m+=1){const g=n.getChannelData(m),_=f.getChannelData(m);u.fill(0),h.fill(0),xh(i,a,o,r,l,u,h,0,c,g,_)}return f},Iv=(n,e,t,s,i)=>(o,a)=>{const r=new WeakMap;let l=null;const c=async(u,h)=>{let f=null,d=e(u);const m=gt(d,h);if(h.createIIRFilter===void 0?f=n(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(d=h.createIIRFilter(a,o)),r.set(h,f===null?d:f),f!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const _=new t(u.context.destination.channelCount,u.context.length,h.sampleRate);l=(async()=>{await s(u,_,_.destination);const p=await i(_);return Dv(p,h,o,a)})()}const g=await l;return f.buffer=g,f.start(0),f}return await s(u,h,d),d};return{render(u,h){const f=r.get(h);return f!==void 0?Promise.resolve(f):c(u,h)}}},Pv=(n,e,t,s,i,o)=>a=>(r,l)=>{const c=n.get(r);if(c===void 0){if(!a&&o(r)){const u=s(r),{outputs:h}=t(r);for(const f of h)if(vi(f)){const d=s(f[0]);e(u,d,f[1],f[2])}else{const d=i(f[0]);u.disconnect(d,f[1])}}n.set(r,l)}else n.set(r,c+l)},Rv=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},xv=(n,e)=>t=>n.has(t)||e(t),Vv=(n,e)=>t=>n.has(t)||e(t),Fv=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},zv=n=>e=>n!==null&&e instanceof n,Wv=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,Lv=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,qv=(n,e)=>t=>n(t)||e(t),Bv=n=>e=>n!==null&&e instanceof n,Hv=n=>n!==null&&n.isSecureContext,Xv=(n,e,t,s)=>class extends n{constructor(o,a){const r=t(o),l=e(r,a);if(s(r))throw TypeError();super(o,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},Yv={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},jv=(n,e,t,s)=>class extends n{constructor(o,a){const r=t(o);if(s(r))throw new TypeError;const l={...Yv,...a},c=e(r,l);super(o,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Uv=(n,e,t,s)=>class extends n{constructor(o,a){const r=t(o),l=e(r,a);if(s(r))throw new TypeError;super(o,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Gv=(n,e,t)=>class extends n{constructor(i,o){const a=t(i),r=e(a,o);super(i,!0,r,null)}},Zv=(n,e,t,s,i,o)=>class extends t{constructor(r,l){super(r),this._nativeContext=r,Xo.set(this,r),s(r)&&i.set(r,new Set),this._destination=new n(this,l),this._listener=e(this,r),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(r){const l=typeof r=="function"?o(this,r):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?r:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},ci=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},Kv=(n,e)=>(t,s,i)=>{const o=new Set;return t.connect=(a=>(r,l=0,c=0)=>{const u=o.size===0;if(e(r))return a.call(t,r,l,c),n(o,[r,l,c],h=>h[0]===r&&h[1]===l&&h[2]===c,!0),u&&s(),r;a.call(t,r,l),n(o,[r,l],h=>h[0]===r&&h[1]===l,!0),u&&s()})(t.connect),t.disconnect=(a=>(r,l,c)=>{const u=o.size>0;if(r===void 0)a.apply(t),o.clear();else if(typeof r=="number"){a.call(t,r);for(const f of o)f[1]===r&&o.delete(f)}else{e(r)?a.call(t,r,l,c):a.call(t,r,l);for(const f of o)f[0]===r&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&o.delete(f)}const h=o.size===0;u&&h&&i()})(t.disconnect),t},Ge=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t]&&(n[t]=s)},ft=(n,e)=>{Ge(n,e,"channelCount"),Ge(n,e,"channelCountMode"),Ge(n,e,"channelInterpretation")},Vc=n=>typeof n.getFloatTimeDomainData=="function",Qv=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const s=Math.max(t.length,n.fftSize);for(let i=0;i<s;i+=1)e[i]=(t[i]-128)*.0078125;return e}},Jv=(n,e)=>(t,s)=>{const i=t.createAnalyser();if(ft(i,s),!(s.maxDecibels>s.minDecibels))throw e();return Ge(i,s,"fftSize"),Ge(i,s,"maxDecibels"),Ge(i,s,"minDecibels"),Ge(i,s,"smoothingTimeConstant"),n(Vc,()=>Vc(i))||Qv(i),i},$v=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,Qe=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t].value&&(n[t].value=s)},e2=n=>{n.start=(e=>{let t=!1;return(s=0,i=0,o)=>{if(t)throw dt();e.call(n,s,i,o),t=!0}})(n.start)},wa=n=>{n.start=(e=>(t=0,s=0,i)=>{if(typeof i=="number"&&i<0||s<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,s,i)})(n.start)},va=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},t2=(n,e,t,s,i,o,a,r,l,c,u)=>(h,f)=>{const d=h.createBufferSource();return ft(d,f),Qe(d,f,"playbackRate"),Ge(d,f,"buffer"),Ge(d,f,"loop"),Ge(d,f,"loopEnd"),Ge(d,f,"loopStart"),e(t,()=>t(h))||e2(d),e(s,()=>s(h))||l(d),e(i,()=>i(h))||c(d,h),e(o,()=>o(h))||wa(d),e(a,()=>a(h))||u(d,h),e(r,()=>r(h))||va(d),n(h,d),d},n2=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,s2=(n,e)=>(t,s,i)=>{const o=t.destination;if(o.channelCount!==s)try{o.channelCount=s}catch{}i&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:s});const a=n(t,{channelCount:s,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(a,"channelCount",r=>()=>r.call(a),r=>l=>{r.call(a,l);try{o.channelCount=l}catch(c){if(l>o.maxChannelCount)throw c}}),e(a,"channelCountMode",r=>()=>r.call(a),r=>l=>{r.call(a,l),o.channelCountMode=l}),e(a,"channelInterpretation",r=>()=>r.call(a),r=>l=>{r.call(a,l),o.channelInterpretation=l}),Object.defineProperty(a,"maxChannelCount",{get:()=>o.maxChannelCount}),a.connect(o),a},i2=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,o2=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},r2=(n,e,t,s,i)=>(o,a,r,l,c,u)=>{if(r!==null)try{const h=new r(o,l,u),f=new Map;let d=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>d,set:m=>{typeof d=="function"&&h.removeEventListener("processorerror",d),d=typeof m=="function"?m:null,typeof d=="function"&&h.addEventListener("processorerror",d)}}}),h.addEventListener=(m=>(...g)=>{if(g[0]==="processorerror"){const _=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(_!==null){const p=f.get(g[1]);p!==void 0?g[1]=p:(g[1]=v=>{v.type==="error"?(Object.defineProperties(v,{type:{value:"processorerror"}}),_(v)):_(new ErrorEvent(g[0],{...v}))},f.set(_,g[1]))}}return m.call(h,"error",g[1],g[2]),m.call(h,...g)})(h.addEventListener),h.removeEventListener=(m=>(...g)=>{if(g[0]==="processorerror"){const _=f.get(g[1]);_!==void 0&&(f.delete(g[1]),g[1]=_)}return m.call(h,"error",g[1],g[2]),m.call(h,g[0],g[1],g[2])})(h.removeEventListener),u.numberOfOutputs!==0){const m=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(m).connect(o.destination),i(h,()=>m.disconnect(),()=>m.connect(o.destination))}return h}catch(h){throw h.code===11?s():h}if(c===void 0)throw s();return o2(u),e(o,a,c,u)},Vh=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),a2=n=>new Promise((e,t)=>{const{port1:s,port2:i}=new MessageChannel;s.onmessage=({data:o})=>{s.close(),i.close(),e(o)},s.onmessageerror=({data:o})=>{s.close(),i.close(),t(o)},i.postMessage(n)}),l2=async(n,e)=>{const t=await a2(e);return new n(t)},c2=(n,e,t,s)=>{let i=Yr.get(n);i===void 0&&(i=new WeakMap,Yr.set(n,i));const o=l2(t,s);return i.set(e,o),o},u2=(n,e,t,s,i,o,a,r,l,c,u,h,f)=>(d,m,g,_)=>{if(_.numberOfInputs===0&&_.numberOfOutputs===0)throw l();const p=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(p.some($=>$<1))throw l();if(p.length!==_.numberOfOutputs)throw e();if(_.channelCountMode!=="explicit")throw l();const v=_.channelCount*_.numberOfInputs,y=p.reduce(($,le)=>$+le,0),k=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(v+k>6||y>6)throw l();const b=new MessageChannel,N=[],T=[];for(let $=0;$<_.numberOfInputs;$+=1)N.push(a(d,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),T.push(i(d,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const S=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:$,maxValue:le,minValue:Oe,name:_e}of g.parameterDescriptors){const Ae=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_.parameterData[_e]!==void 0?_.parameterData[_e]:$===void 0?0:$});Object.defineProperties(Ae.offset,{defaultValue:{get:()=>$===void 0?0:$},maxValue:{get:()=>le===void 0?bt:le},minValue:{get:()=>Oe===void 0?Tt:Oe}}),S.push(Ae)}const M=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+k)}),O=Vh(m,d.sampleRate),P=r(d,O,v+k,Math.max(1,y)),D=i(d,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),I=[];for(let $=0;$<_.numberOfOutputs;$+=1)I.push(s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:p[$]}));for(let $=0;$<_.numberOfInputs;$+=1){N[$].connect(T[$]);for(let le=0;le<_.channelCount;le+=1)T[$].connect(M,le,$*_.channelCount+le)}const w=new Ph(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:$},le)=>{const Oe=S[le];return Oe.connect(M,0,v+le),Oe.start(0),[$,Oe.offset]}));M.connect(P);let E=_.channelInterpretation,A=null;const R=_.numberOfOutputs===0?[P]:I,z={get bufferSize(){return O},get channelCount(){return _.channelCount},set channelCount($){throw t()},get channelCountMode(){return _.channelCountMode},set channelCountMode($){throw t()},get channelInterpretation(){return E},set channelInterpretation($){for(const le of N)le.channelInterpretation=$;E=$},get context(){return P.context},get inputs(){return N},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return A},set onprocessorerror($){typeof A=="function"&&z.removeEventListener("processorerror",A),A=typeof $=="function"?$:null,typeof A=="function"&&z.addEventListener("processorerror",A)},get parameters(){return w},get port(){return b.port2},addEventListener(...$){return P.addEventListener($[0],$[1],$[2])},connect:n.bind(null,R),disconnect:c.bind(null,R),dispatchEvent(...$){return P.dispatchEvent($[0])},removeEventListener(...$){return P.removeEventListener($[0],$[1],$[2])}},F=new Map;b.port1.addEventListener=($=>(...le)=>{if(le[0]==="message"){const Oe=typeof le[1]=="function"?le[1]:typeof le[1]=="object"&&le[1]!==null&&typeof le[1].handleEvent=="function"?le[1].handleEvent:null;if(Oe!==null){const _e=F.get(le[1]);_e!==void 0?le[1]=_e:(le[1]=Ae=>{u(d.currentTime,d.sampleRate,()=>Oe(Ae))},F.set(Oe,le[1]))}}return $.call(b.port1,le[0],le[1],le[2])})(b.port1.addEventListener),b.port1.removeEventListener=($=>(...le)=>{if(le[0]==="message"){const Oe=F.get(le[1]);Oe!==void 0&&(F.delete(le[1]),le[1]=Oe)}return $.call(b.port1,le[0],le[1],le[2])})(b.port1.removeEventListener);let L=null;Object.defineProperty(b.port1,"onmessage",{get:()=>L,set:$=>{typeof L=="function"&&b.port1.removeEventListener("message",L),L=typeof $=="function"?$:null,typeof L=="function"&&(b.port1.addEventListener("message",L),b.port1.start())}}),g.prototype.port=b.port1;let q=null;c2(d,z,g,_).then($=>q=$);const j=Ao(_.numberOfInputs,_.channelCount),B=Ao(_.numberOfOutputs,p),te=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce(($,{name:le})=>({...$,[le]:new Float32Array(128)}),{});let re=!0;const J=()=>{_.numberOfOutputs>0&&P.disconnect(D);for(let $=0,le=0;$<_.numberOfOutputs;$+=1){const Oe=I[$];for(let _e=0;_e<p[$];_e+=1)D.disconnect(Oe,le+_e,_e);le+=p[$]}},ne=new Map;P.onaudioprocess=({inputBuffer:$,outputBuffer:le})=>{if(q!==null){const Oe=h(z);for(let _e=0;_e<O;_e+=128){for(let Ae=0;Ae<_.numberOfInputs;Ae+=1)for(let Ee=0;Ee<_.channelCount;Ee+=1)Co($,j[Ae],Ee,Ee,_e);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:Ae},Ee)=>{Co($,te,Ae,v+Ee,_e)});for(let Ae=0;Ae<_.numberOfInputs;Ae+=1)for(let Ee=0;Ee<p[Ae];Ee+=1)B[Ae][Ee].byteLength===0&&(B[Ae][Ee]=new Float32Array(128));try{const Ae=j.map((Ke,ie)=>{if(Oe[ie].size>0)return ne.set(ie,O/128),Ke;const Ft=ne.get(ie);return Ft===void 0?[]:(Ke.every(nn=>nn.every(pn=>pn===0))&&(Ft===1?ne.delete(ie):ne.set(ie,Ft-1)),Ke)});re=u(d.currentTime+_e/d.sampleRate,d.sampleRate,()=>q.process(Ae,B,te));for(let Ke=0,ie=0;Ke<_.numberOfOutputs;Ke+=1){for(let kt=0;kt<p[Ke];kt+=1)Rh(le,B[Ke],kt,ie+kt,_e);ie+=p[Ke]}}catch(Ae){re=!1,z.dispatchEvent(new ErrorEvent("processorerror",{colno:Ae.colno,filename:Ae.filename,lineno:Ae.lineno,message:Ae.message}))}if(!re){for(let Ae=0;Ae<_.numberOfInputs;Ae+=1){N[Ae].disconnect(T[Ae]);for(let Ee=0;Ee<_.channelCount;Ee+=1)T[_e].disconnect(M,Ee,Ae*_.channelCount+Ee)}if(g.parameterDescriptors!==void 0){const Ae=g.parameterDescriptors.length;for(let Ee=0;Ee<Ae;Ee+=1){const Ke=S[Ee];Ke.disconnect(M,0,v+Ee),Ke.stop()}}M.disconnect(P),P.onaudioprocess=null,se?J():Ce();break}}}};let se=!1;const ge=a(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Te=()=>P.connect(ge).connect(d.destination),Ce=()=>{P.disconnect(ge),ge.disconnect()},ze=()=>{if(re){Ce(),_.numberOfOutputs>0&&P.connect(D);for(let $=0,le=0;$<_.numberOfOutputs;$+=1){const Oe=I[$];for(let _e=0;_e<p[$];_e+=1)D.connect(Oe,le+_e,_e);le+=p[$]}}se=!0},Q=()=>{re&&(Te(),J()),se=!1};return Te(),f(z,ze,Q)},Fh=(n,e)=>{const t=n.createBiquadFilter();return ft(t,e),Qe(t,e,"Q"),Qe(t,e,"detune"),Qe(t,e,"frequency"),Qe(t,e,"gain"),Ge(t,e,"type"),t},h2=(n,e)=>(t,s)=>{const i=t.createChannelMerger(s.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),ft(i,s),i},f2=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw dt()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw dt()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw dt()}})},ki=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return ft(t,e),f2(t),t},d2=(n,e,t,s,i)=>(o,a)=>{if(o.createConstantSource===void 0)return t(o,a);const r=o.createConstantSource();return ft(r,a),Qe(r,a,"offset"),e(s,()=>s(o))||wa(r),e(i,()=>i(o))||va(r),n(o,r),r},Bs=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),m2=(n,e,t,s)=>(i,{offset:o,...a})=>{const r=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=t(i,{...a,gain:o}),u=r.getChannelData(0);u[0]=1,u[1]=1,l.buffer=r,l.loop=!0;const h={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(m){c.channelCount=m},get channelCountMode(){return c.channelCountMode},set channelCountMode(m){c.channelCountMode=m},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(m){c.channelInterpretation=m},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(m){l.onended=m},addEventListener(...m){return l.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return l.dispatchEvent(m[0])},removeEventListener(...m){return l.removeEventListener(m[0],m[1],m[2])},start(m=0){l.start.call(l,m)},stop(m=0){l.stop.call(l,m)}},f=()=>l.connect(c),d=()=>l.disconnect(c);return n(i,l),s(Bs(h,c),f,d)},p2=(n,e)=>(t,s)=>{const i=t.createConvolver();if(ft(i,s),s.disableNormalization===i.normalize&&(i.normalize=!s.disableNormalization),Ge(i,s,"buffer"),s.channelCount>2||(e(i,"channelCount",o=>()=>o.call(i),o=>a=>{if(a>2)throw n();return o.call(i,a)}),s.channelCountMode==="max"))throw n();return e(i,"channelCountMode",o=>()=>o.call(i),o=>a=>{if(a==="max")throw n();return o.call(i,a)}),i},zh=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return ft(t,e),Qe(t,e,"delayTime"),t},g2=n=>(e,t)=>{const s=e.createDynamicsCompressor();if(ft(s,t),t.channelCount>2||t.channelCountMode==="max")throw n();return Qe(s,t,"attack"),Qe(s,t,"knee"),Qe(s,t,"ratio"),Qe(s,t,"release"),Qe(s,t,"threshold"),s},Dt=(n,e)=>{const t=n.createGain();return ft(t,e),Qe(t,e,"gain"),t},_2=n=>(e,t,s)=>{if(e.createIIRFilter===void 0)return n(e,t,s);const i=e.createIIRFilter(s.feedforward,s.feedback);return ft(i,s),i};function y2(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function b2(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function Fc(n,e){let t=[0,0];for(let s=n.length-1;s>=0;s-=1)t=b2(t,e),t[0]+=n[s];return t}const w2=(n,e,t,s)=>(i,o,{channelCount:a,channelCountMode:r,channelInterpretation:l,feedback:c,feedforward:u})=>{const h=Vh(o,i.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),d=u instanceof Float64Array?u:new Float64Array(u),m=f.length,g=d.length,_=Math.min(m,g);if(m===0||m>20)throw s();if(f[0]===0)throw e();if(g===0||g>20)throw s();if(d[0]===0)throw e();if(f[0]!==1){for(let S=0;S<g;S+=1)d[S]/=f[0];for(let S=1;S<m;S+=1)f[S]/=f[0]}const p=t(i,h,a,a);p.channelCount=a,p.channelCountMode=r,p.channelInterpretation=l;const v=32,y=[],k=[],b=[];for(let S=0;S<a;S+=1){y.push(0);const M=new Float32Array(v),O=new Float32Array(v);M.fill(0),O.fill(0),k.push(M),b.push(O)}p.onaudioprocess=S=>{const M=S.inputBuffer,O=S.outputBuffer,P=M.numberOfChannels;for(let D=0;D<P;D+=1){const I=M.getChannelData(D),w=O.getChannelData(D);y[D]=xh(f,m,d,g,_,k[D],b[D],y[D],v,I,w)}};const N=i.sampleRate/2;return Bs({get bufferSize(){return h},get channelCount(){return p.channelCount},set channelCount(S){p.channelCount=S},get channelCountMode(){return p.channelCountMode},set channelCountMode(S){p.channelCountMode=S},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(S){p.channelInterpretation=S},get context(){return p.context},get inputs(){return[p]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},addEventListener(...S){return p.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return p.dispatchEvent(S[0])},getFrequencyResponse(S,M,O){if(S.length!==M.length||M.length!==O.length)throw n();const P=S.length;for(let D=0;D<P;D+=1){const I=-Math.PI*(S[D]/N),w=[Math.cos(I),Math.sin(I)],E=Fc(d,w),A=Fc(f,w),R=y2(E,A);M[D]=Math.sqrt(R[0]*R[0]+R[1]*R[1]),O[D]=Math.atan2(R[1],R[0])}},removeEventListener(...S){return p.removeEventListener(S[0],S[1],S[2])}},p)},v2=(n,e)=>n.createMediaElementSource(e.mediaElement),k2=(n,e)=>{const t=n.createMediaStreamDestination();return ft(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},T2=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((o,a)=>o.id<a.id?-1:o.id>a.id?1:0);const s=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(i,"mediaStream",{value:e}),i},S2=(n,e)=>(t,{mediaStreamTrack:s})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(s);const i=new MediaStream([s]),o=t.createMediaStreamSource(i);if(s.kind!=="audio")throw n();if(e(t))throw new TypeError;return o},C2=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,A2=(n,e,t,s,i,o)=>(a,r)=>{const l=a.createOscillator();return ft(l,r),Qe(l,r,"detune"),Qe(l,r,"frequency"),r.periodicWave!==void 0?l.setPeriodicWave(r.periodicWave):Ge(l,r,"type"),e(t,()=>t(a))||wa(l),e(s,()=>s(a))||o(l,a),e(i,()=>i(a))||va(l),n(a,l),l},N2=n=>(e,t)=>{const s=e.createPanner();return s.orientationX===void 0?n(e,t):(ft(s,t),Qe(s,t,"orientationX"),Qe(s,t,"orientationY"),Qe(s,t,"orientationZ"),Qe(s,t,"positionX"),Qe(s,t,"positionY"),Qe(s,t,"positionZ"),Ge(s,t,"coneInnerAngle"),Ge(s,t,"coneOuterAngle"),Ge(s,t,"coneOuterGain"),Ge(s,t,"distanceModel"),Ge(s,t,"maxDistance"),Ge(s,t,"panningModel"),Ge(s,t,"refDistance"),Ge(s,t,"rolloffFactor"),s)},E2=(n,e,t,s,i,o,a,r,l,c)=>(u,{coneInnerAngle:h,coneOuterAngle:f,coneOuterGain:d,distanceModel:m,maxDistance:g,orientationX:_,orientationY:p,orientationZ:v,panningModel:y,positionX:k,positionY:b,positionZ:N,refDistance:T,rolloffFactor:S,...M})=>{const O=u.createPanner();if(M.channelCount>2||M.channelCountMode==="max")throw a();ft(O,M);const P={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},D=t(u,{...P,channelInterpretation:"speakers",numberOfInputs:6}),I=s(u,{...M,gain:1}),w=s(u,{...P,gain:1}),E=s(u,{...P,gain:0}),A=s(u,{...P,gain:0}),R=s(u,{...P,gain:0}),z=s(u,{...P,gain:0}),F=s(u,{...P,gain:0}),L=i(u,256,6,1),q=o(u,{...P,curve:new Float32Array([1,1]),oversample:"none"});let H=[_,p,v],j=[k,b,N];const B=new Float32Array(1);L.onaudioprocess=({inputBuffer:ne})=>{const se=[l(ne,B,0),l(ne,B,1),l(ne,B,2)];se.some((Te,Ce)=>Te!==H[Ce])&&(O.setOrientation(...se),H=se);const ge=[l(ne,B,3),l(ne,B,4),l(ne,B,5)];ge.some((Te,Ce)=>Te!==j[Ce])&&(O.setPosition(...ge),j=ge)},Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});const te={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(ne){if(ne>2)throw a();I.channelCount=ne,O.channelCount=ne},get channelCountMode(){return O.channelCountMode},set channelCountMode(ne){if(ne==="max")throw a();I.channelCountMode=ne,O.channelCountMode=ne},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(ne){I.channelInterpretation=ne,O.channelInterpretation=ne},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(ne){O.coneInnerAngle=ne},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(ne){O.coneOuterAngle=ne},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(ne){if(ne<0||ne>1)throw e();O.coneOuterGain=ne},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(ne){O.distanceModel=ne},get inputs(){return[I]},get maxDistance(){return O.maxDistance},set maxDistance(ne){if(ne<0)throw new RangeError;O.maxDistance=ne},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return w.gain},get orientationY(){return E.gain},get orientationZ(){return A.gain},get panningModel(){return O.panningModel},set panningModel(ne){O.panningModel=ne},get positionX(){return R.gain},get positionY(){return z.gain},get positionZ(){return F.gain},get refDistance(){return O.refDistance},set refDistance(ne){if(ne<0)throw new RangeError;O.refDistance=ne},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(ne){if(ne<0)throw new RangeError;O.rolloffFactor=ne},addEventListener(...ne){return I.addEventListener(ne[0],ne[1],ne[2])},dispatchEvent(...ne){return I.dispatchEvent(ne[0])},removeEventListener(...ne){return I.removeEventListener(ne[0],ne[1],ne[2])}};h!==te.coneInnerAngle&&(te.coneInnerAngle=h),f!==te.coneOuterAngle&&(te.coneOuterAngle=f),d!==te.coneOuterGain&&(te.coneOuterGain=d),m!==te.distanceModel&&(te.distanceModel=m),g!==te.maxDistance&&(te.maxDistance=g),_!==te.orientationX.value&&(te.orientationX.value=_),p!==te.orientationY.value&&(te.orientationY.value=p),v!==te.orientationZ.value&&(te.orientationZ.value=v),y!==te.panningModel&&(te.panningModel=y),k!==te.positionX.value&&(te.positionX.value=k),b!==te.positionY.value&&(te.positionY.value=b),N!==te.positionZ.value&&(te.positionZ.value=N),T!==te.refDistance&&(te.refDistance=T),S!==te.rolloffFactor&&(te.rolloffFactor=S),(H[0]!==1||H[1]!==0||H[2]!==0)&&O.setOrientation(...H),(j[0]!==0||j[1]!==0||j[2]!==0)&&O.setPosition(...j);const re=()=>{I.connect(O),n(I,q,0,0),q.connect(w).connect(D,0,0),q.connect(E).connect(D,0,1),q.connect(A).connect(D,0,2),q.connect(R).connect(D,0,3),q.connect(z).connect(D,0,4),q.connect(F).connect(D,0,5),D.connect(L).connect(u.destination)},J=()=>{I.disconnect(O),r(I,q,0,0),q.disconnect(w),w.disconnect(D),q.disconnect(E),E.disconnect(D),q.disconnect(A),A.disconnect(D),q.disconnect(R),R.disconnect(D),q.disconnect(z),z.disconnect(D),q.disconnect(F),F.disconnect(D),D.disconnect(L),L.disconnect(u.destination)};return c(Bs(te,O),re,J)},M2=n=>(e,{disableNormalization:t,imag:s,real:i})=>{const o=s instanceof Float32Array?s:new Float32Array(s),a=i instanceof Float32Array?i:new Float32Array(i),r=e.createPeriodicWave(a,o,{disableNormalization:t});if(Array.from(s).length<2)throw n();return r},Ti=(n,e,t,s)=>n.createScriptProcessor(e,t,s),O2=(n,e)=>(t,s)=>{const i=s.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,s);const o=t.createStereoPanner();return ft(o,s),Qe(o,s,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),o},D2=(n,e,t,s,i,o)=>{const r=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},h=(m,g,_,p)=>{const v=new Float32Array(16385),y=new Float32Array(16385);for(let M=0;M<16385;M+=1){const O=M/16384*l;v[M]=Math.cos(O),y[M]=Math.sin(O)}const k=t(m,{...c,gain:0}),b=s(m,{...u,curve:v}),N=s(m,{...u,curve:r}),T=t(m,{...c,gain:0}),S=s(m,{...u,curve:y});return{connectGraph(){g.connect(k),g.connect(N.inputs===void 0?N:N.inputs[0]),g.connect(T),N.connect(_),_.connect(b.inputs===void 0?b:b.inputs[0]),_.connect(S.inputs===void 0?S:S.inputs[0]),b.connect(k.gain),S.connect(T.gain),k.connect(p,0,0),T.connect(p,0,1)},disconnectGraph(){g.disconnect(k),g.disconnect(N.inputs===void 0?N:N.inputs[0]),g.disconnect(T),N.disconnect(_),_.disconnect(b.inputs===void 0?b:b.inputs[0]),_.disconnect(S.inputs===void 0?S:S.inputs[0]),b.disconnect(k.gain),S.disconnect(T.gain),k.disconnect(p,0,0),T.disconnect(p,0,1)}}},f=(m,g,_,p)=>{const v=new Float32Array(16385),y=new Float32Array(16385),k=new Float32Array(16385),b=new Float32Array(16385),N=Math.floor(16385/2);for(let R=0;R<16385;R+=1)if(R>N){const z=(R-N)/(16384-N)*l;v[R]=Math.cos(z),y[R]=Math.sin(z),k[R]=0,b[R]=1}else{const z=R/(16384-N)*l;v[R]=1,y[R]=0,k[R]=Math.cos(z),b[R]=Math.sin(z)}const T=e(m,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=t(m,{...c,gain:0}),M=s(m,{...u,curve:v}),O=t(m,{...c,gain:0}),P=s(m,{...u,curve:y}),D=s(m,{...u,curve:r}),I=t(m,{...c,gain:0}),w=s(m,{...u,curve:k}),E=t(m,{...c,gain:0}),A=s(m,{...u,curve:b});return{connectGraph(){g.connect(T),g.connect(D.inputs===void 0?D:D.inputs[0]),T.connect(S,0),T.connect(O,0),T.connect(I,1),T.connect(E,1),D.connect(_),_.connect(M.inputs===void 0?M:M.inputs[0]),_.connect(P.inputs===void 0?P:P.inputs[0]),_.connect(w.inputs===void 0?w:w.inputs[0]),_.connect(A.inputs===void 0?A:A.inputs[0]),M.connect(S.gain),P.connect(O.gain),w.connect(I.gain),A.connect(E.gain),S.connect(p,0,0),I.connect(p,0,0),O.connect(p,0,1),E.connect(p,0,1)},disconnectGraph(){g.disconnect(T),g.disconnect(D.inputs===void 0?D:D.inputs[0]),T.disconnect(S,0),T.disconnect(O,0),T.disconnect(I,1),T.disconnect(E,1),D.disconnect(_),_.disconnect(M.inputs===void 0?M:M.inputs[0]),_.disconnect(P.inputs===void 0?P:P.inputs[0]),_.disconnect(w.inputs===void 0?w:w.inputs[0]),_.disconnect(A.inputs===void 0?A:A.inputs[0]),M.disconnect(S.gain),P.disconnect(O.gain),w.disconnect(I.gain),A.disconnect(E.gain),S.disconnect(p,0,0),I.disconnect(p,0,0),O.disconnect(p,0,1),E.disconnect(p,0,1)}}},d=(m,g,_,p,v)=>{if(g===1)return h(m,_,p,v);if(g===2)return f(m,_,p,v);throw i()};return(m,{channelCount:g,channelCountMode:_,pan:p,...v})=>{if(_==="max")throw i();const y=n(m,{...v,channelCount:1,channelCountMode:_,numberOfInputs:2}),k=t(m,{...v,channelCount:g,channelCountMode:_,gain:1}),b=t(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:p});let{connectGraph:N,disconnectGraph:T}=d(m,g,k,b,y);Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(b.gain,"maxValue",{get:()=>1}),Object.defineProperty(b.gain,"minValue",{get:()=>-1});const S={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(D){k.channelCount!==D&&(M&&T(),{connectGraph:N,disconnectGraph:T}=d(m,D,k,b,y),M&&N()),k.channelCount=D},get channelCountMode(){return k.channelCountMode},set channelCountMode(D){if(D==="clamped-max"||D==="max")throw i();k.channelCountMode=D},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(D){k.channelInterpretation=D},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get pan(){return b.gain},addEventListener(...D){return k.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return k.dispatchEvent(D[0])},removeEventListener(...D){return k.removeEventListener(D[0],D[1],D[2])}};let M=!1;const O=()=>{N(),M=!0},P=()=>{T(),M=!1};return o(Bs(S,y),O,P)}},I2=(n,e,t,s,i,o,a)=>(r,l)=>{const c=r.createWaveShaper();if(o!==null&&o.name==="webkitAudioContext"&&r.createGain().gain.automationRate===void 0)return t(r,l);ft(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();Ge(c,{curve:u},"curve"),Ge(c,l,"oversample");let h=null,f=!1;return a(c,"curve",g=>()=>g.call(c),g=>_=>(g.call(c,_),f&&(s(_)&&h===null?h=n(r,c):!s(_)&&h!==null&&(h(),h=null)),_)),i(c,()=>{f=!0,s(c.curve)&&(h=n(r,c))},()=>{f=!1,h!==null&&(h(),h=null)})},P2=(n,e,t,s,i)=>(o,{curve:a,oversample:r,...l})=>{const c=o.createWaveShaper(),u=o.createWaveShaper();ft(c,l),ft(u,l);const h=t(o,{...l,gain:1}),f=t(o,{...l,gain:-1}),d=t(o,{...l,gain:1}),m=t(o,{...l,gain:-1});let g=null,_=!1,p=null;const v={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(b){h.channelCount=b,f.channelCount=b,c.channelCount=b,d.channelCount=b,u.channelCount=b,m.channelCount=b},get channelCountMode(){return c.channelCountMode},set channelCountMode(b){h.channelCountMode=b,f.channelCountMode=b,c.channelCountMode=b,d.channelCountMode=b,u.channelCountMode=b,m.channelCountMode=b},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(b){h.channelInterpretation=b,f.channelInterpretation=b,c.channelInterpretation=b,d.channelInterpretation=b,u.channelInterpretation=b,m.channelInterpretation=b},get context(){return c.context},get curve(){return p},set curve(b){if(b!==null&&b.length<2)throw e();if(b===null)c.curve=b,u.curve=b;else{const N=b.length,T=new Float32Array(N+2-N%2),S=new Float32Array(N+2-N%2);T[0]=b[0],S[0]=-b[N-1];const M=Math.ceil((N+1)/2),O=(N+1)/2-1;for(let P=1;P<M;P+=1){const D=P/M*O,I=Math.floor(D),w=Math.ceil(D);T[P]=I===w?b[I]:(1-(D-I))*b[I]+(1-(w-D))*b[w],S[P]=I===w?-b[N-1-I]:-((1-(D-I))*b[N-1-I])-(1-(w-D))*b[N-1-w]}T[M]=N%2===1?b[M-1]:(b[M-2]+b[M-1])/2,c.curve=T,u.curve=S}p=b,_&&(s(p)&&g===null?g=n(o,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(b){c.oversample=b,u.oversample=b},addEventListener(...b){return h.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return h.dispatchEvent(b[0])},removeEventListener(...b){return h.removeEventListener(b[0],b[1],b[2])}};a!==null&&(v.curve=a instanceof Float32Array?a:new Float32Array(a)),r!==v.oversample&&(v.oversample=r);const y=()=>{h.connect(c).connect(d),h.connect(f).connect(u).connect(m).connect(d),_=!0,s(p)&&(g=n(o,h))},k=()=>{h.disconnect(c),c.disconnect(d),h.disconnect(f),f.disconnect(u),u.disconnect(m),m.disconnect(d),_=!1,g!==null&&(g(),g=null)};return i(Bs(v,d),y,k)},vt=()=>new DOMException("","NotSupportedError"),R2={numberOfChannels:1},x2=(n,e,t,s,i)=>class extends n{constructor(a,r,l){let c;if(typeof a=="number"&&r!==void 0&&l!==void 0)c={length:r,numberOfChannels:a,sampleRate:l};else if(typeof a=="object")c=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:f}={...R2,...c},d=s(h,u,f);e(ci,()=>ci(d))||d.addEventListener("statechange",(()=>{let m=0;const g=_=>{this._state==="running"&&(m>0?(d.removeEventListener("statechange",g),_.stopImmediatePropagation(),this._waitForThePromiseToSettle(_)):m+=1)};return g})()),super(d,h),this._length=u,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Mh(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},V2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},F2=(n,e,t,s,i,o,a)=>class extends n{constructor(l,c){const u=i(l),h={...V2,...c},f=t(u,h),d=o(u),m=d?s():null,g=l.sampleRate/2;super(l,!1,f,m),this._detune=e(this,d,f.detune,153600,-153600),this._frequency=e(this,d,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=m,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){xs(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),wn(this)&&bi(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},z2=(n,e,t,s,i)=>()=>{const o=new WeakMap;let a=null,r=null,l=null;const c=async(u,h)=>{let f=t(u);const d=gt(f,h);if(!d){const m={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:a===null?void 0:a,type:f.type};f=e(h,m),r!==null&&f.start(r),l!==null&&f.stop(l)}return o.set(h,f),d?(await n(h,u.detune,f.detune),await n(h,u.frequency,f.frequency)):(await s(h,u.detune,f.detune),await s(h,u.frequency,f.frequency)),await i(u,h,f),f};return{set periodicWave(u){a=u},set start(u){r=u},set stop(u){l=u},render(u,h){const f=o.get(h);return f!==void 0?Promise.resolve(f):c(u,h)}}},W2={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},L2=(n,e,t,s,i,o,a)=>class extends n{constructor(l,c){const u=i(l),h={...W2,...c},f=t(u,h),d=o(u),m=d?s():null;super(l,!1,f,m),this._nativePannerNode=f,this._orientationX=e(this,d,f.orientationX,bt,Tt),this._orientationY=e(this,d,f.orientationY,bt,Tt),this._orientationZ=e(this,d,f.orientationZ,bt,Tt),this._positionX=e(this,d,f.positionX,bt,Tt),this._positionY=e(this,d,f.positionY,bt,Tt),this._positionZ=e(this,d,f.positionZ,bt,Tt),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},q2=(n,e,t,s,i,o,a,r,l,c)=>()=>{const u=new WeakMap;let h=null;const f=async(d,m)=>{let g=null,_=o(d);const p={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},v={...p,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},y=gt(_,m);if("bufferSize"in _)g=s(m,{...p,gain:1});else if(!y){const k={...v,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=i(m,k)}if(u.set(m,g===null?_:g),g!==null){if(h===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const P=new a(6,d.context.length,m.sampleRate),D=e(P,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});D.connect(P.destination),h=(async()=>{const I=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(w,E)=>{const A=t(P,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:E===0?1:0});return await r(P,w,A.offset),A}));for(let w=0;w<6;w+=1)I[w].connect(D,0,w),I[w].start(0);return c(P)})()}const k=await h,b=s(m,{...p,gain:1});await l(d,m,b);const N=[];for(let P=0;P<k.numberOfChannels;P+=1)N.push(k.getChannelData(P));let T=[N[0][0],N[1][0],N[2][0]],S=[N[3][0],N[4][0],N[5][0]],M=s(m,{...p,gain:1}),O=i(m,{...v,orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:S[0],positionY:S[1],positionZ:S[2]});b.connect(M).connect(O.inputs[0]),O.connect(g);for(let P=128;P<k.length;P+=128){const D=[N[0][P],N[1][P],N[2][P]],I=[N[3][P],N[4][P],N[5][P]];if(D.some((w,E)=>w!==T[E])||I.some((w,E)=>w!==S[E])){T=D,S=I;const w=P/m.sampleRate;M.gain.setValueAtTime(0,w),M=s(m,{...p,gain:0}),O=i(m,{...v,orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),M.gain.setValueAtTime(1,w),b.connect(M).connect(O.inputs[0]),O.connect(g)}}return g}return y?(await n(m,d.orientationX,_.orientationX),await n(m,d.orientationY,_.orientationY),await n(m,d.orientationZ,_.orientationZ),await n(m,d.positionX,_.positionX),await n(m,d.positionY,_.positionY),await n(m,d.positionZ,_.positionZ)):(await r(m,d.orientationX,_.orientationX),await r(m,d.orientationY,_.orientationY),await r(m,d.orientationZ,_.orientationZ),await r(m,d.positionX,_.positionX),await r(m,d.positionY,_.positionY),await r(m,d.positionZ,_.positionZ)),qs(_)?await l(d,m,_.inputs[0]):await l(d,m,_),_};return{render(d,m){const g=u.get(m);return g!==void 0?Promise.resolve(g):f(d,m)}}},B2={disableNormalization:!1},H2=(n,e,t,s)=>class Wh{constructor(o,a){const r=e(o),l=s({...B2,...a}),c=n(r,l);return t.add(c),c}static[Symbol.hasInstance](o){return o!==null&&typeof o=="object"&&Object.getPrototypeOf(o)===Wh.prototype||t.has(o)}},X2=(n,e)=>(t,s,i)=>(n(s).replay(i),e(s,t,i)),Y2=(n,e,t)=>async(s,i,o)=>{const a=n(s);await Promise.all(a.activeInputs.map((r,l)=>Array.from(r).map(async([c,u])=>{const f=await e(c).render(c,i),d=s.context.destination;!t(c)&&(s!==d||!t(s))&&f.connect(o,u,l)})).reduce((r,l)=>[...r,...l],[]))},j2=(n,e,t)=>async(s,i,o)=>{const a=e(s);await Promise.all(Array.from(a.activeInputs).map(async([r,l])=>{const u=await n(r).render(r,i);t(r)||u.connect(o,l)}))},U2=(n,e,t,s)=>i=>n(ci,()=>ci(i))?Promise.resolve(n(s,s)).then(o=>{if(!o){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(o=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=r=>{a.disconnect(),o(r.renderedBuffer)},a.connect(i.destination),i.startRendering()}),G2=n=>(e,t)=>{n.set(e,t)},Z2=n=>(e,t)=>n.set(e,t),K2=(n,e,t,s,i,o,a,r)=>(l,c)=>t(l).render(l,c).then(()=>Promise.all(Array.from(s(c)).map(u=>t(u).render(u,c)))).then(()=>i(c)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),_a(u)):e(o,()=>o(u))||r(u),n.add(u),u)),Q2={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},J2=(n,e,t,s,i,o)=>class extends n{constructor(r,l){const c=i(r),u={...Q2,...l},h=t(c,u),f=o(c),d=f?s():null;super(r,!1,h,d),this._pan=e(this,f,h.pan)}get pan(){return this._pan}},$2=(n,e,t,s,i)=>()=>{const o=new WeakMap,a=async(r,l)=>{let c=t(r);const u=gt(c,l);if(!u){const h={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,h)}return o.set(l,c),u?await n(l,r.pan,c.pan):await s(l,r.pan,c.pan),qs(c)?await i(r,l,c.inputs[0]):await i(r,l,c),c};return{render(r,l){const c=o.get(l);return c!==void 0?Promise.resolve(c):a(r,l)}}},ek=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},tk=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,44100),i=URL.createObjectURL(t);let o=!1,a=!1;try{await s.audioWorklet.addModule(i);const r=new n(s,"a",{numberOfOutputs:0}),l=s.createOscillator();r.port.onmessage=()=>o=!0,r.onprocessorerror=()=>a=!0,l.connect(r),l.start(0),await s.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return o&&!a},nk=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{s.disconnect(),i(t.currentTime!==0)},t.startRendering()})},sk=()=>new DOMException("","UnknownError"),ik={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ok=(n,e,t,s,i,o,a)=>class extends n{constructor(l,c){const u=i(l),h={...ik,...c},f=t(u,h),m=o(u)?s():null;super(l,!0,f,m),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},rk=(n,e,t)=>()=>{const s=new WeakMap,i=async(o,a)=>{let r=e(o);if(!gt(r,a)){const c={channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,curve:r.curve,oversample:r.oversample};r=n(a,c)}return s.set(a,r),qs(r)?await t(o,a,r.inputs[0]):await t(o,a,r),r};return{render(o,a){const r=s.get(a);return r!==void 0?Promise.resolve(r):i(o,a)}}},ak=()=>typeof window>"u"?null:window,lk=(n,e)=>t=>{t.copyFromChannel=(s,i,o=0)=>{const a=n(o),r=n(i);if(r>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(r),u=s.length;for(let h=a<0?-a:0;h+a<l&&h<u;h+=1)s[h]=c[h+a]},t.copyToChannel=(s,i,o=0)=>{const a=n(o),r=n(i);if(r>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(r),u=s.length;for(let h=a<0?-a:0;h+a<l&&h<u;h+=1)c[h+a]=s[h]}},ck=n=>e=>{e.copyFromChannel=(t=>(s,i,o=0)=>{const a=n(o),r=n(i);if(a<e.length)return t.call(e,s,r,a)})(e.copyFromChannel),e.copyToChannel=(t=>(s,i,o=0)=>{const a=n(o),r=n(i);if(a<e.length)return t.call(e,s,r,a)})(e.copyToChannel)},uk=n=>(e,t)=>{const s=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=s),n(e,"buffer",i=>()=>{const o=i.call(e);return o===s?null:o},i=>o=>i.call(e,o===null?s:o))},hk=(n,e)=>(t,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(s,()=>{const r=s.numberOfInputs;for(let l=0;l<r;l+=1)i.connect(s,0,l)},()=>i.disconnect(s))},Lh=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),qh=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},Si=(n,e,t,s)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(o),set:s(a)})},fk=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),dk=n=>({...n,channelCount:n.numberOfOutputs}),mk=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},Bh=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(s){if(s.code!==9)throw s;Bh(n,e,t+1e-7)}},pk=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},gk=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},_k=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},ka=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Hh=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Ta=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},yk=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},bk=n=>{n.start=(e=>(t=0,s=0,i)=>{const o=n.buffer,a=o===null?s:Math.min(o.duration,s);o!==null&&a>o.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,a,i)})(n.start)},Xh=(n,e)=>{const t=e.createGain();n.connect(t);const s=(i=>()=>{i.call(n,t),n.removeEventListener("ended",s)})(n.disconnect);n.addEventListener("ended",s),Bs(n,t),n.stop=(i=>{let o=!1;return(a=0)=>{if(o)try{i.call(n,a)}catch{t.gain.setValueAtTime(0,a)}else i.call(n,a),o=!0}})(n.stop)},Hs=(n,e)=>t=>{const s={value:n};return Object.defineProperties(t,{currentTarget:s,target:s}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},wk=Lb(es),vk=jb(es),kk=iv(Yo),Yh=new WeakMap,Tk=kv(Yh),$t=Rw(new Map,new WeakMap),cn=ak(),jh=Jv($t,fn),Sa=vv(wt),mt=Y2(wt,Sa,Kn),Sk=Qb(jh,je,mt),He=Cv(Xo),Cn=C2(cn),qe=Bv(Cn),Uh=new WeakMap,Gh=mv(Hs),Ci=n2(cn),Ca=zv(Ci),Aa=Wv(cn),Zh=Lv(cn),ui=i2(cn),nt=kw(qb(kh),Yb(wk,vk,ko,kk,To,wt,Tk,yi,je,es,wn,Kn,Qi),$t,Pv(Hr,To,wt,je,li,wn),fn,jo,vt,ev(ko,Hr,wt,je,li,He,wn,qe),av(Uh,wt,Zt),Gh,He,Ca,Aa,Zh,qe,ui),Ck=Kb(nt,Sk,fn,jh,He,qe),Na=new WeakSet,zc=$v(cn),Kh=Uw(new Uint32Array(1)),Ea=lk(Kh,fn),Ma=ck(Kh),Qh=$b(Na,$t,vt,zc,Cn,ek(zc),Ea,Ma),Uo=Ub(Dt),Jh=j2(Sa,wi,Kn),dn=qw(Jh),Xs=t2(Uo,$t,pk,gk,_k,ka,Hh,Ta,bk,uk(Si),Xh),mn=X2(Tv(wi),Jh),Ak=nw(dn,Xs,je,mn,mt),en=Tw(Bb(Th),Uh,ga,Sw,Rb,xb,Vb,Fb,zb,Lr,wh,Ci,Bh),Nk=tw(nt,Ak,en,dt,Xs,He,qe,Hs),Ek=hw(nt,fw,fn,dt,s2(Dt,Si),He,qe,mt),Mk=Pw(dn,Fh,je,mn,mt),ts=Z2(Yh),Ok=Iw(nt,en,Mk,jo,Fh,He,qe,ts),zn=Kv(es,Aa),Dk=hk(dt,zn),Wn=h2(Ci,Dk),Ik=Fw(Wn,je,mt),Pk=Vw(nt,Ik,Wn,He,qe),Rk=Lw(ki,je,mt),xk=Ww(nt,Rk,ki,He,qe,dk),Vk=m2(Uo,Xs,Dt,zn),Ys=d2(Uo,$t,Vk,ka,Ta),Fk=jw(dn,Ys,je,mn,mt),zk=Yw(nt,en,Fk,Ys,He,qe,Hs),$h=p2(vt,Si),Wk=Kw($h,je,mt),Lk=Zw(nt,Wk,$h,He,qe,ts),qk=sv(dn,zh,je,mn,mt),Bk=nv(nt,en,qk,zh,He,qe,ts),ef=g2(vt),Hk=hv(dn,ef,je,mn,mt),Xk=uv(nt,en,Hk,ef,vt,He,qe,ts),Yk=bv(dn,Dt,je,mn,mt),jk=yv(nt,en,Yk,Dt,He,qe),Uk=w2(jo,dt,Ti,vt),Go=U2($t,Dt,Ti,nk(Dt,Cn)),Gk=Iv(Xs,je,Cn,mt,Go),Zk=_2(Uk),Kk=Ov(nt,Zk,Gk,He,qe,ts),Qk=dw(en,Wn,Ys,Ti,vt,Lh,qe,Si),tf=new WeakMap,Jk=Zv(Ek,Qk,Gh,qe,tf,Hs),nf=A2(Uo,$t,ka,Hh,Ta,Xh),$k=z2(dn,nf,je,mn,mt),eT=F2(nt,en,nf,$k,He,qe,Hs),sf=Hw(Xs),tT=P2(sf,dt,Dt,qh,zn),Zo=I2(sf,dt,tT,qh,zn,Ci,Si),nT=E2(ko,dt,Wn,Dt,Ti,Zo,vt,To,Lh,zn),of=N2(nT),sT=q2(dn,Wn,Ys,Dt,of,je,Cn,mn,mt,Go),iT=L2(nt,en,of,sT,He,qe,ts),oT=M2(fn),rT=H2(oT,He,new WeakSet,mk),aT=D2(Wn,ki,Dt,Zo,vt,zn),rf=O2(aT,vt),lT=$2(dn,rf,je,mn,mt),cT=J2(nt,en,rf,lT,He,qe),uT=rk(Zo,je,mt),hT=ok(nt,dt,Zo,uT,He,qe,ts),af=Hv(cn),Oa=pv(cn),lf=new WeakMap,fT=Av(lf,Cn),dT=af?Xb($t,vt,dv(cn),Oa,gv(Wb),He,fT,qe,ui,new WeakMap,new WeakMap,tk(ui,Cn),cn):void 0,mT=qv(Ca,qe),pT=$w(Na,$t,Jw,fv,new WeakSet,He,mT,wo,ci,Ea,Ma),cf=Ow(dT,Ck,Qh,Nk,Ok,Pk,xk,zk,Lk,pT,Bk,Xk,jk,Kk,Jk,eT,iT,rT,cT,hT),gT=Xv(nt,v2,He,qe),_T=jv(nt,k2,He,qe),yT=Uv(nt,T2,He,qe),bT=S2(dt,qe),wT=Gv(nt,bT,He),vT=uw(cf,dt,vt,sk,gT,_T,yT,wT,Ci),Da=Nv(tf),kT=Gb(Da),uf=Bw(fn),TT=ov(Da),hf=lv(fn),ff=new WeakMap,ST=wv(ff,Zt),CT=u2(uf,fn,dt,Wn,ki,Ys,Dt,Ti,vt,hf,Oa,ST,zn),AT=r2(dt,CT,Dt,vt,zn),NT=Mw(dn,uf,Xs,Wn,ki,Ys,Dt,TT,hf,Oa,je,ui,Cn,mn,mt,Go),ET=Sv(lf),MT=G2(ff),Wc=af?Aw(kT,nt,en,NT,AT,wt,ET,He,qe,ui,fk,MT,yk,Hs):void 0,OT=Qw(vt,Cn),DT=K2(Na,$t,Sa,Da,Go,wo,Ea,Ma),IT=x2(cf,$t,dt,OT,DT),PT=Rv(Xo,Ca),RT=xv(pa,Aa),xT=Vv(ga,Zh),VT=Fv(Xo,qe);function Rt(n){return n===void 0}function Me(n){return n!==void 0}function FT(n){return typeof n=="function"}function Tn(n){return typeof n=="number"}function Pn(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function df(n){return typeof n=="boolean"}function Bt(n){return Array.isArray(n)}function Sn(n){return typeof n=="string"}function Xi(n){return Sn(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function Ne(n,e){if(!n)throw new Error(e)}function xn(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function mf(n){!n.isOffline&&n.state!=="running"&&Ia('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let pf=!1,Lc=!1;function qc(n){pf=n}function zT(n){Rt(n)&&pf&&!Lc&&(Lc=!0,Ia("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let gf=console;function WT(...n){gf.log(...n)}function Ia(...n){gf.warn(...n)}function LT(n){return new vT(n)}function qT(n,e,t){return new IT(n,e,t)}const It=typeof self=="object"?self:null,BT=It&&(It.hasOwnProperty("AudioContext")||It.hasOwnProperty("webkitAudioContext"));function HT(n,e,t){return Ne(Me(Wc),"AudioWorkletNode only works in a secure context (https or localhost)"),new(n instanceof(It==null?void 0:It.BaseAudioContext)?It==null?void 0:It.AudioWorkletNode:Wc)(n,e,t)}function tn(n,e,t,s){var i=arguments.length,o=i<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,s);else for(var r=n.length-1;r>=0;r--)(a=n[r])&&(o=(i<3?a(o):i>3?a(e,t,o):a(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}function rt(n,e,t,s){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function r(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?o(u.value):i(u.value).then(r,l)}c((s=s.apply(n,e||[])).next())})}class XT{constructor(e,t,s,i){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(i||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),s=new Worker(t);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function Qn(n){return xT(n)}function Rn(n){return RT(n)}function Ji(n){return VT(n)}function ds(n){return PT(n)}function YT(n){return n instanceof Qh}function jT(n,e){return n==="value"||Qn(e)||Rn(e)||YT(e)}function Cs(n,...e){if(!e.length)return n;const t=e.shift();if(Pn(n)&&Pn(t))for(const s in t)jT(s,t[s])?n[s]=t[s]:Pn(t[s])?(n[s]||Object.assign(n,{[s]:{}}),Cs(n[s],t[s])):Object.assign(n,{[s]:t[s]});return Cs(n,...e)}function UT(n,e){return n.length===e.length&&n.every((t,s)=>e[s]===t)}function me(n,e,t=[],s){const i={},o=Array.from(e);if(Pn(o[0])&&s&&!Reflect.has(o[0],s)&&(Object.keys(o[0]).some(r=>Reflect.has(n,r))||(Cs(i,{[s]:o[0]}),t.splice(t.indexOf(s),1),o.shift())),o.length===1&&Pn(o[0]))Cs(i,o[0]);else for(let a=0;a<t.length;a++)Me(o[a])&&(i[t[a]]=o[a]);return Cs(n,i)}function GT(n){return n.constructor.getDefaults()}function ln(n,e){return Rt(n)?e:n}function Bc(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class An{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||It&&this.toString()===It.TONE_DEBUG_CLASS)&&WT(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}An.version=bh;const Pa=1e-6;function Vs(n,e){return n>e+Pa}function Gr(n,e){return Vs(n,e)||jt(n,e)}function No(n,e){return n+Pa<e}function jt(n,e){return Math.abs(n-e)<Pa}function ZT(n,e,t){return Math.max(Math.min(n,t),e)}class Ht extends An{constructor(){super(),this.name="Timeline",this._timeline=[];const e=me(Ht.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Ne(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];Ne(Gr(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const s=this._search(e,t);return s!==-1?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const s=this._search(e,t);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const s=this._search(e);return s-1>=0?this._timeline[s-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(jt(this._timeline[t].time,e)){for(let s=t;s>=0&&jt(this._timeline[s].time,e);s--)t=s;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&Gr(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let s=0;const i=this._timeline.length;let o=i;if(i>0&&this._timeline[i-1][t]<=e)return i-1;for(;s<o;){let a=Math.floor(s+(o-s)/2);const r=this._timeline[a],l=this._timeline[a+1];if(jt(r[t],e)){for(let c=a;c<this._timeline.length;c++){const u=this._timeline[c];if(jt(u[t],e))a=c;else break}return a}else{if(No(r[t],e)&&Vs(l[t],e))return a;Vs(r[t],e)?o=a:s=a+1}}return-1}_iterate(e,t=0,s=this._timeline.length-1){this._timeline.slice(t,s+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const s=this._search(e);return s!==-1&&this._iterate(t,0,s),this}forEachAfter(e,t){const s=this._search(e);return this._iterate(t,s+1),this}forEachBetween(e,t,s){let i=this._search(e),o=this._search(t);return i!==-1&&o!==-1?(this._timeline[i].time!==e&&(i+=1),this._timeline[o].time===t&&(o-=1),this._iterate(s,i,o)):i===-1&&this._iterate(s,0,o),this}forEachFrom(e,t){let s=this._search(e);for(;s>=0&&this._timeline[s].time>=e;)s--;return this._iterate(t,s+1),this}forEachAtTime(e,t){const s=this._search(e);if(s!==-1&&jt(this._timeline[s].time,e)){let i=s;for(let o=s;o>=0&&jt(this._timeline[o].time,e);o--)i=o;this._iterate(o=>{t(o)},i,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const _f=[];function Ko(n){_f.push(n)}function KT(n){_f.forEach(e=>e(n))}const yf=[];function Qo(n){yf.push(n)}function QT(n){yf.forEach(e=>e(n))}class Ai extends An{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(i=>{Rt(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(t)}),this}once(e,t){const s=(...i)=>{t(...i),this.off(e,s)};return this.on(e,s),this}off(e,t){return e.split(/\W+/).forEach(i=>{if(Rt(this._events)&&(this._events={}),this._events.hasOwnProperty(i))if(Rt(t))this._events[i]=[];else{const o=this._events[i];for(let a=o.length-1;a>=0;a--)o[a]===t&&o.splice(a,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const s=this._events[e].slice(0);for(let i=0,o=s.length;i<o;i++)s[i].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const s=Object.getOwnPropertyDescriptor(Ai.prototype,t);Object.defineProperty(e.prototype,t,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class bf extends Ai{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Ni extends bf{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new Ht,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const s=me(Ni.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=LT({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new XT(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(KT(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,s){return this._context.createBuffer(e,t,s)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,s){return this._context.createPeriodicWave(e,t,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return Ne(ds(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return Ne(ds(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return Ne(ds(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Ne(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Ne(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Ne(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Ne(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return HT(this.rawContext,e,t)}addAudioWorkletModule(e){return rt(this,void 0,void 0,function*(){Ne(Me(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return rt(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return ds(this._context)?this._context.resume():Promise.resolve()}close(){return rt(this,void 0,void 0,function*(){ds(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&QT(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),s=t.getChannelData(0);for(let o=0;o<s.length;o++)s[o]=e;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:s+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const s=++this._timeoutIds,i=()=>{const o=this.now();this._timeouts.add({callback:()=>{e(),i()},id:s,time:o+t})};return i(),s}}class JT extends bf{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,s){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return rt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function xe(n,e){Bt(e)?e.forEach(t=>xe(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function wf(n,e){Bt(e)?e.forEach(t=>wf(n,t)):Object.defineProperty(n,e,{writable:!0})}const Fe=()=>{};class Xe extends An{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Fe;const e=me(Xe.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,Sn(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Fe,onload:Fe,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Pt().sampleRate}set(e){return e instanceof Xe?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return rt(this,void 0,void 0,function*(){const t=Xe.load(e).then(s=>{this.set(s),this.onload(this)});Xe.downloads.push(t);try{yield t}finally{const s=Xe.downloads.indexOf(t);Xe.downloads.splice(s,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=Bt(e)&&e[0].length>0,s=t?e.length:1,i=t?e[0].length:e.length,o=Pt(),a=o.createBuffer(s,i,o.sampleRate),r=!t&&s===1?[e]:e;for(let l=0;l<s;l++)a.copyToChannel(r[l],l);return this._buffer=a,this}toMono(e){if(Tn(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const s=this.numberOfChannels;for(let i=0;i<s;i++){const o=this.toArray(i);for(let a=0;a<o.length;a++)t[a]+=o[a]}t=t.map(i=>i/s),this.fromArray(t)}return this}toArray(e){if(Tn(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let s=0;s<this.numberOfChannels;s++)t[s]=this.getChannelData(s);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){Ne(this.loaded,"Buffer is not loaded");const s=Math.floor(e*this.sampleRate),i=Math.floor(t*this.sampleRate);Ne(s<i,"The start time must be less than the end time");const o=i-s,a=Pt().createBuffer(this.numberOfChannels,o,this.sampleRate);for(let r=0;r<this.numberOfChannels;r++)a.copyToChannel(this.getChannelData(r).subarray(s,i),r);return new Xe(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Xe().fromArray(e)}static fromUrl(e){return rt(this,void 0,void 0,function*(){return yield new Xe().load(e)})}static load(e){return rt(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const l=t[1].split("|");let c=l[0];for(const u of l)if(Xe.supportsType(u)){c=u;break}e=e.replace(t[0],c)}const s=Xe.baseUrl===""||Xe.baseUrl.endsWith("/")?Xe.baseUrl:Xe.baseUrl+"/",i=document.createElement("a");i.href=s+e,i.pathname=(i.pathname+i.hash).split("/").map(encodeURIComponent).join("/");const o=yield fetch(i.href);if(!o.ok)throw new Error(`could not load url: ${e}`);const a=yield o.arrayBuffer();return yield Pt().decodeAudioData(a)})}static supportsType(e){const t=e.split("."),s=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+s)!==""}static loaded(){return rt(this,void 0,void 0,function*(){for(yield Promise.resolve();Xe.downloads.length;)yield Xe.downloads[0]})}}Xe.baseUrl="";Xe.downloads=[];class Ra extends Ni{constructor(){super({clockSource:"offline",context:Ji(arguments[0])?arguments[0]:qT(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:Ji(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Ji(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return rt(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const s=Math.floor(this.sampleRate/128);e&&t%s===0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(){return rt(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Xe(t)})}close(){return Promise.resolve()}}const vf=new JT;let _s=vf;function Pt(){return _s===vf&&BT&&$T(new Ni),_s}function $T(n,e=!1){e&&_s.dispose(),ds(n)?_s=new Ni(n):Ji(n)?_s=new Ra(n):_s=n}if(It&&!It.TONE_SILENCE_LOGGING){const e=` * Tone.js v${bh} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function eS(n){return Math.pow(10,n/20)}function tS(n){return 20*(Math.log(n)/Math.LN10)}function kf(n){return Math.pow(2,n/12)}let Jo=440;function nS(){return Jo}function sS(n){Jo=n}function Zr(n){return Math.round(Tf(n))}function Tf(n){return 69+12*Math.log2(n/Jo)}function iS(n){return Jo*Math.pow(2,(n-69)/12)}class xa extends An{constructor(e,t,s){super(),this.defaultUnits="s",this._val=t,this._units=s,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const s=parseInt(e,10),i=t==="."?1.5:1;return s===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/s)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,s)=>{let i=0;return e&&e!=="0"&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i+=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(i+=this._beatsToUnits(parseFloat(s)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof xa&&this.fromType(this._val),Rt(this._val))return this._noArg();if(Sn(this._val)&&Rt(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Pn(this._val)){let e=0;for(const t in this._val)if(Me(this._val[t])){const s=this._val[t],i=new this.constructor(this.context,t).valueOf()*s;e+=i}return e}if(Me(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return Sn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class Gt extends xa{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new Gt(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const s=new this.constructor(this.context,e).valueOf(),i=this.valueOf(),r=Math.round(i/s)*s-i;return i+r*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let o=1;o<9;o++){const a=Math.pow(2,o);t.push(a+"n."),t.push(a+"n"),t.push(a+"t")}t.push("0");let s=t[0],i=new Gt(this.context,t[0]).toSeconds();return t.forEach(o=>{const a=new Gt(this.context,o).toSeconds();Math.abs(a-e)<Math.abs(i-e)&&(s=o,i=a)}),s}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const s=Math.floor(t/this._getTimeSignature());let i=t%1*4;t=Math.floor(t)%this._getTimeSignature();const o=i.toString();return o.length>3&&(i=parseFloat(parseFloat(o).toFixed(3))),[s,t,i].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Zr(this.toFrequency())}_now(){return this.context.now()}}class qt extends Gt{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return nS()}static set A4(e){sS(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:qt.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const i=oS[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?i:qt.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,s){let i=1;return e&&e!=="0"&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i*=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(i*=this._beatsToUnits(parseFloat(s)/4)),i}}})}transpose(e){return new qt(this.context,this.valueOf()*kf(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Zr(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/qt.A4);let s=Math.round(12*t)+57;const i=Math.floor(s/12);return i<0&&(s+=-12*i),rS[s%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return iS(e)}static ftom(e){return Zr(e)}}const oS={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},rS=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class As extends Gt{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class pt extends An{constructor(){super();const e=me(pt.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Pt()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return zT(e),new Gt(this.context,e).toSeconds()}toFrequency(e){return new qt(this.context,e).toFrequency()}toTicks(e){return new As(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(s=>{Rt(e[s])&&delete t[s]}),t}get(){const e=GT(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const s=this[t];Me(s)&&Me(s.value)&&Me(s.setValueAtTime)?e[t]=s.value:s instanceof pt?e[t]=s._getPartialProperties(e[t]):Bt(s)||Tn(s)||Sn(s)||df(s)?e[t]=s:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Me(this[t])&&(this[t]&&Me(this[t].value)&&Me(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof pt?this[t].set(e[t]):this[t]=e[t])}),this}}class Ei extends Ht{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,s){return xn(t,0),this.add(Object.assign({},s,{state:e,time:t})),this}getLastState(e,t){const s=this._search(t);for(let i=s;i>=0;i--){const o=this._timeline[i];if(o.state===e)return o}}getNextState(e,t){const s=this._search(t);if(s!==-1)for(let i=s;i<this._timeline.length;i++){const o=this._timeline[i];if(o.state===e)return o}}}class Ve extends pt{constructor(){const e=me(Ve.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Ne(Me(e.param)&&(Qn(e.param)||e.param instanceof Ve),"param must be an AudioParam");!Qn(e.param);)e.param=e.param._param;this._swappable=Me(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Ht(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Me(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(pt.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Me(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Me(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Me(this.maxValue)&&Me(this.minValue)&&xn(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?eS(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?tS(e):e}setValueAtTime(e,t){const s=this.toSeconds(t),i=this._fromType(e);return Ne(isFinite(i)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,s),this._events.add({time:s,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,s),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),s=this._events.getAfter(t),i=this._events.get(t);let o=this._initialValue;if(i===null)o=this._initialValue;else if(i.type==="setTargetAtTime"&&(s===null||s.type==="setValueAtTime")){const a=this._events.getBefore(i.time);let r;a===null?r=this._initialValue:r=a.value,i.type==="setTargetAtTime"&&(o=this._exponentialApproach(i.time,r,i.value,i.constant,t))}else if(s===null)o=i.value;else if(s.type==="linearRampToValueAtTime"||s.type==="exponentialRampToValueAtTime"){let a=i.value;if(i.type==="setTargetAtTime"){const r=this._events.getBefore(i.time);r===null?a=this._initialValue:a=r.value}s.type==="linearRampToValueAtTime"?o=this._linearInterpolate(i.time,a,s.time,s.value,t):o=this._exponentialInterpolate(i.time,a,s.time,s.value,t)}else o=i.value;return this._toType(o)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const s=this._fromType(e),i=this.toSeconds(t);return Ne(isFinite(s)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this._events.add({time:i,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(s,i),this}exponentialRampToValueAtTime(e,t){let s=this._fromType(e);s=jt(s,0)?this._minOutput:s,this._assertRange(s);const i=this.toSeconds(t);return Ne(isFinite(s)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(s,i),this}exponentialRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(e,s+this.toSeconds(t)),this}linearRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(e,s+this.toSeconds(t)),this}targetRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(e,s,t),this}exponentialApproachValueAtTime(e,t,s){t=this.toSeconds(t),s=this.toSeconds(s);const i=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(e,t,i),this.cancelAndHoldAtTime(t+s*.9),this.linearRampToValueAtTime(e,t+s),this}setTargetAtTime(e,t,s){const i=this._fromType(e);Ne(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const o=this.toSeconds(t);return this._assertRange(i),Ne(isFinite(i)&&isFinite(o),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:s,time:o,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,o,s),this._param.setTargetAtTime(i,o,s),this}setValueCurveAtTime(e,t,s,i=1){s=this.toSeconds(s),t=this.toSeconds(t);const o=this._fromType(e[0])*i;this.setValueAtTime(this._toType(o),t);const a=s/(e.length-1);for(let r=1;r<e.length;r++){const l=this._fromType(e[r])*i;this.linearRampToValueAtTime(this._toType(l),t+r*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return Ne(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),s=this._fromType(this.getValueAtTime(t));Ne(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+s);const i=this._events.get(t),o=this._events.getAfter(t);return i&&jt(i.time,t)?o?(this._param.cancelScheduledValues(o.time),this._events.cancel(o.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):o&&(this._param.cancelScheduledValues(o.time),this._events.cancel(o.time),o.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(s),t):o.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(s),t)),this._events.add({time:t,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,t),this}rampTo(e,t=.1,s){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,s):this.linearRampTo(e,t,s),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const s=this._events.get(t);if(s&&s.type==="setTargetAtTime"){const i=this._events.getAfter(s.time),o=i?i.time:t+2,a=(o-t)/10;for(let r=t;r<o;r+=a)e.linearRampToValueAtTime(this.getValueAtTime(r),r)}return this._events.forEachAfter(this.context.currentTime,i=>{i.type==="cancelScheduledValues"?e.cancelScheduledValues(i.time):i.type==="setTargetAtTime"?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){Ne(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,s,i,o){return s+(t-s)*Math.exp(-(o-e)/i)}_linearInterpolate(e,t,s,i,o){return t+(i-t)*((o-e)/(s-e))}_exponentialInterpolate(e,t,s,i,o){return t*Math.pow(i/t,(o-e)/(s-e))}}class ye extends pt{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Me(this.input)?Qn(this.input)||this.input instanceof Ve?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Me(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Me(e)&&(e instanceof ye||Rn(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(s=>{s.channelCount=e.channelCount,s.channelCountMode=e.channelCountMode,s.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Ne(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,s=0){return Kt(this,e,t,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Ia("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,s=0){return Sf(this,e,t,s),this}chain(...e){return Jn(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Me(this.input)&&(this.input instanceof ye?this.input.dispose():Rn(this.input)&&this.input.disconnect()),Me(this.output)&&(this.output instanceof ye?this.output.dispose():Rn(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Jn(...n){const e=n.shift();n.reduce((t,s)=>(t instanceof ye?t.connect(s):Rn(t)&&Kt(t,s),s),e)}function Kt(n,e,t=0,s=0){for(Ne(Me(n),"Cannot connect from undefined node"),Ne(Me(e),"Cannot connect to undefined node"),(e instanceof ye||Rn(e))&&Ne(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Ne(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof ye||e instanceof Ve;)Me(e.input)&&(e=e.input);for(;n instanceof ye;)Me(n.output)&&(n=n.output);Qn(e)?n.connect(e,t):n.connect(e,t,s)}function Sf(n,e,t=0,s=0){if(Me(e))for(;e instanceof ye;)e=e.input;for(;!Rn(n);)Me(n.output)&&(n=n.output);Qn(e)?n.disconnect(e,t):Rn(e)?n.disconnect(e,t,s):n.disconnect()}class We extends ye{constructor(){const e=me(We.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Ve({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),xe(this,"gain")}static getDefaults(){return Object.assign(ye.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Fs extends ye{constructor(e){super(e),this.onended=Fe,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new We({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const s=this.toSeconds(t);return this._startTime!==-1&&s>=this._startTime&&(this._stopTime===-1||s<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(ye.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Fe})}_startGain(e,t=1){Ne(this._startTime===-1,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=e+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+s):this._gainNode.gain.exponentialApproachValueAtTime(t,e,s)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Ne(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const s=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+s),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Fe&&(this.onended(this),this.onended=Fe,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Ne(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Fe,this}}class Va extends Fs{constructor(){const e=me(Va.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),Kt(this._source,this._gainNode),this.offset=new Ve({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Fs.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Ue extends ye{constructor(){const e=me(Ue.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new Va({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(ye.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,s=0){return $o(this,e,t,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,s){return this._param.exponentialRampTo(e,t,s),this}linearRampTo(e,t,s){return this._param.linearRampTo(e,t,s),this}targetRampTo(e,t,s){return this._param.targetRampTo(e,t,s),this}exponentialApproachValueAtTime(e,t,s){return this._param.exponentialApproachValueAtTime(e,t,s),this}setTargetAtTime(e,t,s){return this._param.setTargetAtTime(e,t,s),this}setValueCurveAtTime(e,t,s,i){return this._param.setValueCurveAtTime(e,t,s,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,s){return this._param.rampTo(e,t,s),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function $o(n,e,t,s){(e instanceof Ve||Qn(e)||e instanceof Ue&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Ue&&(e.overridden=!0)),Kt(n,e,t,s)}class Fa extends Ve{constructor(){const e=me(Fa.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new Ht(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ve.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,s){t=this.toSeconds(t),this.setRampPoint(t);const i=this._fromType(e),o=this._events.get(t),a=Math.round(Math.max(1/s,1));for(let r=0;r<=a;r++){const l=s*r+t,c=this._exponentialApproach(o.time,o.value,i,s,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}setValueAtTime(e,t){const s=this.toSeconds(t);super.setValueAtTime(e,t);const i=this._events.get(s),o=this._events.previousEvent(i),a=this._getTicksUntilEvent(o,s);return i.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const s=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const i=this._events.get(s),o=this._events.previousEvent(i),a=this._getTicksUntilEvent(o,s);return i.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const s=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max((t-i.time)*10,1)),a=(t-i.time)/o;for(let r=0;r<=o;r++){const l=a*r+i.time,c=this._exponentialInterpolate(i.time,i.value,t,s,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Rt(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const s=this._fromType(this.getValueAtTime(e.time));let i=this._fromType(this.getValueAtTime(t));const o=this._events.get(t);return o&&o.time===t&&o.type==="setValueAtTime"&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(s+i)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),s=this._events.get(t);return Math.max(this._getTicksUntilEvent(s,t),0)}getDurationOfTicks(e,t){const s=this.toSeconds(t),i=this.getTicksAtTime(t);return this.getTimeOfTick(i+e)-s}getTimeOfTick(e){const t=this._events.get(e,"ticks"),s=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&s&&s.type==="linearRampToValueAtTime"&&t.value!==s.value){const i=this._fromType(this.getValueAtTime(t.time)),a=(this._fromType(this.getValueAtTime(s.time))-i)/(s.time-t.time),r=Math.sqrt(Math.pow(i,2)-2*a*(t.ticks-e)),l=(-i+r)/a,c=(-i-r)/a;return(l>0?l:c)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const s=this.toSeconds(t),i=this.toSeconds(e),o=this.getTicksAtTime(s);return this.getTicksAtTime(s+i)-o}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class za extends Ue{constructor(){const e=me(za.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new Fa({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Ue.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class Wa extends pt{constructor(){const e=me(Wa.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new Ei,this._tickOffset=new Ht,this._ticksAtTime=new Ht,this._secondsAtTime=new Ht,this.frequency=new za({context:this.context,units:e.units,value:e.frequency}),xe(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},pt.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const s=this.toSeconds(e);return this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),Me(t)&&this.setTicksAtTime(t,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const s=this._state.get(t);s&&s.time>0&&(this._tickOffset.cancel(s.time),this._state.cancel(s.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),s=this._state.getLastState("stopped",t),i=this._ticksAtTime.get(t),o={state:"paused",time:t};this._state.add(o);let a=i||s,r=i?i.ticks:0,l=null;return this._state.forEachBetween(a.time,t+this.sampleTime,c=>{let u=a.time;const h=this._tickOffset.get(c.time);h&&h.time>=a.time&&(r=h.ticks,u=h.time),a.state==="started"&&c.state!=="started"&&(r+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(u),c.time!==o.time&&(l={state:c.state,time:c.time,ticks:r})),a=c}),this._state.remove(o),l&&this._ticksAtTime.add(l),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),s=this.frequency.timeToTicks(e,t);this.setTicksAtTime(s,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);const i=this._secondsAtTime.get(e);let o=i||t,a=i?i.seconds:0,r=null;return this._state.forEachBetween(o.time,e+this.sampleTime,l=>{let c=o.time;const u=this._tickOffset.get(l.time);u&&u.time>=o.time&&(a=u.seconds,c=u.time),o.state==="started"&&l.state!=="started"&&(a+=l.time-c,l.time!==s.time&&(r={state:l.state,time:l.time,seconds:a})),o=l}),this._state.remove(s),r&&this._secondsAtTime.add(r),a}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const s=this._tickOffset.get(t),i=this._state.get(t),o=Math.max(s.time,i.time),a=this.frequency.getTicksAtTime(o)+e-s.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,s){let i=this._state.get(e);this._state.forEachBetween(e,t,a=>{i&&i.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(i.time,e),a.time-this.sampleTime,s),i=a});let o=null;if(i&&i.state==="started"){const a=Math.max(i.time,e),r=this.frequency.getTicksAtTime(a),l=this.frequency.getTicksAtTime(i.time),c=r-l;let u=Math.ceil(c)-c;u=jt(u,1)?0:u;let h=this.frequency.getTimeOfTick(r+u);for(;h<t;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(f){o=f;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(o)throw o;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class er extends pt{constructor(){const e=me(er.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=Fe,this._lastUpdate=0,this._state=new Ei("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new Wa({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,xe(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(pt.getDefaults(),{callback:Fe,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){mf(this.context);const s=this.toSeconds(e);return this.log("start",s),this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,t),s<this._lastUpdate&&this.emit("start",s,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const s=this.toSeconds(t),i=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(i+e,s)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,s=>{switch(s.state){case"started":const i=this._tickSource.getTicksAtTime(s.time);this.emit("start",s.time,i);break;case"stopped":s.time!==0&&this.emit("stop",s.time);break;case"paused":this.emit("pause",s.time);break}}),this._tickSource.forEachTickBetween(e,t,(s,i)=>{this.callback(s,i)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Ai.mixin(er);class La extends ye{constructor(){const e=me(La.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";const t=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(t,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(t),this.delayTime=new Ve({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),xe(this,"delayTime")}static getDefaults(){return Object.assign(ye.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class js extends ye{constructor(){const e=me(js.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new We({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,xe(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class qa extends ye{constructor(){const e=me(qa.getDefaults(),arguments);super(e),this.name="Destination",this.input=new js({context:this.context}),this.output=new We({context:this.context}),this.volume=this.input.volume,Jn(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Jn(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Ko(n=>{n.destination=new qa({context:n})});Qo(n=>{n.destination.dispose()});class aS extends ye{constructor(){super(...arguments),this.name="Listener",this.positionX=new Ve({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Ve({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Ve({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Ve({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Ve({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Ve({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Ve({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Ve({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Ve({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(ye.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Ko(n=>{n.listener=new aS({context:n})});Qo(n=>{n.listener.dispose()});class Ba extends An{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=me(Ba.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const s=e.urls[t];this.add(t,s,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Fe,onload:Fe,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Ne(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,s=Fe,i=Fe){return Sn(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Xe(this.baseUrl+t,s,i))):this._buffers.set(e.toString(),new Xe(t,s,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class ut extends As{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class lS extends pt{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Ht,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Ko(n=>{n.draw=new lS({context:n})});Qo(n=>{n.draw.dispose()});class cS extends An{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Ne(Me(e.time),"Events must have a time property"),Ne(Me(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new uS(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const s of t)if(s.event===e){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let s,i=null;if(t>0)if(e.left.right===null)s=e.left,s.right=e.right,i=s;else{for(s=e.left.right;s.right!==null;)s=s.right;s.parent&&(s.parent.right=s.left,i=s.parent,s.left=e.left,s.right=e.right)}else if(e.right.left===null)s=e.right,s.left=e.left,i=s;else{for(s=e.right.left;s.left!==null;)s=s.left;s.parent&&(s.parent.left=s.right,i=s.parent,s.left=e.left,s.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=s:e.parent.right=s:this._setRoot(s),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){const t=e.parent,s=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),t!==null?s?t.left=i:t.right=i:this._setRoot(i)}_rotateRight(e){const t=e.parent,s=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),t!==null?s?t.left=i:t.right=i:this._setRoot(i)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let s=t[0];for(let i=1;i<t.length;i++)t[i].low>s.low&&(s=t[i]);return s.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(s=>t.push(s)),t.forEach(s=>{s.event&&e(s.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const s=[];this._root.search(e,s),s.forEach(i=>{i.event&&t(i.event)})}return this}forEachFrom(e,t){if(this._root!==null){const s=[];this._root.searchAfter(e,s),s.forEach(i=>{i.event&&t(i.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class uS{constructor(e,t,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class hS extends An{constructor(e){super(),this.name="TimelineValue",this._timeline=new Ht({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class un extends ye{constructor(){super(me(un.getDefaults(),arguments,["context"]))}connect(e,t=0,s=0){return $o(this,e,t,s),this}}class Us extends un{constructor(){const e=me(Us.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,Bt(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):FT(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Ue.getDefaults(),{length:1024})}setMap(e,t=1024){const s=new Float32Array(t);for(let i=0,o=t;i<o;i++){const a=i/(o-1)*2-1;s[i]=e(a,i)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(s=>s.includes(e));Ne(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Ha extends un{constructor(){const e=me(Ha.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new Us({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(un.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Vn{constructor(e,t){this.id=Vn._eventId++,this._remainderTime=0;const s=Object.assign(Vn.getDefaults(),t);this.transport=e,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:Fe,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Vn._eventId=0;class Xa extends Vn{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(Xa.getDefaults(),t);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Vn.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return No(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new ut(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){No(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ut(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Vs(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class tr extends pt{constructor(){const e=me(tr.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new hS(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Ht,this._repeatedEvents=new cS,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new er({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),xe(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(pt.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const s=t%(this._swingTicks*2)/(this._swingTicks*2),i=Math.sin(s*Math.PI)*this._swingAmount;e+=new ut(this.context,this._swingTicks*2/3).toSeconds()*i}qc(!0),this._timeline.forEachAtTime(t,s=>s.invoke(e)),qc(!1)}schedule(e,t){const s=new Vn(this,{callback:e,time:new As(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(e,t,s,i=1/0){const o=new Xa(this,{callback:e,duration:new Gt(this.context,i).toTicks(),interval:new Gt(this.context,t).toTicks(),time:new As(this.context,s).toTicks()});return this._addEvent(o,this._repeatedEvents)}scheduleOnce(e,t){const s=new Vn(this,{callback:e,once:!0,time:new As(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,s=>this.clear(s.id)),this._repeatedEvents.forEachFrom(t,s=>this.clear(s.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new ut(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let s;return Me(t)&&(s=this.toTicks(t)),this._clock.start(e,s),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){Bt(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new Gt(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new Gt(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new ut(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new ut(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),s=this._clock.frequency.timeToTicks(e,t);this.ticks=s}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const s=this._clock.getTicksAtTime(t),i=this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,t),o=t+i;this.emit("stop",o),this._clock.setTicksAtTime(e,o),this.emit("start",o,this._clock.getSecondsAtTime(o))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),s=this.getTicksAtTime(t),i=e-s%e;return this._clock.nextTickTime(i,t)}}syncSignal(e,t){const s=this.now();let i=this.bpm,o=1/(60/i.getValueAtTime(s)/this.PPQ),a=[];if(e.units==="time"){const l=.015625/o,c=new We(l),u=new Ha(-1),h=new We(l);i.chain(c,u,h),i=h,o=1/o,a=[c,u,h]}t||(e.getValueAtTime(s)!==0?t=e.getValueAtTime(s)/o:t=0);const r=new We(t);return i.connect(r),r.connect(e._param),a.push(r),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const s=this._syncedSignals[t];s.signal===e&&(s.nodes.forEach(i=>i.dispose()),s.signal.value=s.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),wf(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Ai.mixin(tr);Ko(n=>{n.transport=new tr({context:n})});Qo(n=>{n.transport.dispose()});class Vt extends ye{constructor(e){super(e),this.input=void 0,this._state=new Ei("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Fe,this._syncedStop=Fe,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new js({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,xe(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,onstop:Fe,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,s){let i=Rt(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),!this._synced&&this._state.getValueAtTime(i)==="started")Ne(Vs(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,s);else if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const o=this._state.get(i);o&&(o.offset=this.toSeconds(ln(t,0)),o.duration=s?this.toSeconds(s):void 0);const a=this.context.transport.schedule(r=>{this._start(r,t,s)},i);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else mf(this.context),this._start(i,t,s);return this}stop(e){let t=Rt(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Me(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const s=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(s)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,s){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Vs(t,0)){const s=this._state.get(t);if(s&&s.state==="started"&&s.time!==t){const i=t-this.toSeconds(s.time);let o;s.duration&&(o=this.toSeconds(s.duration)-i),this._start(e,this.toSeconds(s.offset)+i,o)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Fe,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class nr extends Fs{constructor(){const e=me(nr.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,Kt(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Ve({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Xe(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Fs.getDefaults(),{url:new Xe,loop:!1,loopEnd:0,loopStart:0,onload:Fe,onerror:Fe,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,s,i=1){Ne(this.buffer.loaded,"buffer is either not set or not loaded");const o=this.toSeconds(e);this._startGain(o,i),this.loop?t=ln(t,this.loopStart):t=ln(t,0);let a=Math.max(this.toSeconds(t),0);if(this.loop){const r=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),c=r-l;Gr(a,r)&&(a=(a-l)%c+l),jt(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,No(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(o,a)),Me(s)){let r=this.toSeconds(s);r=Math.max(r,0),this.stop(o+r)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function ns(n,e){return rt(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,s=new Ra(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:s})).toDestination().start(0),(yield s.render()).getChannelData(0)})}class Ya extends Fs{constructor(){const e=me(Ya.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],Kt(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Ve({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Ve({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),xe(this,["frequency","detune"])}static getDefaults(){return Object.assign(Fs.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Je extends Vt{constructor(){const e=me(Je.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new Ue({context:this.context,units:"frequency",value:e.frequency}),xe(this,"frequency"),this.detune=new Ue({context:this.context,units:"cents",value:e.detune}),xe(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),s=new Ya({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Je._periodicWaveCache.find(t=>t.phase===this._phase&&UT(t.partials,this._partials));{const e=Je._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const s=this._getCachedPeriodicWave();if(Me(s)){const{partials:i,wave:o}=s;this._wave=o,this._partials=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[i,o]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(i,o);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Je._periodicWaveCache.push({imag:o,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),Je._periodicWaveCache.length>100&&Je._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){xn(e,0);let t=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(t=s[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const i=new Float32Array(e);this._partials.forEach((o,a)=>i[a]=o),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(e,t){let i=2048;const o=new Float32Array(i),a=new Float32Array(i);let r=1;if(e==="custom"){if(r=this._partials.length+1,this._partialCount=this._partials.length,i=r,this._partials.length===0)return[o,a]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);l?(r=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),e=l[1],r=Math.max(r,2),i=r):this._partialCount=0,this._partials=[]}for(let l=1;l<i;++l){const c=2/(l*Math.PI);let u;switch(e){case"sine":u=l<=r?1:0,this._partials[l-1]=u;break;case"square":u=l&1?2*c:0,this._partials[l-1]=u;break;case"sawtooth":u=c*(l&1?1:-1),this._partials[l-1]=u;break;case"triangle":l&1?u=2*(c*c)*(l-1>>1&1?-1:1):u=0,this._partials[l-1]=u;break;case"custom":u=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(o[l]=-u*Math.sin(t*l),a[l]=u*Math.cos(t*l)):(o[l]=0,a[l]=0)}return[o,a]}_inverseFFT(e,t,s){let i=0;const o=e.length;for(let a=0;a<o;a++)i+=e[a]*Math.cos(a*s)+t[a]*Math.sin(a*s);return i}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let s=0;const i=Math.PI*2,o=32;for(let a=0;a<o;a++)s=Math.max(this._inverseFFT(e,t,a/o*i),s);return ZT(-this._inverseFFT(e,t,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Je._periodicWaveCache=[];class Cf extends un{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Us({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class $n extends Ue{constructor(){const e=me($n.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new We({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Ue.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Mi extends Vt{constructor(){const e=me(Mi.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new Cf({context:this.context}),this._modulationNode=new We({context:this.context}),this._carrier=new Je({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Je({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new $n({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),xe(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Je.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class sr extends Vt{constructor(){const e=me(sr.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new We({context:this.context,gain:0}),this._carrier=new Je({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Ue({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Je({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new $n({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new $n({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),xe(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Je.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Oi extends Vt{constructor(){const e=me(Oi.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new We({context:this.context,gain:0}),this._thresh=new Us({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new Ue({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Je({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),xe(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class ir extends Vt{constructor(){const e=me(ir.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new Ue({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ue({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,xe(this,["frequency","detune"])}static getDefaults(){return Object.assign(Je.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,s=e/(this._oscillators.length-1);this._forEach((i,o)=>i.detune.value=t+s*o)}}get count(){return this._oscillators.length}set count(e){if(xn(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const s=new Je({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):Fe});this.type==="custom"&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[t]=s}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,s)=>t.phase=this._phase+s/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class or extends Vt{constructor(){const e=me(or.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new $n({context:this.context,value:2}),this._pulse=new Oi({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Je({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),xe(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Hc={am:Mi,fat:ir,fm:sr,oscillator:Je,pulse:Oi,pwm:or};class Eo extends Vt{constructor(){const e=me(Eo.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new Ue({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Ue({context:this.context,units:"cents",value:e.detune}),xe(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Je.getDefaults(),sr.getDefaults(),Mi.getDefaults(),ir.getDefaults(),Oi.getDefaults(),or.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=Hc[e],s=this.now();if(this._oscillator){const i=this._oscillator;i.stop(s),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof Hc[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Tn(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Tn(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Sn(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return rt(this,arguments,void 0,function*(e=1024){return ns(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class ja extends Ue{constructor(){super(me(ja.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new We({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Jn(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Ue.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class rr extends un{constructor(){const e=me(rr.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new $n({context:this.context,value:e.max-e.min}),this._add=this.output=new ja({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(un.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Ua extends un{constructor(){super(me(Ua.getDefaults(),arguments)),this.name="Zero",this._gain=new We({context:this.context}),this.output=this._gain,this.input=void 0,Kt(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Sf(this.context.getConstant(0),this._gain),this}}class Mo extends ye{constructor(){const e=me(Mo.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Ve.prototype._fromType,this._toType=Ve.prototype._toType,this._is=Ve.prototype._is,this._clampValue=Ve.prototype._clampValue,this._oscillator=new Je(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new We({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Ue({context:this.context,units:"audioRange",value:0}),this._zeros=new Ua({context:this.context}),this._a2g=new Cf({context:this.context}),this._scaler=this.output=new rr({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),xe(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(Je.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const t=this.min,s=this.max;this._units=e,this.min=t,this.max=s}get state(){return this._oscillator.state}connect(e,t,s){return(e instanceof Ve||e instanceof Ue)&&(this.convert=e.convert,this.units=e.units),$o(this,e,t,s),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Af(n,e=1/0){const t=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(o){xn(o,n,e),t.set(this,o)}})}}function Nn(n,e=1/0){const t=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(o){xn(this.toSeconds(o),n,e),t.set(this,o)}})}}class ar extends Vt{constructor(){const e=me(ar.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Xe({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Vt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Fe,onerror:Fe,playbackRate:1,reverse:!1})}load(e){return rt(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Fe){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,s){return super.start(e,t,s),this}_start(e,t,s){this._loop?t=ln(t,this._loopStart):t=ln(t,0);const i=this.toSeconds(t),o=s;s=ln(s,Math.max(this._buffer.duration-i,0));let a=this.toSeconds(s);a=a/this._playbackRate,e=this.toSeconds(e);const r=new nr({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&Rt(o)?r.start(e,i):r.start(e,i,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(s=>s.stop(t))}restart(e,t,s){return super.restart(e,t,s),this}_restart(e,t,s){var i;(i=[...this._activeSources].pop())===null||i===void 0||i.stop(e),this._start(e,t,s)}seek(e,t){const s=this.toSeconds(t);if(this._state.getValueAtTime(s)==="started"){const i=this.toSeconds(e);this._stop(s),this._start(s,i)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&xn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&xn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),s=this._state.getNextState("stopped",t);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}tn([Nn(0)],ar.prototype,"fadeIn",void 0);tn([Nn(0)],ar.prototype,"fadeOut",void 0);class fS extends un{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Us({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ln extends ye{constructor(){const e=me(Ln.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new Ue({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(ye.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(Sn(e))return e;{let s;for(s in Yi)if(Yi[s][t]===e)return s;return e}}_setCurve(e,t,s){if(Sn(s)&&Reflect.has(Yi,s)){const i=Yi[s];Pn(i)?e!=="_decayCurve"&&(this[e]=i[t]):this[e]=i}else if(Bt(s)&&e!=="_decayCurve")this[e]=s;else throw new Error("Envelope: invalid curve: "+s)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let i=this.toSeconds(this.attack);const o=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const r=1/i;i=(1-a)/r}if(i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,i,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,i,e);else{this._sig.cancelAndHoldAtTime(e);let r=this._attackCurve;for(let l=1;l<r.length;l++)if(r[l-1]<=a&&a<=r[l]){r=this._attackCurve.slice(l),r[0]=a;break}this._sig.setValueCurveAtTime(r,e,i,t)}if(o&&this.sustain<1){const r=t*this.sustain,l=e+i;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(r,o+l):this._sig.exponentialApproachValueAtTime(r,l,o)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,s,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,s,e):(Ne(Bt(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,s,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,s=1){return t=this.toSeconds(t),this.triggerAttack(t,s),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,s=0){return $o(this,e,t,s),this}asArray(){return rt(this,arguments,void 0,function*(e=1024){const t=e/this.context.sampleRate,s=new Ra(1,t,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),o=i+this.toSeconds(this.release),a=o*.1,r=o+a,l=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/r,decay:t*this.toSeconds(this.decay)/r,release:t*this.toSeconds(this.release)/r,context:s}));return l._sig.toDestination(),l.triggerAttackRelease(t*(i+a)/r,0),(yield s.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}tn([Nn(0)],Ln.prototype,"attack",void 0);tn([Nn(0)],Ln.prototype,"decay",void 0);tn([Af(0,1)],Ln.prototype,"sustain",void 0);tn([Nn(0)],Ln.prototype,"release",void 0);const Yi=(()=>{let e,t;const s=[];for(e=0;e<128;e++)s[e]=Math.sin(e/(128-1)*(Math.PI/2));const i=[],o=6.4;for(e=0;e<128-1;e++){t=e/(128-1);const f=Math.sin(t*(Math.PI*2)*o-Math.PI/2)+1;i[e]=f/10+t*.83}i[128-1]=1;const a=[],r=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/(128-1)*r)/r;const l=[];for(e=0;e<128;e++)t=e/(128-1),l[e]=.5*(1-Math.cos(Math.PI*t));const c=[];for(e=0;e<128;e++){t=e/(128-1);const f=Math.pow(t,3)*4+.2,d=Math.cos(f*Math.PI*2*t);c[e]=Math.abs(d*(1-t))}function u(f){const d=new Array(f.length);for(let m=0;m<f.length;m++)d[m]=1-f[m];return d}function h(f){return f.slice(0).reverse()}return{bounce:{In:u(c),Out:c},cosine:{In:s,Out:h(s)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:l,Out:u(l)},step:{In:a,Out:u(a)}}})();class zs extends ye{constructor(){const e=me(zs.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new js({context:this.context,volume:e.volume}),this.volume=this._volume.volume,xe(this,"volume")}static getDefaults(){return Object.assign(ye.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const s=this["_original_"+e]=this[e];this[e]=(...i)=>{const o=i[t],a=this.context.transport.schedule(r=>{i[t]=r,s.apply(this,i)},o);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,s,i){const o=this.toSeconds(s),a=this.toSeconds(t);return this.triggerAttack(e,o,i),this.triggerRelease(o+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Ws extends zs{constructor(){const e=me(Ws.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(zs.getDefaults(),{detune:0,onsilence:Fe,portamento:0})}triggerAttack(e,t,s=1){this.log("triggerAttack",e,t,s);const i=this.toSeconds(t);return this._triggerEnvelopeAttack(i,s),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const s=this.toSeconds(t),i=e instanceof qt?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const o=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,o,s)}else this.frequency.setValueAtTime(i,s);return this}}tn([Nn(0)],Ws.prototype,"portamento",void 0);class Ga extends Ln{constructor(){super(me(Ga.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new We({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class hi extends Ws{constructor(){const e=me(hi.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new Eo(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Ga(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),xe(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Ws.getDefaults(),{envelope:Object.assign(Bc(Ln.getDefaults(),Object.keys(ye.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Bc(Eo.getDefaults(),[...Object.keys(Vt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+s+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class lr extends hi{constructor(){const e=me(lr.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,xe(this,["oscillator","envelope"])}static getDefaults(){return Cs(Ws.getDefaults(),hi.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const s=this.toSeconds(t),i=this.toFrequency(e instanceof qt?e.toFrequency():e),o=i*this.octaves;return this.oscillator.frequency.setValueAtTime(o,s),this.oscillator.frequency.exponentialRampToValueAtTime(i,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}tn([Af(0)],lr.prototype,"octaves",void 0);tn([Nn(0)],lr.prototype,"pitchDecay",void 0);const Za=new Set;function Ka(n){Za.add(n)}function Nf(n,e){const t=`registerProcessor("${n}", ${e})`;Za.add(t)}function dS(){return Array.from(Za).join(`
`)}class mS extends ye{constructor(e){super(e),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Fe;const t=URL.createObjectURL(new Blob([dS()],{type:"text/javascript"})),s=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(t).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(s,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}const pS=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;Ka(pS);const gS=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;Ka(gS);const _S=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;Ka(_S);const Ef="feedback-comb-filter",yS=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;Nf(Ef,yS);class Qa extends mS{constructor(){const e=me(Qa.getDefaults(),arguments,["delayTime","resonance"]);super(e),this.name="FeedbackCombFilter",this.input=new We({context:this.context}),this.output=new We({context:this.context}),this.delayTime=new Ve({context:this.context,value:e.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new Ve({context:this.context,value:e.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),xe(this,["resonance","delayTime"])}_audioWorkletName(){return Ef}static getDefaults(){return Object.assign(ye.getDefaults(),{delayTime:.1,resonance:.5})}onReady(e){Jn(this.input,e,this.output);const t=e.parameters.get("delayTime");this.delayTime.setParam(t);const s=e.parameters.get("feedback");this.resonance.setParam(s)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class cr extends zs{constructor(){const e=me(cr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(s=>{const i=parseInt(s,10);if(Ne(Xi(s)||Tn(i)&&isFinite(i),`url key is neither a note or midi pitch: ${s}`),Xi(s)){const o=new qt(this.context,s).toMidi();t[o]=e.urls[s]}else Tn(i)&&isFinite(i)&&(t[i]=e.urls[i])}),this._buffers=new Ba({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(zs.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Fe,onerror:Fe,release:.1,urls:{}})}_findClosest(e){let s=0;for(;s<96;){if(this._buffers.has(e+s))return-s;if(this._buffers.has(e-s))return s;s++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,s=1){return this.log("triggerAttack",e,t,s),Array.isArray(e)||(e=[e]),e.forEach(i=>{const o=Tf(new qt(this.context,i).toFrequency()),a=Math.round(o),r=o-a,l=this._findClosest(a),c=a-l,u=this._buffers.get(c),h=kf(l+r),f=new nr({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);f.start(t,0,u.duration/h,s),Bt(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const d=this._activeSources.get(a),m=d.indexOf(f);m!==-1&&d.splice(m,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(s=>{const i=new qt(this.context,s).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const o=this._activeSources.get(i);t=this.toSeconds(t),o.forEach(a=>{a.stop(t)}),this._activeSources.set(i,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(s=>{for(;s.length;)s.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,s,i=1){const o=this.toSeconds(s);return this.triggerAttack(e,o,i),Bt(t)?(Ne(Bt(e),"notes must be an array when duration is array"),e.forEach((a,r)=>{const l=t[Math.min(r,t.length-1)];this.triggerRelease(a,o+this.toSeconds(l))})):this.triggerRelease(e,o+this.toSeconds(t)),this}add(e,t,s){if(Ne(Xi(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Xi(e)){const i=new qt(this.context,e).toMidi();this._buffers.add(i,t,s)}else this._buffers.add(e,t,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}tn([Nn(0)],cr.prototype,"attack",void 0);tn([Nn(0)],cr.prototype,"release",void 0);class ys extends pt{constructor(){const e=me(ys.getDefaults(),arguments,["callback","value"]);super(e),this.name="ToneEvent",this._state=new Ei("stopped"),this._startOffset=0,this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(pt.getDefaults(),{callback:Fe,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,t=>{let s;if(t.state==="started"){t.id!==-1&&this.context.transport.clear(t.id);const i=t.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Tn(this._loop)&&this._loop>1){s=1/0,Tn(this._loop)&&(s=this._loop*this._getLoopDuration());const o=this._state.getAfter(i);o!==null&&(s=Math.min(s,o.time-i)),s!==1/0&&(s=new ut(this.context,s));const a=new ut(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),a,new ut(this.context,i),s)}else t.id=this.context.transport.schedule(this._tick.bind(this),new ut(this.context,i))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){const t=this.toTicks(e);return this._state.getValueAtTime(t)==="stopped"&&(this._state.add({id:-1,state:"started",time:t}),this._rescheduleEvents(t)),this}stop(e){this.cancel(e);const t=this.toTicks(e);if(this._state.getValueAtTime(t)==="started"){this._state.setStateAtTime("stopped",t,{id:-1});const s=this._state.getBefore(t);let i=t;s!==null&&(i=s.time),this._rescheduleEvents(i)}return this}cancel(e){e=ln(e,-1/0);const t=this.toTicks(e);return this._state.forEachFrom(t,s=>{this.context.transport.clear(s.id)}),this._state.cancel(t),this}_tick(e){const t=this.context.transport.getTicksAtTime(e);if(!this.mute&&this._state.getValueAtTime(t)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let s=.02;df(this.humanize)||(s=this.toSeconds(this.humanize)),e+=(Math.random()*2-1)*s}this.callback(e,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new ut(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new ut(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const e=this.context.transport.ticks,t=this._state.get(e);if(t!==null&&t.state==="started"){const s=this._getLoopDuration();return(e-t.time)%s/s}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class fi extends ys{constructor(){const e=me(fi.getDefaults(),arguments,["callback","events"]);super(e),this.name="Part",this._state=new Ei("stopped"),this._events=new Set,this._state.increasing=!0,e.events.forEach(t=>{Bt(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(ys.getDefaults(),{events:[]})}start(e,t){const s=this.toTicks(e);if(this._state.getValueAtTime(s)!=="started"){t=ln(t,this._loop?this._loopStart:0),this._loop?t=ln(t,this._loopStart):t=ln(t,0);const i=this.toTicks(t);this._state.add({id:-1,offset:i,state:"started",time:s}),this._forEach(o=>{this._startNote(o,s,i)})}return this}_startNote(e,t,s){t-=s,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<s&&(t+=this._getLoopDuration()),e.start(new ut(this.context,t))):e.startOffset<this._loopStart&&e.startOffset>=s&&(e.loop=!1,e.start(new ut(this.context,t))):e.startOffset>=s&&e.start(new ut(this.context,t))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(e){const t=this.toTicks(e);return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._forEach(s=>{s.stop(e)}),this}at(e,t){const s=new As(this.context,e).toTicks(),i=new ut(this.context,1).toSeconds(),o=this._events.values();let a=o.next();for(;!a.done;){const r=a.value;if(Math.abs(s-r.startOffset)<i)return Me(t)&&(r.value=t),r;a=o.next()}return Me(t)?(this.add(e,t),this.at(e)):null}add(e,t){e instanceof Object&&Reflect.has(e,"time")&&(t=e,e=t.time);const s=this.toTicks(e);let i;return t instanceof ys?(i=t,i.callback=this._tick.bind(this)):i=new ys({callback:this._tick.bind(this),context:this.context,value:t}),i.startOffset=s,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(e){this._state.forEach(t=>{t.state==="started"?this._startNote(e,t.time,t.offset):e.stop(new ut(this.context,t.time))})}remove(e,t){return Pn(e)&&e.hasOwnProperty("time")&&(t=e,e=t.time),e=this.toTicks(e),this._events.forEach(s=>{s.startOffset===e&&(Rt(t)||Me(t)&&s.value===t)&&(this._events.delete(s),s.dispose())}),this}clear(){return this._forEach(e=>e.dispose()),this._events.clear(),this}cancel(e){return this._forEach(t=>t.cancel(e)),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach(t=>{t instanceof fi?t._forEach(e):e(t)}),this}_setAll(e,t){this._forEach(s=>{s[e]=t})}_tick(e,t){this.mute||this.callback(e,t)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):e.state==="stopped"&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach(t=>{t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.loop=e,this._testLoopBoundries(t)})}get loopEnd(){return new ut(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach(t=>{t.loopEnd=e,this._testLoopBoundries(t)})}get loopStart(){return new ut(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class ur extends ye{constructor(){const e=me(ur.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new fS({context:this.context}),this.a=new We({context:this.context,gain:0}),this.b=new We({context:this.context,gain:0}),this.output=new We({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new Ue({context:this.context,units:"normalRange",value:e.fade}),xe(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Kt(this._split,this.a.gain,0),Kt(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(ye.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Xc extends ye{constructor(e){super(e),this.name="Effect",this._dryWet=new ur({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new We({context:this.context}),this.effectReturn=new We({context:this.context}),this.input=new We({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],xe(this,"wet")}static getDefaults(){return Object.assign(ye.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Ja extends ye{constructor(){const e=me(Ja.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Ve({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",xe(this,"pan")}static getDefaults(){return Object.assign(ye.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const bS="bit-crusher",wS=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;Nf(bS,wS);class $a extends ye{constructor(){const e=me($a.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(ye.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class el extends ye{constructor(){const e=me(el.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(ye.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Oo extends ye{constructor(e){super(e),this.name="StereoEffect",this.input=new We({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new ur({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new $a({context:this.context,channels:2}),this._merge=new el({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),xe(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),Jn(...e),Kt(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),Jn(...e),Kt(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(ye.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Yc extends Xc{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new We({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,xe(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Xc.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class tl extends Yc{constructor(){const e=me(tl.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new La({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),xe(this,"delayTime")}static getDefaults(){return Object.assign(Yc.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}const jc=[1687/25e3,1601/25e3,2053/25e3,2251/25e3],vS=[.773,.802,.753,.733],kS=[347,113,37];class nl extends Oo{constructor(){const e=me(nl.getDefaults(),arguments,["roomSize"]);super(e),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[],this.roomSize=new Ue({context:this.context,value:e.roomSize,units:"normalRange"}),this._scaleRoomSize=new rr({context:this.context,min:-.733,max:.197}),this._allpassFilters=kS.map(t=>{const s=this.context.createBiquadFilter();return s.type="allpass",s.frequency.value=t,s}),this._feedbackCombFilters=jc.map((t,s)=>{const i=new Qa({context:this.context,delayTime:t});return this._scaleRoomSize.connect(i.resonance),i.resonance.value=vS[s],s<jc.length/2?this.connectEffectLeft(...this._allpassFilters,i):this.connectEffectRight(...this._allpassFilters,i),i}),this.roomSize.connect(this._scaleRoomSize),xe(this,["roomSize"])}static getDefaults(){return Object.assign(Oo.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(e=>e.disconnect()),this._feedbackCombFilters.forEach(e=>e.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class sl extends Oo{constructor(){const e=me(sl.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(e),this.name="Phaser",this._lfoL=new Mo({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new Mo({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new Ue({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),xe(this,["frequency","Q"])}static getDefaults(){return Object.assign(Oo.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,t){const s=[];for(let i=0;i<e;i++){const o=this.context.createBiquadFilter();o.type="allpass",this.Q.connect(o.Q),t.connect(o.frequency),s.push(o)}return s}get octaves(){return this._octaves}set octaves(e){this._octaves=e;const t=this._baseFrequency*Math.pow(2,e);this._lfoL.max=t,this._lfoR.max=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(e=>e.disconnect()),this._filtersR.forEach(e=>e.disconnect()),this.frequency.dispose(),this}}class ot extends ye{constructor(){const e=me(ot.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new We({context:this.context}),ot._allSolos.has(this.context)||ot._allSolos.set(this.context,new Set),ot._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(ye.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),ot._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){ot._soloed.has(this.context)||ot._soloed.set(this.context,new Set),ot._soloed.get(this.context).add(this)}_removeSolo(){ot._soloed.has(this.context)&&ot._soloed.get(this.context).delete(this)}_isSoloed(){return ot._soloed.has(this.context)&&ot._soloed.get(this.context).has(this)}_noSolos(){return!ot._soloed.has(this.context)||ot._soloed.has(this.context)&&ot._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ot._allSolos.get(this.context).delete(this),this._removeSolo(),this}}ot._allSolos=new Map;ot._soloed=new Map;class il extends ye{constructor(){const e=me(il.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new Ja({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new js({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,xe(this,["pan","volume"])}static getDefaults(){return Object.assign(ye.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class bs extends ye{constructor(){const e=me(bs.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new ot({solo:e.solo,context:this.context}),this._panVol=this.output=new il({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),xe(this,["pan","volume"])}static getDefaults(){return Object.assign(ye.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return bs.buses.has(e)||bs.buses.set(e,new We({context:this.context})),bs.buses.get(e)}send(e,t=0){const s=this._getBus(e),i=new We({context:this.context,units:"decibels",gain:t});return this.connect(i),i.connect(s),i}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}bs.buses=new Map;Pt().transport;function Kr(){return Pt().transport}Pt().destination;Pt().destination;function TS(){return Pt().destination}Pt().listener;Pt().draw;Pt();function Uc(n){let e,t,s,i,o,a,r,l,c,u,h;return{c(){e=X("div"),t=X("div"),s=X("h3"),s.textContent="Synthesizer",i=K(),o=X("p"),o.textContent="This node generates an Audio Signal using a synthesizer made of an oscillator and amplitude envelope.",a=K(),r=X("p"),r.innerHTML="<b>Volume</b> is the volume of the sound in decibels. <b>Pitch</b> is the pitch of the note heard, using the Western musical scale. <b>Shape</b> is the shape of the wave generated by the oscillator.",l=K(),c=X("button"),c.textContent="Close",C(c,"class","close-button svelte-1kyu15y"),C(t,"class","info-content svelte-1kyu15y"),C(e,"class","info-popup svelte-1kyu15y")},m(f,d){Z(f,e,d),x(e,t),x(t,s),x(t,i),x(t,o),x(t,a),x(t,r),x(t,l),x(t,c),u||(h=de(c,"click",n[12]),u=!0)},p:pe,d(f){f&&U(e),u=!1,h()}}}function SS(n){let e,t,s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y=Do[n[2]]+"",k,b,N,T,S,M,O,P=Qr[n[3]].toString()+"",D,I,w,E,A,R,z,F,L,q;i=new Ot({props:{type:"target",position:fe.Left}}),A=new Ot({props:{type:"source",position:fe.Right}});let H=n[0]&&Uc(n);return{c(){e=X("div"),t=X("button"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',s=K(),he(i.$$.fragment),o=K(),a=X("div"),a.innerHTML="<b>Synthesizer</b> <hr/>",r=K(),l=X("div"),c=X("i"),c.textContent="Volume: ",u=X("strong"),h=Be(n[1]),f=Be("db"),d=K(),m=X("input"),g=K(),_=X("div"),p=X("i"),p.textContent="Pitch: ",v=X("strong"),k=Be(y),b=K(),N=X("input"),T=K(),S=X("div"),M=X("i"),M.textContent="Shape: ",O=X("strong"),D=Be(P),I=K(),w=X("input"),E=K(),he(A.$$.fragment),R=K(),H&&H.c(),z=Ze(),C(t,"class","info-button svelte-1kyu15y"),C(m,"class","nodrag"),C(m,"type","range"),C(m,"min","-50"),C(m,"max","50"),C(m,"step","1"),m.value=n[1],C(N,"class","nodrag"),C(N,"type","range"),C(N,"min","0"),C(N,"max","62"),C(N,"step","1"),N.value=n[2],C(w,"class","nodrag"),C(w,"type","range"),C(w,"min","0"),C(w,"max","3"),C(w,"step","1"),w.value=n[3],C(e,"class","sliders svelte-1kyu15y")},m(j,B){Z(j,e,B),x(e,t),x(e,s),ce(i,e,null),x(e,o),x(e,a),x(e,r),x(e,l),x(l,c),x(l,u),x(u,h),x(u,f),x(e,d),x(e,m),x(e,g),x(e,_),x(_,p),x(_,v),x(v,k),x(e,b),x(e,N),x(e,T),x(e,S),x(S,M),x(S,O),x(O,D),x(e,I),x(e,w),x(e,E),ce(A,e,null),Z(j,R,B),H&&H.m(j,B),Z(j,z,B),F=!0,L||(q=[de(t,"click",n[8]),de(m,"input",n[9]),de(N,"input",n[10]),de(w,"input",n[11])],L=!0)},p(j,[B]){(!F||B&2)&&ht(h,j[1]),(!F||B&2)&&(m.value=j[1]),(!F||B&4)&&y!==(y=Do[j[2]]+"")&&ht(k,y),(!F||B&4)&&(N.value=j[2]),(!F||B&8)&&P!==(P=Qr[j[3]].toString()+"")&&ht(D,P),(!F||B&8)&&(w.value=j[3]),j[0]?H?H.p(j,B):(H=Uc(j),H.c(),H.m(z.parentNode,z)):H&&(H.d(1),H=null)},i(j){F||(Y(i.$$.fragment,j),Y(A.$$.fragment,j),F=!0)},o(j){G(i.$$.fragment,j),G(A.$$.fragment,j),F=!1},d(j){j&&(U(e),U(R),U(z)),ue(i),ue(A),H&&H.d(j),L=!1,tt(q)}}}function CS(n,e,t){let s,i,o,{data:a}=e;const{slider1:r,slider2:l,slider3:c}=a;ee(n,r,_=>t(1,s=_)),ee(n,l,_=>t(2,i=_)),ee(n,c,_=>t(3,o=_));let u=!1;const h=()=>t(0,u=!u),f=_=>{var p;return r.set(Number((p=_.currentTarget)==null?void 0:p.value))},d=_=>{var p;return l.set(Number((p=_.currentTarget)==null?void 0:p.value))},m=_=>{var p;return c.set(Number((p=_.currentTarget)==null?void 0:p.value))},g=()=>t(0,u=!1);return n.$$set=_=>{"data"in _&&t(7,a=_.data)},[u,s,i,o,r,l,c,a,h,f,d,m,g]}class AS extends we{constructor(e){super(),be(this,e,CS,SS,ve,{data:7})}}function Gc(n){let e,t,s,i,o,a,r,l,c;return{c(){e=X("div"),t=X("div"),s=X("h3"),s.textContent="AudioOut",i=K(),o=X("p"),o.textContent="This node outputs any incoming audio streams to the speakers.",a=K(),r=X("button"),r.textContent="Close",C(r,"class","close-button svelte-1e92r1a"),C(t,"class","info-content svelte-1e92r1a"),C(e,"class","info-popup svelte-1e92r1a")},m(u,h){Z(u,e,h),x(e,t),x(t,s),x(t,i),x(t,o),x(t,a),x(t,r),l||(c=de(r,"click",n[2]),l=!0)},p:pe,d(u){u&&U(e),l=!1,c()}}}function NS(n){let e,t,s,i,o,a,r,l,c,u,h;i=new Ot({props:{type:"target",position:fe.Left}});let f=n[0]&&Gc(n);return{c(){e=X("div"),t=X("button"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',s=K(),he(i.$$.fragment),o=K(),a=X("div"),a.innerHTML="<b>Audio Out</b>",r=K(),f&&f.c(),l=Ze(),C(t,"class","info-button svelte-1e92r1a"),C(e,"class","output svelte-1e92r1a")},m(d,m){Z(d,e,m),x(e,t),x(e,s),ce(i,e,null),x(e,o),x(e,a),Z(d,r,m),f&&f.m(d,m),Z(d,l,m),c=!0,u||(h=de(t,"click",n[1]),u=!0)},p(d,[m]){d[0]?f?f.p(d,m):(f=Gc(d),f.c(),f.m(l.parentNode,l)):f&&(f.d(1),f=null)},i(d){c||(Y(i.$$.fragment,d),c=!0)},o(d){G(i.$$.fragment,d),c=!1},d(d){d&&(U(e),U(r),U(l)),ue(i),f&&f.d(d),u=!1,h()}}}function ES(n,e,t){let s=!1;return[s,()=>t(0,s=!s),()=>t(0,s=!1)]}class MS extends we{constructor(e){super(),be(this,e,ES,NS,ve,{})}}function Zc(n,e,t){const s=n.slice();return s[8]=e[t],s}function Kc(n){let e,t=n[8]+"",s,i;return{c(){e=X("option"),s=Be(t),i=K(),e.__value=n[8],rd(e,e.__value)},m(o,a){Z(o,e,a),x(e,s),x(e,i)},p:pe,d(o){o&&U(e)}}}function Qc(n){let e,t,s,i,o,a,r,l,c,u,h;return{c(){e=X("div"),t=X("div"),s=X("h3"),s.textContent="Pattern",i=K(),o=X("p"),o.textContent="This node outputs a Control Signal which will tell a Synth to play a pattern of notes.",a=K(),r=X("p"),r.innerHTML="<b>Pattern</b> determines what this pattern is.",l=K(),c=X("button"),c.textContent="Close",C(c,"class","close-button svelte-7mjldq"),C(t,"class","info-content svelte-7mjldq"),C(e,"class","info-popup svelte-7mjldq")},m(f,d){Z(f,e,d),x(e,t),x(t,s),x(t,i),x(t,o),x(t,a),x(t,r),x(t,l),x(t,c),u||(h=de(c,"click",n[7]),u=!0)},p:pe,d(f){f&&U(e),u=!1,h()}}}function OS(n){let e,t,s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v=Mt(n[2]),y=[];for(let b=0;b<v.length;b+=1)y[b]=Kc(Zc(n,v,b));f=new Ot({props:{type:"source",position:fe.Right}});let k=n[0]&&Qc(n);return{c(){e=X("div"),t=X("button"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',s=K(),i=X("div"),i.innerHTML="<b>Pattern</b> <hr/>",o=K(),a=X("div"),r=X("i"),r.textContent="Pattern: ",l=Be(n[1]),c=K(),u=X("select");for(let b=0;b<y.length;b+=1)y[b].c();h=K(),he(f.$$.fragment),d=K(),k&&k.c(),m=Ze(),C(t,"class","info-button svelte-7mjldq"),C(e,"class","sliders svelte-7mjldq")},m(b,N){Z(b,e,N),x(e,t),x(e,s),x(e,i),x(e,o),x(e,a),x(a,r),x(a,l),x(e,c),x(e,u);for(let T=0;T<y.length;T+=1)y[T]&&y[T].m(u,null);hl(u,n[1]),x(e,h),ce(f,e,null),Z(b,d,N),k&&k.m(b,N),Z(b,m,N),g=!0,_||(p=[de(t,"click",n[5]),de(u,"input",n[6])],_=!0)},p(b,[N]){if((!g||N&2)&&ht(l,b[1]),N&4){v=Mt(b[2]);let T;for(T=0;T<v.length;T+=1){const S=Zc(b,v,T);y[T]?y[T].p(S,N):(y[T]=Kc(S),y[T].c(),y[T].m(u,null))}for(;T<y.length;T+=1)y[T].d(1);y.length=v.length}(!g||N&6)&&hl(u,b[1]),b[0]?k?k.p(b,N):(k=Qc(b),k.c(),k.m(m.parentNode,m)):k&&(k.d(1),k=null)},i(b){g||(Y(f.$$.fragment,b),g=!0)},o(b){G(f.$$.fragment,b),g=!1},d(b){b&&(U(e),U(d),U(m)),Jr(y,b),ue(f),k&&k.d(b),_=!1,tt(p)}}}function DS(n,e,t){let s,{data:i}=e,o=["pattern1","pattern2","pattern3","pattern4","pattern5","pattern6","pattern7","pattern8","pattern9"];const{currentPattern:a}=i;ee(n,a,h=>t(1,s=h));let r=!1;const l=()=>t(0,r=!r),c=h=>{var f;return a.set(String((f=h.currentTarget)==null?void 0:f.value))},u=()=>t(0,r=!1);return n.$$set=h=>{"data"in h&&t(4,i=h.data)},[r,s,o,a,i,l,c,u]}class IS extends we{constructor(e){super(),be(this,e,DS,OS,ve,{data:4})}}function Jc(n){let e,t,s,i,o,a,r,l,c,u,h;return{c(){e=X("div"),t=X("div"),s=X("h3"),s.textContent="Delay",i=K(),o=X("p"),o.textContent="This node adds a Delay effect to an Audio Signal, with changes to it audibly repeating.",a=K(),r=X("p"),r.innerHTML="<b>Time</b> is the amount of seconds that the incoming signal is delayed. <b>Feedback</b> is the amount of effected signal fed back into the delay",l=K(),c=X("button"),c.textContent="Close",C(c,"class","close-button svelte-761ozq"),C(t,"class","info-content svelte-761ozq"),C(e,"class","info-popup svelte-761ozq")},m(f,d){Z(f,e,d),x(e,t),x(t,s),x(t,i),x(t,o),x(t,a),x(t,r),x(t,l),x(t,c),u||(h=de(c,"click",n[9]),u=!0)},p:pe,d(f){f&&U(e),u=!1,h()}}}function PS(n){let e,t,s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y,k,b,N,T,S,M,O,P,D;i=new Ot({props:{type:"target",position:fe.Left}}),T=new Ot({props:{type:"source",position:fe.Right}});let I=n[0]&&Jc(n);return{c(){e=X("div"),t=X("button"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',s=K(),he(i.$$.fragment),o=K(),a=X("div"),a.innerHTML="<b>Delay</b> <hr/>",r=K(),l=X("div"),c=X("i"),c.textContent="Time: ",u=X("strong"),h=Be(n[1]),f=Be("s"),d=K(),m=X("input"),g=K(),_=X("div"),p=X("i"),p.textContent="Feedback: ",v=X("strong"),y=Be(n[2]),k=K(),b=X("input"),N=K(),he(T.$$.fragment),S=K(),I&&I.c(),M=Ze(),C(t,"class","info-button svelte-761ozq"),C(m,"class","nodrag"),C(m,"type","range"),C(m,"min","0"),C(m,"max","1"),C(m,"step","0.01"),m.value=n[1],C(b,"class","nodrag"),C(b,"type","range"),C(b,"min","0"),C(b,"max","1"),C(b,"step","0.01"),b.value=n[2],C(e,"class","sliders svelte-761ozq")},m(w,E){Z(w,e,E),x(e,t),x(e,s),ce(i,e,null),x(e,o),x(e,a),x(e,r),x(e,l),x(l,c),x(l,u),x(u,h),x(u,f),x(e,d),x(e,m),x(e,g),x(e,_),x(_,p),x(_,v),x(v,y),x(e,k),x(e,b),x(e,N),ce(T,e,null),Z(w,S,E),I&&I.m(w,E),Z(w,M,E),O=!0,P||(D=[de(t,"click",n[6]),de(m,"input",n[7]),de(b,"input",n[8])],P=!0)},p(w,[E]){(!O||E&2)&&ht(h,w[1]),(!O||E&2)&&(m.value=w[1]),(!O||E&4)&&ht(y,w[2]),(!O||E&4)&&(b.value=w[2]),w[0]?I?I.p(w,E):(I=Jc(w),I.c(),I.m(M.parentNode,M)):I&&(I.d(1),I=null)},i(w){O||(Y(i.$$.fragment,w),Y(T.$$.fragment,w),O=!0)},o(w){G(i.$$.fragment,w),G(T.$$.fragment,w),O=!1},d(w){w&&(U(e),U(S),U(M)),ue(i),ue(T),I&&I.d(w),P=!1,tt(D)}}}function RS(n,e,t){let s,i,{data:o}=e;const{slider1:a,slider2:r}=o;ee(n,a,d=>t(1,s=d)),ee(n,r,d=>t(2,i=d));let l=!1;const c=()=>t(0,l=!l),u=d=>{var m;return a.set(Number((m=d.currentTarget)==null?void 0:m.value))},h=d=>{var m;return r.set(Number((m=d.currentTarget)==null?void 0:m.value))},f=()=>t(0,l=!1);return n.$$set=d=>{"data"in d&&t(5,o=d.data)},[l,s,i,a,r,o,c,u,h,f]}class xS extends we{constructor(e){super(),be(this,e,RS,PS,ve,{data:5})}}function $c(n){let e,t,s,i,o,a,r,l,c,u,h;return{c(){e=X("div"),t=X("div"),s=X("h3"),s.textContent="Reverb",i=K(),o=X("p"),o.textContent="This node adds a Reverb effect to an Audio Signal, simulating a sound playing in a large room, such as a church.",a=K(),r=X("p"),r.innerHTML="<b>Room size</b> is correlated to the decay time of the reverb. <b>Wet</b> is the amount of effected signal given to the output (at 0, the effect cannot be heard, at 1, the effect can exclusively be heard).",l=K(),c=X("button"),c.textContent="Close",C(c,"class","close-button svelte-761ozq"),C(t,"class","info-content svelte-761ozq"),C(e,"class","info-popup svelte-761ozq")},m(f,d){Z(f,e,d),x(e,t),x(t,s),x(t,i),x(t,o),x(t,a),x(t,r),x(t,l),x(t,c),u||(h=de(c,"click",n[9]),u=!0)},p:pe,d(f){f&&U(e),u=!1,h()}}}function VS(n){let e,t,s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y,k,b,N,T,S,M,O,P;i=new Ot({props:{type:"target",position:fe.Left}}),N=new Ot({props:{type:"source",position:fe.Right}});let D=n[0]&&$c(n);return{c(){e=X("div"),t=X("button"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',s=K(),he(i.$$.fragment),o=K(),a=X("div"),a.innerHTML="<b>Reverb</b> <hr/>",r=K(),l=X("div"),c=X("i"),c.textContent="Room Size: ",u=X("strong"),h=Be(n[1]),f=K(),d=X("input"),m=K(),g=X("div"),_=X("i"),_.textContent="Wet: ",p=X("strong"),v=Be(n[2]),y=K(),k=X("input"),b=K(),he(N.$$.fragment),T=K(),D&&D.c(),S=Ze(),C(t,"class","info-button svelte-761ozq"),C(d,"class","nodrag"),C(d,"type","range"),C(d,"min","0"),C(d,"max","1"),C(d,"step","0.01"),d.value=n[1],C(k,"class","nodrag"),C(k,"type","range"),C(k,"min","0"),C(k,"max","1"),C(k,"step","0.01"),k.value=n[2],C(e,"class","sliders svelte-761ozq")},m(I,w){Z(I,e,w),x(e,t),x(e,s),ce(i,e,null),x(e,o),x(e,a),x(e,r),x(e,l),x(l,c),x(l,u),x(u,h),x(e,f),x(e,d),x(e,m),x(e,g),x(g,_),x(g,p),x(p,v),x(e,y),x(e,k),x(e,b),ce(N,e,null),Z(I,T,w),D&&D.m(I,w),Z(I,S,w),M=!0,O||(P=[de(t,"click",n[6]),de(d,"input",n[7]),de(k,"input",n[8])],O=!0)},p(I,[w]){(!M||w&2)&&ht(h,I[1]),(!M||w&2)&&(d.value=I[1]),(!M||w&4)&&ht(v,I[2]),(!M||w&4)&&(k.value=I[2]),I[0]?D?D.p(I,w):(D=$c(I),D.c(),D.m(S.parentNode,S)):D&&(D.d(1),D=null)},i(I){M||(Y(i.$$.fragment,I),Y(N.$$.fragment,I),M=!0)},o(I){G(i.$$.fragment,I),G(N.$$.fragment,I),M=!1},d(I){I&&(U(e),U(T),U(S)),ue(i),ue(N),D&&D.d(I),O=!1,tt(P)}}}function FS(n,e,t){let s,i,{data:o}=e;const{slider1:a,slider2:r}=o;ee(n,a,d=>t(1,s=d)),ee(n,r,d=>t(2,i=d));let l=!1;const c=()=>t(0,l=!l),u=d=>{var m;return a.set(Number((m=d.currentTarget)==null?void 0:m.value))},h=d=>{var m;return r.set(Number((m=d.currentTarget)==null?void 0:m.value))},f=()=>t(0,l=!1);return n.$$set=d=>{"data"in d&&t(5,o=d.data)},[l,s,i,a,r,o,c,u,h,f]}class zS extends we{constructor(e){super(),be(this,e,FS,VS,ve,{data:5})}}function eu(n){let e,t,s,i,o,a,r,l,c,u,h;return{c(){e=X("div"),t=X("div"),s=X("h3"),s.textContent="Reverb",i=K(),o=X("p"),o.textContent="This node adds a Phaser effect to an Audio Signal, using a changing filter at specified frequencies to create a sweeping effect.",a=K(),r=X("p"),r.innerHTML="<b>Frequency</b> is the speed of the phasing. <b>Octaves</b> is the number of octaves the phase goes above the base frequency. <b>Base frequency</b> is the frequency the phase starts at.",l=K(),c=X("button"),c.textContent="Close",C(c,"class","close-button svelte-761ozq"),C(t,"class","info-content svelte-761ozq"),C(e,"class","info-popup svelte-761ozq")},m(f,d){Z(f,e,d),x(e,t),x(t,s),x(t,i),x(t,o),x(t,a),x(t,r),x(t,l),x(t,c),u||(h=de(c,"click",n[12]),u=!0)},p:pe,d(f){f&&U(e),u=!1,h()}}}function WS(n){let e,t,s,i,o,a,r,l,c,u,h,f,d,m,g,_,p,v,y,k,b,N,T,S,M,O,P,D,I,w,E,A,R,z,F,L;i=new Ot({props:{type:"target",position:fe.Left}}),E=new Ot({props:{type:"source",position:fe.Right}});let q=n[0]&&eu(n);return{c(){e=X("div"),t=X("button"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg>',s=K(),he(i.$$.fragment),o=K(),a=X("div"),a.innerHTML="<b>Phaser</b> <hr/>",r=K(),l=X("div"),c=X("i"),c.textContent="Frequency: ",u=X("strong"),h=Be(n[1]),f=Be("Hz"),d=K(),m=X("input"),g=K(),_=X("div"),p=X("i"),p.textContent="Octaves: ",v=X("strong"),y=Be(n[2]),k=K(),b=X("input"),N=K(),T=X("div"),S=X("i"),S.textContent="Base frequency: ",M=X("strong"),O=Be(n[3]),P=Be("Hz"),D=K(),I=X("input"),w=K(),he(E.$$.fragment),A=K(),q&&q.c(),R=Ze(),C(t,"class","info-button svelte-761ozq"),C(m,"class","nodrag"),C(m,"type","range"),C(m,"min","0"),C(m,"max","10"),C(m,"step","0.1"),m.value=n[1],C(b,"class","nodrag"),C(b,"type","range"),C(b,"min","0"),C(b,"max","8"),C(b,"step","1"),b.value=n[2],C(I,"class","nodrag"),C(I,"type","range"),C(I,"min","100"),C(I,"max","3000"),C(I,"step","50"),I.value=n[3],C(e,"class","sliders svelte-761ozq")},m(H,j){Z(H,e,j),x(e,t),x(e,s),ce(i,e,null),x(e,o),x(e,a),x(e,r),x(e,l),x(l,c),x(l,u),x(u,h),x(u,f),x(e,d),x(e,m),x(e,g),x(e,_),x(_,p),x(_,v),x(v,y),x(e,k),x(e,b),x(e,N),x(e,T),x(T,S),x(T,M),x(M,O),x(M,P),x(e,D),x(e,I),x(e,w),ce(E,e,null),Z(H,A,j),q&&q.m(H,j),Z(H,R,j),z=!0,F||(L=[de(t,"click",n[8]),de(m,"input",n[9]),de(b,"input",n[10]),de(I,"input",n[11])],F=!0)},p(H,[j]){(!z||j&2)&&ht(h,H[1]),(!z||j&2)&&(m.value=H[1]),(!z||j&4)&&ht(y,H[2]),(!z||j&4)&&(b.value=H[2]),(!z||j&8)&&ht(O,H[3]),(!z||j&8)&&(I.value=H[3]),H[0]?q?q.p(H,j):(q=eu(H),q.c(),q.m(R.parentNode,R)):q&&(q.d(1),q=null)},i(H){z||(Y(i.$$.fragment,H),Y(E.$$.fragment,H),z=!0)},o(H){G(i.$$.fragment,H),G(E.$$.fragment,H),z=!1},d(H){H&&(U(e),U(A),U(R)),ue(i),ue(E),q&&q.d(H),F=!1,tt(L)}}}function LS(n,e,t){let s,i,o,{data:a}=e;const{slider1:r,slider2:l,slider3:c}=a;ee(n,r,_=>t(1,s=_)),ee(n,l,_=>t(2,i=_)),ee(n,c,_=>t(3,o=_));let u=!1;const h=()=>t(0,u=!u),f=_=>{var p;return r.set(Number((p=_.currentTarget)==null?void 0:p.value))},d=_=>{var p;return l.set(Number((p=_.currentTarget)==null?void 0:p.value))},m=_=>{var p;return c.set(Number((p=_.currentTarget)==null?void 0:p.value))},g=()=>t(0,u=!1);return n.$$set=_=>{"data"in _&&t(7,a=_.data)},[u,s,i,o,r,l,c,a,h,f,d,m,g]}class qS extends we{constructor(e){super(),be(this,e,LS,WS,ve,{data:7})}}const Bn=new Map,ms={synth:AS,"audio-out":MS,pattern:IS,delay:xS,reverb:zS,phaser:qS},BS={"Audio Generators":{synth:ms.synth},Effects:{reverb:ms.reverb,delay:ms.delay,phaser:ms.phaser},Controls:{pattern:ms.pattern}};fe.Right,fe.Left;const HS=150,Do=["C0","D0","E0","F0","G0","A0","B0","C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6","C7","D7","E7","F7","G7","A7","B7","C8","D8","E8","F8","G8","A8","B8"],Qr=["sine","square","triangle","sawtooth"],tu={pattern1:[{time:0,note:"C4",dur:"4n"},{time:"4n",note:"D4",dur:"4n"},{time:"2n",note:"E4",dur:"4n"},{time:"2n + 4n",note:"F4",dur:"8n"}],pattern2:[{time:0,note:"C4",dur:"4n"},{time:"1n",note:"G4",dur:"4n"},{time:"2n",note:"E4",dur:"4n"},{time:"3n",note:"G4",dur:"4n"}],pattern3:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}],pattern4:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}],pattern5:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}],pattern6:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}],pattern7:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}],pattern8:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}],pattern9:[{time:0,note:"C4",dur:"4n"},{time:"2n",note:"G4",dur:"16n"}]},nu={title:"<h1>Help</h1>",body:`
    <h2>Usage</h2>

<p>A range of nodes can be added to the canvas using the menu and deleted using DELETE or BACKSPACE. Signals can be sent between them. Sounds can be generated by building a network of these nodes and connecting them to an audio output. A help button in the top right-hand corner provides usage instructions. Additionally, each node has an information button for specific node information.</p>

<h2>Signals</h2>

There are two types of signals:

<ul>
<li><b>Audio signal</b>: Represents a constant stream of audio, like a constant beep or a song</li>
<li><b>Control signal</b>: Represents a signal that controls the parameters of some other node</li>
</ul>

<h2>Nodes</h2>

There are three main categories of nodes:
<ul>
<li>Audio generator nodes [ Input: None, or Control Signal. Output: Audio Signal ]</li>
<ul>
<li><b>Synth</b>: Sends an audio signal of a single constant note (or a looping pattern if it takes an input from a pattern node)</li>
</ul>
<li>Effect nodes [ Input: Audio Signal. Output: Audio Signal ]</li>
<ul>
<li><b>Reverb</b>: Adds reverb to an audio signal</li>
<li><b>Delay</b>: Adds delay to an audio signal</li>
<li><b>Phaser</b> Adds phaser to an audio signal</li>
</ul>
<li>Control nodes [ Input: None. Output: Control Signal ]</li>
<ul>
<li><b>Pattern</b>: When connected to a synthesizer, a control signal will make the synthesizer play a predefined pattern of notes</li>
</ul>
</ul>

There is also an <b>Audio Output</b> node - any audio signal connected this will be made audible to the user.

Nodes can be connected by dragging the connection dots to the left and right of each node. The left connection dot is an input and the right connection dot is an output. To connect any node X to any node Y, click and drag from node X's right-hand dot (node X's output) to node Y's left-hand dot (node Y's input).
  `};class Di{constructor(e,t=!1){Ie(this,"id");Ie(this,"isConnected");this.id=e,this.isConnected=t}connect(e){this.getNode().connect(e.getNode())}connectToOutput(){this.getNode().toDestination()}disconnect(e){e?this.getNode().disconnect(e):this.getNode().disconnect()}}class XS extends Di{constructor(t,s,i,o,a,r){super(t,r);Ie(this,"volume");Ie(this,"pitch");Ie(this,"shape");Ie(this,"synthObject");Ie(this,"pattern");Ie(this,"part");Ie(this,"type","synth");this.synthObject=new hi,this.volume=ae(s),this.pitch=ae(i),this.shape=ae(o),this.volume.subscribe(l=>{this.change_volume(l)}),this.pitch.subscribe(l=>{this.change_pitch(l)}),this.shape.subscribe(l=>{this.change_shape(l)}),this.pattern=a,this.part=new fi((l,c)=>{this.synthObject.triggerAttackRelease(c.note,c.dur,l)},tu[a])}getNode(){return this.synthObject}connect(t){super.connect(t),this.enable()}enable(){this.isConnected=!0,this.pattern!=""?(this.part.stop(),this.part=new fi((t,s)=>{this.synthObject.triggerAttackRelease(s.note,s.dur,t)},tu[this.pattern]),this.part.loop=!0,this.part.loopEnd="1m",this.part.start()):this.synthObject.triggerAttack(Do[oe(this.pitch)]),Kr().start()}disable(){this.isConnected=!1,this.synthObject.triggerRelease(),this.synthObject.disconnect,this.part.stop()}change_volume(t){this.synthObject.set({volume:t})}change_pitch(t){this.synthObject.setNote(Do[t])}change_shape(t){this.synthObject.oscillator.type=Qr[t]}}class YS extends Di{constructor(t,s){super(t);Ie(this,"pattern");Ie(this,"patternString");Ie(this,"type","pattern");this.pattern=ae(s),this.patternString=s,this.pattern.subscribe(i=>{this.change_pattern(i)})}getNode(){return new Mi}getPattern(){return this.patternString}change_pattern(t){this.patternString=t}}class jS extends Di{constructor(t,s,i){super(t);Ie(this,"delayTime");Ie(this,"feedback");Ie(this,"delayObject");Ie(this,"type","delay");this.delayTime=ae(s),this.feedback=ae(i),this.delayObject=new tl(.5),this.delayObject.set({wet:.8}),this.delayTime.subscribe(o=>{this.change_delay_time(o)}),this.feedback.subscribe(o=>{this.change_feedback(o)})}getNode(){return this.delayObject}change_delay_time(t){this.delayObject.set({delayTime:t})}change_feedback(t){this.delayObject.set({feedback:t})}}class US extends Di{constructor(t,s,i){super(t);Ie(this,"roomSize");Ie(this,"wet");Ie(this,"reverbObject");Ie(this,"type","reverb");this.roomSize=ae(s),this.wet=ae(i),this.reverbObject=new nl(.5),this.roomSize.subscribe(o=>{this.change_room_size(o)}),this.wet.subscribe(o=>{this.change_wet(o)}),this.id=t}getNode(){return this.reverbObject}change_room_size(t){this.reverbObject.set({roomSize:t})}change_wet(t){this.reverbObject.set({wet:t})}}class GS extends Di{constructor(t,s,i,o){super(t);Ie(this,"frequency");Ie(this,"octaves");Ie(this,"baseFrequency");Ie(this,"phaserObject");Ie(this,"type","phaser");this.frequency=ae(s),this.octaves=ae(i),this.baseFrequency=ae(o),this.phaserObject=new sl({frequency:15,octaves:5,baseFrequency:1e3}),this.frequency.subscribe(a=>{this.change_frequency(a)}),this.octaves.subscribe(a=>{this.change_octaves(a)}),this.baseFrequency.subscribe(a=>{this.change_base_frequency(a)})}getNode(){return this.phaserObject}change_frequency(t){this.phaserObject.set({frequency:t})}change_octaves(t){this.phaserObject.set({octaves:t})}change_base_frequency(t){this.phaserObject.set({baseFrequency:t})}}const su={synth:n=>{const e=new XS(n,0,10,0,"",!1);return Bn.set(n,e),{id:n,type:"synth",position:{x:100,y:100},data:{slider1:e.volume,slider2:e.pitch,slider3:e.shape}}},delay:n=>{const e=new jS(n,0,0);return Bn.set(n,e),{id:n,type:"delay",position:{x:100,y:100},data:{slider1:e.delayTime,slider2:e.feedback}}},reverb:n=>{const e=new US(n,0,0);return Bn.set(n,e),{id:n,type:"reverb",position:{x:100,y:100},data:{slider1:e.roomSize,slider2:e.wet}}},phaser:n=>{const e=new GS(n,15,5,1e3);return Bn.set(n,e),{id:n,type:"phaser",position:{x:100,y:100},data:{slider1:e.frequency,slider2:e.octaves,slider3:e.baseFrequency}}},pattern:n=>{const e=new YS(n,"pattern1");return Bn.set(n,e),{id:n,type:"pattern",position:{x:100,y:100},data:{currentPattern:e.pattern}}}};function ZS(n,e){const t=su[n];return t?t(e):su.synth(e)}function KS(n){let e,t,s,i,o,a,r,l,c;return{c(){e=X("div"),t=X("div"),s=X("button"),s.textContent="",i=K(),o=new fl(!1),a=K(),r=new fl(!1),C(s,"class","close-help-button svelte-uu92ri"),o.a=a,r.a=null,C(t,"class","help-modal svelte-uu92ri"),C(e,"class","help-modal-overlay svelte-uu92ri"),C(e,"aria-hidden","true")},m(u,h){Z(u,e,h),x(e,t),x(t,s),x(t,i),o.m(n[0],t),x(t,a),r.m(n[1],t),l||(c=[de(s,"click",function(){Ye(n[2])&&n[2].apply(this,arguments)}),de(e,"click",function(){Ye(n[2])&&n[2].apply(this,arguments)})],l=!0)},p(u,[h]){n=u,h&1&&o.p(n[0]),h&2&&r.p(n[1])},i:pe,o:pe,d(u){u&&U(e),l=!1,tt(c)}}}function QS(n,e,t){let{title:s}=e,{body:i}=e,{closeModal:o}=e;return n.$$set=a=>{"title"in a&&t(0,s=a.title),"body"in a&&t(1,i=a.body),"closeModal"in a&&t(2,o=a.closeModal)},[s,i,o]}class JS extends we{constructor(e){super(),be(this,e,QS,KS,ve,{title:0,body:1,closeModal:2})}}function iu(n,e,t){const s=n.slice();return s[4]=e[t][0],s[5]=e[t][1],s}function ou(n,e,t){const s=n.slice();return s[8]=e[t][0],s}function ru(n){let e;function t(o,a){return o[4]=="Controls"?eC:$S}let s=t(n),i=s(n);return{c(){i.c(),e=Ze()},m(o,a){i.m(o,a),Z(o,e,a)},p(o,a){s===(s=t(o))&&i?i.p(o,a):(i.d(1),i=s(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){o&&U(e),i.d(o)}}}function $S(n){let e,t=n[8]+"",s,i,o,a;function r(){return n[3](n[8])}return{c(){e=X("button"),s=Be(t),i=K(),C(e,"class","node-button node-button-audio svelte-aafpjq")},m(l,c){Z(l,e,c),x(e,s),x(e,i),o||(a=de(e,"click",r),o=!0)},p(l,c){n=l,c&1&&t!==(t=n[8]+"")&&ht(s,t)},d(l){l&&U(e),o=!1,a()}}}function eC(n){let e,t=n[8]+"",s,i,o,a;function r(){return n[2](n[8])}return{c(){e=X("button"),s=Be(t),i=K(),C(e,"class","node-button node-button-control svelte-aafpjq")},m(l,c){Z(l,e,c),x(e,s),x(e,i),o||(a=de(e,"click",r),o=!0)},p(l,c){n=l,c&1&&t!==(t=n[8]+"")&&ht(s,t)},d(l){l&&U(e),o=!1,a()}}}function au(n){let e,t=n[8]!=="audio-out"&&ru(n);return{c(){t&&t.c(),e=Ze()},m(s,i){t&&t.m(s,i),Z(s,e,i)},p(s,i){s[8]!=="audio-out"?t?t.p(s,i):(t=ru(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(s){s&&U(e),t&&t.d(s)}}}function lu(n){let e,t,s=n[4]+"",i,o,a,r,l,c=Mt(Object.entries(n[5])),u=[];for(let h=0;h<c.length;h+=1)u[h]=au(ou(n,c,h));return{c(){e=X("div"),t=X("div"),i=Be(s),o=Be(":"),a=K(),r=X("div");for(let h=0;h<u.length;h+=1)u[h].c();l=K(),C(t,"class","node-section-title svelte-aafpjq"),C(r,"class","node-section-buttons svelte-aafpjq"),C(e,"class","node-section svelte-aafpjq")},m(h,f){Z(h,e,f),x(e,t),x(t,i),x(t,o),x(e,a),x(e,r);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(r,null);x(e,l)},p(h,f){if(f&1&&s!==(s=h[4]+"")&&ht(i,s),f&3){c=Mt(Object.entries(h[5]));let d;for(d=0;d<c.length;d+=1){const m=ou(h,c,d);u[d]?u[d].p(m,f):(u[d]=au(m),u[d].c(),u[d].m(r,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}},d(h){h&&U(e),Jr(u,h)}}}function tC(n){let e,t,s,i=Mt(Object.entries(n[0])),o=[];for(let a=0;a<i.length;a+=1)o[a]=lu(iu(n,i,a));return{c(){e=X("div"),t=X("h3"),t.textContent="Add Nodes",s=K();for(let a=0;a<o.length;a+=1)o[a].c();C(t,"class","svelte-aafpjq"),C(e,"class","node-menu svelte-aafpjq")},m(a,r){Z(a,e,r),x(e,t),x(e,s);for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(e,null)},p(a,[r]){if(r&3){i=Mt(Object.entries(a[0]));let l;for(l=0;l<i.length;l+=1){const c=iu(a,i,l);o[l]?o[l].p(c,r):(o[l]=lu(c),o[l].c(),o[l].m(e,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=i.length}},i:pe,o:pe,d(a){a&&U(e),Jr(o,a)}}}function nC(n,e,t){let{groupedNodeTypes:s={}}=e,{addNode:i}=e;const o=r=>i(r),a=r=>i(r);return n.$$set=r=>{"groupedNodeTypes"in r&&t(0,s=r.groupedNodeTypes),"addNode"in r&&t(1,i=r.addNode)},[s,i,o,a]}class sC extends we{constructor(e){super(),be(this,e,nC,tC,ve,{groupedNodeTypes:0,addNode:1})}}function iC(n){return n+"_"+crypto.randomUUID()}function oC(n){let e,t,s,i,o,a;return e=new sb({}),s=new yb({}),o=new Ob({}),{c(){he(e.$$.fragment),t=K(),he(s.$$.fragment),i=K(),he(o.$$.fragment)},m(r,l){ce(e,r,l),Z(r,t,l),ce(s,r,l),Z(r,i,l),ce(o,r,l),a=!0},i(r){a||(Y(e.$$.fragment,r),Y(s.$$.fragment,r),Y(o.$$.fragment,r),a=!0)},o(r){G(e.$$.fragment,r),G(s.$$.fragment,r),G(o.$$.fragment,r),a=!1},d(r){r&&(U(t),U(i)),ue(e,r),ue(s,r),ue(o,r)}}}function cu(n){let e,t;return e=new JS({props:{closeModal:n[2],title:nu.title,body:nu.body}}),{c(){he(e.$$.fragment)},m(s,i){ce(e,s,i),t=!0},p:pe,i(s){t||(Y(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}function rC(n){let e,t,s,i,o,a,r,l,c,u,h,f;t=new Cy({props:{nodes:n[3],edges:n[4],nodeTypes:ms,fitView:!0,ondelete:n[6],onedgecreate:aC,onconnect:n[7],isValidConnection:n[8],deleteKey:["Delete","Backspace"],$$slots:{default:[oC]},$$scope:{ctx:n}}}),a=new sC({props:{groupedNodeTypes:BS,addNode:n[5]}});let d=n[0]&&cu(n);return{c(){e=X("div"),he(t.$$.fragment),s=K(),i=X("button"),i.textContent="?",o=K(),he(a.$$.fragment),r=K(),d&&d.c(),l=K(),c=X("style"),c.textContent=`.help-button {\r
    position: fixed !important;\r
    top: 1rem !important;\r
    right: 1rem !important;\r
    width: 40px;\r
    height: 40px;\r
    border-radius: 50%;\r
    background-color: #646464;\r
    color: white;\r
    border: none;\r
    font-size: 1.5rem;\r
    font-weight: bold;\r
    cursor: pointer;\r
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\r
    z-index: 1000;\r
  }`,C(i,"class","help-button"),Se(e,"height","100vh")},m(m,g){Z(m,e,g),ce(t,e,null),x(e,s),x(e,i),x(e,o),ce(a,e,null),x(e,r),d&&d.m(e,null),x(e,l),x(e,c),u=!0,h||(f=de(i,"click",n[1]),h=!0)},p(m,[g]){const _={};g&8192&&(_.$$scope={dirty:g,ctx:m}),t.$set(_),m[0]?d?(d.p(m,g),g&1&&Y(d,1)):(d=cu(m),d.c(),Y(d,1),d.m(e,l)):d&&(at(),G(d,1,1,()=>{d=null}),lt())},i(m){u||(Y(t.$$.fragment,m),Y(a.$$.fragment,m),Y(d),u=!0)},o(m){G(t.$$.fragment,m),G(a.$$.fragment,m),G(d),u=!1},d(m){m&&U(e),ue(t),ue(a),d&&d.d(),h=!1,f()}}}function aC(n){var t;let e=!1;return(t=n.source)!=null&&t.startsWith("pattern")&&(e=!0),{source:n.source,target:n.target,animated:e}}function lC(n,e,t){let s=!1;function i(){t(0,s=!0)}function o(){t(0,s=!1)}let a=[{id:"audio-out_1",data:{},position:{x:350,y:230},type:"audio-out",deletable:!1}],r=[];const l=ae(a),c=ae(r);di(async()=>{Kr().bpm.value=HS,Kr().start()});function u(_){return Bn.get(_)}function h(_){_.forEach(v=>{p(v.source,v.target)});function p(v,y){const k=u(v),b=u(y);y.startsWith("audio-out")&&k?(v.startsWith("synth")&&k.enable(),k.connectToOutput()):k&&b&&(v.startsWith("pattern")&&y.startsWith("synth")?(b.pattern=k.getPattern(),b.isConnected&&(b.disable(),b.enable())):k.connect(b))}}function f(_){l.update(p=>[...p,ZS(_,iC(_))])}function d(_){var p,v,y,k,b,N,T,S,M;if(_.nodes.length>0&&_.nodes.forEach(O=>{if(O.type=="synth"||O.type=="delay"||O.type=="reverb"||O.type=="phaser"){let P=u(O.id);P&&(P.disconnect(),Bn.delete(O.id))}}),_.edges){const O=_.edges[0];let P=u(O.source),D=u(O.target);if((p=O.source)!=null&&p.startsWith("synth")&&P&&D){P.disconnect(D.getNode());return}if((v=O.source)!=null&&v.startsWith("synth")&&P&&!D){P.disconnect(TS());return}if(!((y=O.source)!=null&&y.startsWith("synth"))&&!((k=O.source)!=null&&k.startsWith("pattern"))&&((b=O.source)!=null&&b.startsWith("audio-out"))&&P){let I=u(O.target);I&&P.disconnect(I.getNode());return}if(!((N=O.source)!=null&&N.startsWith("synth"))&&!((T=O.source)!=null&&T.startsWith("pattern"))&&!((S=O.source)!=null&&S.startsWith("audio-out"))&&P){P.disconnect();return}if((M=O.source)!=null&&M.startsWith("pattern")){let I=u(O.target);I.pattern="",I.disable(),I.enable()}}}function m(){h(oe(c))}return[s,i,o,l,c,f,d,m,_=>{const{source:p,sourceHandle:v,target:y,targetHandle:k}=_;return!(p!=null&&p.startsWith("pattern")&&!(y!=null&&y.startsWith("synth"))||!(p!=null&&p.startsWith("pattern"))&&(y!=null&&y.startsWith("synth"))||p!=null&&p.startsWith("pattern")&&oe(c).filter(N=>N.target===y).length>0)}]}class cC extends we{constructor(e){super(),be(this,e,lC,rC,ve,{})}}new cC({target:document.getElementById("app")});
